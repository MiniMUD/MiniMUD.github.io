/*! For license information please see host.bundle.js.LICENSE.txt */
(()=>{var e={452:function(e,t,n){var r;e.exports=(r=n(8249),n(8269),n(8214),n(888),n(5109),function(){var e=r,t=e.lib.BlockCipher,n=e.algo,i=[],o=[],s=[],a=[],c=[],u=[],l=[],h=[],d=[],f=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,r=0;for(t=0;t<256;t++){var p=r^r<<1^r<<2^r<<3^r<<4;p=p>>>8^255&p^99,i[n]=p,o[p]=n;var m=e[n],v=e[m],g=e[v],y=257*e[p]^16843008*p;s[n]=y<<24|y>>>8,a[n]=y<<16|y>>>16,c[n]=y<<8|y>>>24,u[n]=y,y=16843009*g^65537*v^257*m^16843008*n,l[p]=y<<24|y>>>8,h[p]=y<<16|y>>>16,d[p]=y<<8|y>>>24,f[p]=y,n?(n=m^e[e[e[g^m]]],r^=e[e[r]]):n=r=1}}();var p=[0,1,2,4,8,16,32,64,128,27,54],m=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,r=4*((this._nRounds=n+6)+1),o=this._keySchedule=[],s=0;s<r;s++)s<n?o[s]=t[s]:(u=o[s-1],s%n?n>6&&s%n==4&&(u=i[u>>>24]<<24|i[u>>>16&255]<<16|i[u>>>8&255]<<8|i[255&u]):(u=i[(u=u<<8|u>>>24)>>>24]<<24|i[u>>>16&255]<<16|i[u>>>8&255]<<8|i[255&u],u^=p[s/n|0]<<24),o[s]=o[s-n]^u);for(var a=this._invKeySchedule=[],c=0;c<r;c++){if(s=r-c,c%4)var u=o[s];else u=o[s-4];a[c]=c<4||s<=4?u:l[i[u>>>24]]^h[i[u>>>16&255]]^d[i[u>>>8&255]]^f[i[255&u]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,a,c,u,i)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,h,d,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,o,s,a){for(var c=this._nRounds,u=e[t]^n[0],l=e[t+1]^n[1],h=e[t+2]^n[2],d=e[t+3]^n[3],f=4,p=1;p<c;p++){var m=r[u>>>24]^i[l>>>16&255]^o[h>>>8&255]^s[255&d]^n[f++],v=r[l>>>24]^i[h>>>16&255]^o[d>>>8&255]^s[255&u]^n[f++],g=r[h>>>24]^i[d>>>16&255]^o[u>>>8&255]^s[255&l]^n[f++],y=r[d>>>24]^i[u>>>16&255]^o[l>>>8&255]^s[255&h]^n[f++];u=m,l=v,h=g,d=y}m=(a[u>>>24]<<24|a[l>>>16&255]<<16|a[h>>>8&255]<<8|a[255&d])^n[f++],v=(a[l>>>24]<<24|a[h>>>16&255]<<16|a[d>>>8&255]<<8|a[255&u])^n[f++],g=(a[h>>>24]<<24|a[d>>>16&255]<<16|a[u>>>8&255]<<8|a[255&l])^n[f++],y=(a[d>>>24]<<24|a[u>>>16&255]<<16|a[l>>>8&255]<<8|a[255&h])^n[f++],e[t]=m,e[t+1]=v,e[t+2]=g,e[t+3]=y},keySize:8});e.AES=t._createHelper(m)}(),r.AES)},5109:function(e,t,n){var r,i,o,s,a,c,u,l,h,d,f,p,m,v,g,y,_,b,w;e.exports=(r=n(8249),n(888),void(r.lib.Cipher||(i=r,o=i.lib,s=o.Base,a=o.WordArray,c=o.BufferedBlockAlgorithm,u=i.enc,u.Utf8,l=u.Base64,h=i.algo.EvpKDF,d=o.Cipher=c.extend({cfg:s.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?w:_}return function(t){return{encrypt:function(n,r,i){return e(r).encrypt(t,n,r,i)},decrypt:function(n,r,i){return e(r).decrypt(t,n,r,i)}}}}()}),o.StreamCipher=d.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),f=i.mode={},p=o.BlockCipherMode=s.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),m=f.CBC=function(){var e=p.extend();function t(e,t,n){var r,i=this._iv;i?(r=i,this._iv=void 0):r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]}return e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize;t.call(this,e,n,i),r.encryptBlock(e,n),this._prevBlock=e.slice(n,n+i)}}),e.Decryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize,o=e.slice(n,n+i);r.decryptBlock(e,n),t.call(this,e,n,i),this._prevBlock=o}}),e}(),v=(i.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,i=r<<24|r<<16|r<<8|r,o=[],s=0;s<r;s+=4)o.push(i);var c=a.create(o,r);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},o.BlockCipher=d.extend({cfg:d.cfg.extend({mode:m,padding:v}),reset:function(){var e;d.reset.call(this);var t=this.cfg,n=t.iv,r=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=r.createEncryptor:(e=r.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(r,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),g=o.CipherParams=s.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),y=(i.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?a.create([1398893684,1701076831]).concat(n).concat(t):t).toString(l)},parse:function(e){var t,n=l.parse(e),r=n.words;return 1398893684==r[0]&&1701076831==r[1]&&(t=a.create(r.slice(2,4)),r.splice(0,4),n.sigBytes-=16),g.create({ciphertext:n,salt:t})}},_=o.SerializableCipher=s.extend({cfg:s.extend({format:y}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r),o=i.finalize(t),s=i.cfg;return g.create({ciphertext:o,key:n,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),b=(i.kdf={}).OpenSSL={execute:function(e,t,n,r){r||(r=a.random(8));var i=h.create({keySize:t+n}).compute(e,r),o=a.create(i.words.slice(t),4*n);return i.sigBytes=4*t,g.create({key:i,iv:o,salt:r})}},w=o.PasswordBasedCipher=_.extend({cfg:_.cfg.extend({kdf:b}),encrypt:function(e,t,n,r){var i=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize);r.iv=i.iv;var o=_.encrypt.call(this,e,t,i.key,r);return o.mixIn(i),o},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var i=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);return r.iv=i.iv,_.decrypt.call(this,e,t,i.key,r)}}))))},8249:function(e,t,n){var r;e.exports=(r=r||function(e,t){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==n.g&&n.g.crypto&&(r=n.g.crypto),!r)try{r=n(2480)}catch(e){}var i=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),s={},a=s.lib={},c=a.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=a.WordArray=c.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||h).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=s<<24-(r+o)%4*8}else for(var a=0;a<i;a+=4)t[r+a>>>2]=n[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(i());return new u.init(t,e)}}),l=s.enc={},h=l.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new u.init(n,t/2)}},d=l.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new u.init(n,t)}},f=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},p=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,i=r.words,o=r.sigBytes,s=this.blockSize,a=o/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,l=e.min(4*c,o);if(c){for(var h=0;h<c;h+=s)this._doProcessBlock(i,h);n=i.splice(0,c),r.sigBytes-=l}return new u.init(n,l)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),m=(a.Hasher=p.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new m.HMAC.init(e,n).finalize(t)}}}),s.algo={});return s}(Math),r)},8269:function(e,t,n){var r,i,o;e.exports=(r=n(8249),o=(i=r).lib.WordArray,i.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var i=[],o=0;o<n;o+=3)for(var s=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<n;a++)i.push(r.charAt(s>>>6*(3-a)&63));var c=r.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var i=0;i<n.length;i++)r[n.charCodeAt(i)]=i}var s=n.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return function(e,t,n){for(var r=[],i=0,s=0;s<t;s++)if(s%4){var a=n[e.charCodeAt(s-1)]<<s%4*2|n[e.charCodeAt(s)]>>>6-s%4*2;r[i>>>2]|=a<<24-i%4*8,i++}return o.create(r,i)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)},3786:function(e,t,n){var r,i,o;e.exports=(r=n(8249),o=(i=r).lib.WordArray,i.enc.Base64url={stringify:function(e,t=!0){var n=e.words,r=e.sigBytes,i=t?this._safe_map:this._map;e.clamp();for(var o=[],s=0;s<r;s+=3)for(var a=(n[s>>>2]>>>24-s%4*8&255)<<16|(n[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|n[s+2>>>2]>>>24-(s+2)%4*8&255,c=0;c<4&&s+.75*c<r;c++)o.push(i.charAt(a>>>6*(3-c)&63));var u=i.charAt(64);if(u)for(;o.length%4;)o.push(u);return o.join("")},parse:function(e,t=!0){var n=e.length,r=t?this._safe_map:this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var s=0;s<r.length;s++)i[r.charCodeAt(s)]=s}var a=r.charAt(64);if(a){var c=e.indexOf(a);-1!==c&&(n=c)}return function(e,t,n){for(var r=[],i=0,s=0;s<t;s++)if(s%4){var a=n[e.charCodeAt(s-1)]<<s%4*2|n[e.charCodeAt(s)]>>>6-s%4*2;r[i>>>2]|=a<<24-i%4*8,i++}return o.create(r,i)}(e,n,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"},r.enc.Base64url)},298:function(e,t,n){var r;e.exports=(r=n(8249),function(){var e=r,t=e.lib.WordArray,n=e.enc;function i(e){return e<<8&4278255360|e>>>8&16711935}n.Utf16=n.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i+=2){var o=t[i>>>2]>>>16-i%4*8&65535;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var n=e.length,r=[],i=0;i<n;i++)r[i>>>1]|=e.charCodeAt(i)<<16-i%2*16;return t.create(r,2*n)}},n.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o+=2){var s=i(t[o>>>2]>>>16-o%4*8&65535);r.push(String.fromCharCode(s))}return r.join("")},parse:function(e){for(var n=e.length,r=[],o=0;o<n;o++)r[o>>>1]|=i(e.charCodeAt(o)<<16-o%2*16);return t.create(r,2*n)}}}(),r.enc.Utf16)},888:function(e,t,n){var r,i,o,s,a,c,u,l;e.exports=(l=n(8249),n(2783),n(9824),o=(i=(r=l).lib).Base,s=i.WordArray,c=(a=r.algo).MD5,u=a.EvpKDF=o.extend({cfg:o.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,r=this.cfg,i=r.hasher.create(),o=s.create(),a=o.words,c=r.keySize,u=r.iterations;a.length<c;){n&&i.update(n),n=i.update(e).finalize(t),i.reset();for(var l=1;l<u;l++)n=i.finalize(n),i.reset();o.concat(n)}return o.sigBytes=4*c,o}}),r.EvpKDF=function(e,t,n){return u.create(n).compute(e,t)},l.EvpKDF)},2209:function(e,t,n){var r,i,o,s;e.exports=(s=n(8249),n(5109),i=(r=s).lib.CipherParams,o=r.enc.Hex,r.format.Hex={stringify:function(e){return e.ciphertext.toString(o)},parse:function(e){var t=o.parse(e);return i.create({ciphertext:t})}},s.format.Hex)},9824:function(e,t,n){var r,i,o;e.exports=(i=(r=n(8249)).lib.Base,o=r.enc.Utf8,void(r.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),s=this._iKey=t.clone(),a=i.words,c=s.words,u=0;u<n;u++)a[u]^=1549556828,c[u]^=909522486;i.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))},1354:function(e,t,n){var r;e.exports=(r=n(8249),n(4938),n(4433),n(298),n(8269),n(3786),n(8214),n(2783),n(2153),n(7792),n(34),n(7460),n(3327),n(706),n(9824),n(2112),n(888),n(5109),n(8568),n(4242),n(9968),n(7660),n(1148),n(3615),n(2807),n(1077),n(6475),n(6991),n(2209),n(452),n(4253),n(1857),n(4454),n(3974),r)},4433:function(e,t,n){var r;e.exports=(r=n(8249),function(){if("function"==typeof ArrayBuffer){var e=r.lib.WordArray,t=e.init,n=e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,r=[],i=0;i<n;i++)r[i>>>2]|=e[i]<<24-i%4*8;t.call(this,r,n)}else t.apply(this,arguments)};n.prototype=e}}(),r.lib.WordArray)},8214:function(e,t,n){var r;e.exports=(r=n(8249),function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,s=t.algo,a=[];!function(){for(var t=0;t<64;t++)a[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=s.MD5=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o=this._hash.words,s=e[t+0],c=e[t+1],f=e[t+2],p=e[t+3],m=e[t+4],v=e[t+5],g=e[t+6],y=e[t+7],_=e[t+8],b=e[t+9],w=e[t+10],k=e[t+11],C=e[t+12],S=e[t+13],x=e[t+14],E=e[t+15],T=o[0],R=o[1],P=o[2],A=o[3];T=u(T,R,P,A,s,7,a[0]),A=u(A,T,R,P,c,12,a[1]),P=u(P,A,T,R,f,17,a[2]),R=u(R,P,A,T,p,22,a[3]),T=u(T,R,P,A,m,7,a[4]),A=u(A,T,R,P,v,12,a[5]),P=u(P,A,T,R,g,17,a[6]),R=u(R,P,A,T,y,22,a[7]),T=u(T,R,P,A,_,7,a[8]),A=u(A,T,R,P,b,12,a[9]),P=u(P,A,T,R,w,17,a[10]),R=u(R,P,A,T,k,22,a[11]),T=u(T,R,P,A,C,7,a[12]),A=u(A,T,R,P,S,12,a[13]),P=u(P,A,T,R,x,17,a[14]),T=l(T,R=u(R,P,A,T,E,22,a[15]),P,A,c,5,a[16]),A=l(A,T,R,P,g,9,a[17]),P=l(P,A,T,R,k,14,a[18]),R=l(R,P,A,T,s,20,a[19]),T=l(T,R,P,A,v,5,a[20]),A=l(A,T,R,P,w,9,a[21]),P=l(P,A,T,R,E,14,a[22]),R=l(R,P,A,T,m,20,a[23]),T=l(T,R,P,A,b,5,a[24]),A=l(A,T,R,P,x,9,a[25]),P=l(P,A,T,R,p,14,a[26]),R=l(R,P,A,T,_,20,a[27]),T=l(T,R,P,A,S,5,a[28]),A=l(A,T,R,P,f,9,a[29]),P=l(P,A,T,R,y,14,a[30]),T=h(T,R=l(R,P,A,T,C,20,a[31]),P,A,v,4,a[32]),A=h(A,T,R,P,_,11,a[33]),P=h(P,A,T,R,k,16,a[34]),R=h(R,P,A,T,x,23,a[35]),T=h(T,R,P,A,c,4,a[36]),A=h(A,T,R,P,m,11,a[37]),P=h(P,A,T,R,y,16,a[38]),R=h(R,P,A,T,w,23,a[39]),T=h(T,R,P,A,S,4,a[40]),A=h(A,T,R,P,s,11,a[41]),P=h(P,A,T,R,p,16,a[42]),R=h(R,P,A,T,g,23,a[43]),T=h(T,R,P,A,b,4,a[44]),A=h(A,T,R,P,C,11,a[45]),P=h(P,A,T,R,E,16,a[46]),T=d(T,R=h(R,P,A,T,f,23,a[47]),P,A,s,6,a[48]),A=d(A,T,R,P,y,10,a[49]),P=d(P,A,T,R,x,15,a[50]),R=d(R,P,A,T,v,21,a[51]),T=d(T,R,P,A,C,6,a[52]),A=d(A,T,R,P,p,10,a[53]),P=d(P,A,T,R,w,15,a[54]),R=d(R,P,A,T,c,21,a[55]),T=d(T,R,P,A,_,6,a[56]),A=d(A,T,R,P,E,10,a[57]),P=d(P,A,T,R,g,15,a[58]),R=d(R,P,A,T,S,21,a[59]),T=d(T,R,P,A,m,6,a[60]),A=d(A,T,R,P,k,10,a[61]),P=d(P,A,T,R,f,15,a[62]),R=d(R,P,A,T,b,21,a[63]),o[0]=o[0]+T|0,o[1]=o[1]+R|0,o[2]=o[2]+P|0,o[3]=o[3]+A|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var o=e.floor(r/4294967296),s=r;n[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[14+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(n.length+1),this._process();for(var a=this._hash,c=a.words,u=0;u<4;u++){var l=c[u];c[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return a},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,n,r,i,o,s){var a=e+(t&n|~t&r)+i+s;return(a<<o|a>>>32-o)+t}function l(e,t,n,r,i,o,s){var a=e+(t&r|n&~r)+i+s;return(a<<o|a>>>32-o)+t}function h(e,t,n,r,i,o,s){var a=e+(t^n^r)+i+s;return(a<<o|a>>>32-o)+t}function d(e,t,n,r,i,o,s){var a=e+(n^(t|~r))+i+s;return(a<<o|a>>>32-o)+t}t.MD5=o._createHelper(c),t.HmacMD5=o._createHmacHelper(c)}(Math),r.MD5)},8568:function(e,t,n){var r;e.exports=(r=n(8249),n(5109),r.mode.CFB=function(){var e=r.lib.BlockCipherMode.extend();function t(e,t,n,r){var i,o=this._iv;o?(i=o.slice(0),this._iv=void 0):i=this._prevBlock,r.encryptBlock(i,0);for(var s=0;s<n;s++)e[t+s]^=i[s]}return e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize;t.call(this,e,n,i,r),this._prevBlock=e.slice(n,n+i)}}),e.Decryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize,o=e.slice(n,n+i);t.call(this,e,n,i,r),this._prevBlock=o}}),e}(),r.mode.CFB)},9968:function(e,t,n){var r;e.exports=(r=n(8249),n(5109),r.mode.CTRGladman=function(){var e=r.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}else e+=1<<24;return e}var n=e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize,o=this._iv,s=this._counter;o&&(s=this._counter=o.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(s);var a=s.slice(0);r.encryptBlock(a,0);for(var c=0;c<i;c++)e[n+c]^=a[c]}});return e.Decryptor=n,e}(),r.mode.CTRGladman)},4242:function(e,t,n){var r,i,o;e.exports=(o=n(8249),n(5109),o.mode.CTR=(i=(r=o.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,o=this._counter;i&&(o=this._counter=i.slice(0),this._iv=void 0);var s=o.slice(0);n.encryptBlock(s,0),o[r-1]=o[r-1]+1|0;for(var a=0;a<r;a++)e[t+a]^=s[a]}}),r.Decryptor=i,r),o.mode.CTR)},1148:function(e,t,n){var r,i;e.exports=(i=n(8249),n(5109),i.mode.ECB=((r=i.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),r.Decryptor=r.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),r),i.mode.ECB)},7660:function(e,t,n){var r,i,o;e.exports=(o=n(8249),n(5109),o.mode.OFB=(i=(r=o.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,o=this._keystream;i&&(o=this._keystream=i.slice(0),this._iv=void 0),n.encryptBlock(o,0);for(var s=0;s<r;s++)e[t+s]^=o[s]}}),r.Decryptor=i,r),o.mode.OFB)},3615:function(e,t,n){var r;e.exports=(r=n(8249),n(5109),r.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,r=4*t,i=r-n%r,o=n+i-1;e.clamp(),e.words[o>>>2]|=i<<24-o%4*8,e.sigBytes+=i},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Ansix923)},2807:function(e,t,n){var r;e.exports=(r=n(8249),n(5109),r.pad.Iso10126={pad:function(e,t){var n=4*t,i=n-e.sigBytes%n;e.concat(r.lib.WordArray.random(i-1)).concat(r.lib.WordArray.create([i<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Iso10126)},1077:function(e,t,n){var r;e.exports=(r=n(8249),n(5109),r.pad.Iso97971={pad:function(e,t){e.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(e,t)},unpad:function(e){r.pad.ZeroPadding.unpad(e),e.sigBytes--}},r.pad.Iso97971)},6991:function(e,t,n){var r;e.exports=(r=n(8249),n(5109),r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding)},6475:function(e,t,n){var r;e.exports=(r=n(8249),n(5109),r.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){var t=e.words,n=e.sigBytes-1;for(n=e.sigBytes-1;n>=0;n--)if(t[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},r.pad.ZeroPadding)},2112:function(e,t,n){var r,i,o,s,a,c,u,l,h;e.exports=(h=n(8249),n(2783),n(9824),o=(i=(r=h).lib).Base,s=i.WordArray,c=(a=r.algo).SHA1,u=a.HMAC,l=a.PBKDF2=o.extend({cfg:o.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=u.create(n.hasher,e),i=s.create(),o=s.create([1]),a=i.words,c=o.words,l=n.keySize,h=n.iterations;a.length<l;){var d=r.update(t).finalize(o);r.reset();for(var f=d.words,p=f.length,m=d,v=1;v<h;v++){m=r.finalize(m),r.reset();for(var g=m.words,y=0;y<p;y++)f[y]^=g[y]}i.concat(d),c[0]++}return i.sigBytes=4*l,i}}),r.PBKDF2=function(e,t,n){return l.create(n).compute(e,t)},h.PBKDF2)},3974:function(e,t,n){var r;e.exports=(r=n(8249),n(8269),n(8214),n(888),n(5109),function(){var e=r,t=e.lib.StreamCipher,n=e.algo,i=[],o=[],s=[],a=n.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var i=0;i<4;i++)c.call(this);for(i=0;i<8;i++)r[i]^=n[i+4&7];if(t){var o=t.words,s=o[0],a=o[1],u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),l=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),h=u>>>16|4294901760&l,d=l<<16|65535&u;for(r[0]^=u,r[1]^=h,r[2]^=l,r[3]^=d,r[4]^=u,r[5]^=h,r[6]^=l,r[7]^=d,i=0;i<4;i++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),i[0]=n[0]^n[5]>>>16^n[3]<<16,i[1]=n[2]^n[7]>>>16^n[5]<<16,i[2]=n[4]^n[1]>>>16^n[7]<<16,i[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)o[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],i=65535&r,a=r>>>16,c=((i*i>>>17)+i*a>>>15)+a*a,u=((4294901760&r)*r|0)+((65535&r)*r|0);s[n]=c^u}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}e.RabbitLegacy=t._createHelper(a)}(),r.RabbitLegacy)},4454:function(e,t,n){var r;e.exports=(r=n(8249),n(8269),n(8214),n(888),n(5109),function(){var e=r,t=e.lib.StreamCipher,n=e.algo,i=[],o=[],s=[],a=n.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)c.call(this);for(n=0;n<8;n++)i[n]^=r[n+4&7];if(t){var o=t.words,s=o[0],a=o[1],u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),l=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),h=u>>>16|4294901760&l,d=l<<16|65535&u;for(i[0]^=u,i[1]^=h,i[2]^=l,i[3]^=d,i[4]^=u,i[5]^=h,i[6]^=l,i[7]^=d,n=0;n<4;n++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),i[0]=n[0]^n[5]>>>16^n[3]<<16,i[1]=n[2]^n[7]>>>16^n[5]<<16,i[2]=n[4]^n[1]>>>16^n[7]<<16,i[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)o[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],i=65535&r,a=r>>>16,c=((i*i>>>17)+i*a>>>15)+a*a,u=((4294901760&r)*r|0)+((65535&r)*r|0);s[n]=c^u}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}e.Rabbit=t._createHelper(a)}(),r.Rabbit)},1857:function(e,t,n){var r;e.exports=(r=n(8249),n(8269),n(8214),n(888),n(5109),function(){var e=r,t=e.lib.StreamCipher,n=e.algo,i=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[],i=0;i<256;i++)r[i]=i;i=0;for(var o=0;i<256;i++){var s=i%n,a=t[s>>>2]>>>24-s%4*8&255;o=(o+r[i]+a)%256;var c=r[i];r[i]=r[o],r[o]=c}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=o.call(this)},keySize:8,ivSize:0});function o(){for(var e=this._S,t=this._i,n=this._j,r=0,i=0;i<4;i++){n=(n+e[t=(t+1)%256])%256;var o=e[t];e[t]=e[n],e[n]=o,r|=e[(e[t]+e[n])%256]<<24-8*i}return this._i=t,this._j=n,r}e.RC4=t._createHelper(i);var s=n.RC4Drop=i.extend({cfg:i.cfg.extend({drop:192}),_doReset:function(){i._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)o.call(this)}});e.RC4Drop=t._createHelper(s)}(),r.RC4)},706:function(e,t,n){var r;e.exports=(r=n(8249),function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,s=t.algo,a=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),h=i.create([0,1518500249,1859775393,2400959708,2840853838]),d=i.create([1352829926,1548603684,1836072691,2053994217,0]),f=s.RIPEMD160=o.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o,s,f,b,w,k,C,S,x,E,T,R=this._hash.words,P=h.words,A=d.words,O=a.words,I=c.words,D=u.words,j=l.words;for(k=o=R[0],C=s=R[1],S=f=R[2],x=b=R[3],E=w=R[4],n=0;n<80;n+=1)T=o+e[t+O[n]]|0,T+=n<16?p(s,f,b)+P[0]:n<32?m(s,f,b)+P[1]:n<48?v(s,f,b)+P[2]:n<64?g(s,f,b)+P[3]:y(s,f,b)+P[4],T=(T=_(T|=0,D[n]))+w|0,o=w,w=b,b=_(f,10),f=s,s=T,T=k+e[t+I[n]]|0,T+=n<16?y(C,S,x)+A[0]:n<32?g(C,S,x)+A[1]:n<48?v(C,S,x)+A[2]:n<64?m(C,S,x)+A[3]:p(C,S,x)+A[4],T=(T=_(T|=0,j[n]))+E|0,k=E,E=x,x=_(S,10),S=C,C=T;T=R[1]+f+x|0,R[1]=R[2]+b+E|0,R[2]=R[3]+w+k|0,R[3]=R[4]+o+C|0,R[4]=R[0]+s+S|0,R[0]=T},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var i=this._hash,o=i.words,s=0;s<5;s++){var a=o[s];o[s]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}return i},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function p(e,t,n){return e^t^n}function m(e,t,n){return e&t|~e&n}function v(e,t,n){return(e|~t)^n}function g(e,t,n){return e&n|t&~n}function y(e,t,n){return e^(t|~n)}function _(e,t){return e<<t|e>>>32-t}t.RIPEMD160=o._createHelper(f),t.HmacRIPEMD160=o._createHmacHelper(f)}(Math),r.RIPEMD160)},2783:function(e,t,n){var r,i,o,s,a,c,u,l;e.exports=(i=(r=l=n(8249)).lib,o=i.WordArray,s=i.Hasher,a=r.algo,c=[],u=a.SHA1=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],u=0;u<80;u++){if(u<16)c[u]=0|e[t+u];else{var l=c[u-3]^c[u-8]^c[u-14]^c[u-16];c[u]=l<<1|l>>>31}var h=(r<<5|r>>>27)+a+c[u];h+=u<20?1518500249+(i&o|~i&s):u<40?1859775393+(i^o^s):u<60?(i&o|i&s|o&s)-1894007588:(i^o^s)-899497514,a=s,s=o,o=i<<30|i>>>2,i=r,r=h}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),r.SHA1=s._createHelper(u),r.HmacSHA1=s._createHmacHelper(u),l.SHA1)},7792:function(e,t,n){var r,i,o,s,a,c;e.exports=(r=n(8249),n(2153),o=(i=r).lib.WordArray,s=i.algo,a=s.SHA256,c=s.SHA224=a.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=4,e}}),i.SHA224=a._createHelper(c),i.HmacSHA224=a._createHmacHelper(c),r.SHA224)},2153:function(e,t,n){var r;e.exports=(r=n(8249),function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,s=t.algo,a=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)t(r)&&(i<8&&(a[i]=n(e.pow(r,.5))),c[i]=n(e.pow(r,1/3)),i++),r++}();var u=[],l=s.SHA256=o.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],l=n[5],h=n[6],d=n[7],f=0;f<64;f++){if(f<16)u[f]=0|e[t+f];else{var p=u[f-15],m=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,v=u[f-2],g=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;u[f]=m+u[f-7]+g+u[f-16]}var y=r&i^r&o^i&o,_=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),b=d+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&h)+c[f]+u[f];d=h,h=l,l=a,a=s+b|0,s=o,o=i,i=r,r=b+(_+y)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+l|0,n[6]=n[6]+h|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(l),t.HmacSHA256=o._createHmacHelper(l)}(Math),r.SHA256)},3327:function(e,t,n){var r;e.exports=(r=n(8249),n(4938),function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,s=t.x64.Word,a=t.algo,c=[],u=[],l=[];!function(){for(var e=1,t=0,n=0;n<24;n++){c[e+5*t]=(n+1)*(n+2)/2%64;var r=(2*e+3*t)%5;e=t%5,t=r}for(e=0;e<5;e++)for(t=0;t<5;t++)u[e+5*t]=t+(2*e+3*t)%5*5;for(var i=1,o=0;o<24;o++){for(var a=0,h=0,d=0;d<7;d++){if(1&i){var f=(1<<d)-1;f<32?h^=1<<f:a^=1<<f-32}128&i?i=i<<1^113:i<<=1}l[o]=s.create(a,h)}}();var h=[];!function(){for(var e=0;e<25;e++)h[e]=s.create()}();var d=a.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new s.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,r=this.blockSize/2,i=0;i<r;i++){var o=e[t+2*i],s=e[t+2*i+1];o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),(R=n[i]).high^=s,R.low^=o}for(var a=0;a<24;a++){for(var d=0;d<5;d++){for(var f=0,p=0,m=0;m<5;m++)f^=(R=n[d+5*m]).high,p^=R.low;var v=h[d];v.high=f,v.low=p}for(d=0;d<5;d++){var g=h[(d+4)%5],y=h[(d+1)%5],_=y.high,b=y.low;for(f=g.high^(_<<1|b>>>31),p=g.low^(b<<1|_>>>31),m=0;m<5;m++)(R=n[d+5*m]).high^=f,R.low^=p}for(var w=1;w<25;w++){var k=(R=n[w]).high,C=R.low,S=c[w];S<32?(f=k<<S|C>>>32-S,p=C<<S|k>>>32-S):(f=C<<S-32|k>>>64-S,p=k<<S-32|C>>>64-S);var x=h[u[w]];x.high=f,x.low=p}var E=h[0],T=n[0];for(E.high=T.high,E.low=T.low,d=0;d<5;d++)for(m=0;m<5;m++){var R=n[w=d+5*m],P=h[w],A=h[(d+1)%5+5*m],O=h[(d+2)%5+5*m];R.high=P.high^~A.high&O.high,R.low=P.low^~A.low&O.low}R=n[0];var I=l[a];R.high^=I.high,R.low^=I.low}},_doFinalize:function(){var t=this._data,n=t.words,r=(this._nDataBytes,8*t.sigBytes),o=32*this.blockSize;n[r>>>5]|=1<<24-r%32,n[(e.ceil((r+1)/o)*o>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var s=this._state,a=this.cfg.outputLength/8,c=a/8,u=[],l=0;l<c;l++){var h=s[l],d=h.high,f=h.low;d=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),u.push(f),u.push(d)}return new i.init(u,a)},clone:function(){for(var e=o.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=o._createHelper(d),t.HmacSHA3=o._createHmacHelper(d)}(Math),r.SHA3)},7460:function(e,t,n){var r,i,o,s,a,c,u,l;e.exports=(l=n(8249),n(4938),n(34),i=(r=l).x64,o=i.Word,s=i.WordArray,a=r.algo,c=a.SHA512,u=a.SHA384=c.extend({_doReset:function(){this._hash=new s.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var e=c._doFinalize.call(this);return e.sigBytes-=16,e}}),r.SHA384=c._createHelper(u),r.HmacSHA384=c._createHmacHelper(u),l.SHA384)},34:function(e,t,n){var r;e.exports=(r=n(8249),n(4938),function(){var e=r,t=e.lib.Hasher,n=e.x64,i=n.Word,o=n.WordArray,s=e.algo;function a(){return i.create.apply(i,arguments)}var c=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],u=[];!function(){for(var e=0;e<80;e++)u[e]=a()}();var l=s.SHA512=t.extend({_doReset:function(){this._hash=new o.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],l=n[5],h=n[6],d=n[7],f=r.high,p=r.low,m=i.high,v=i.low,g=o.high,y=o.low,_=s.high,b=s.low,w=a.high,k=a.low,C=l.high,S=l.low,x=h.high,E=h.low,T=d.high,R=d.low,P=f,A=p,O=m,I=v,D=g,j=y,B=_,z=b,M=w,L=k,F=C,N=S,U=x,W=E,H=T,$=R,G=0;G<80;G++){var q,Z,V=u[G];if(G<16)Z=V.high=0|e[t+2*G],q=V.low=0|e[t+2*G+1];else{var K=u[G-15],J=K.high,Y=K.low,X=(J>>>1|Y<<31)^(J>>>8|Y<<24)^J>>>7,Q=(Y>>>1|J<<31)^(Y>>>8|J<<24)^(Y>>>7|J<<25),ee=u[G-2],te=ee.high,ne=ee.low,re=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,ie=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),oe=u[G-7],se=oe.high,ae=oe.low,ce=u[G-16],ue=ce.high,le=ce.low;Z=(Z=(Z=X+se+((q=Q+ae)>>>0<Q>>>0?1:0))+re+((q+=ie)>>>0<ie>>>0?1:0))+ue+((q+=le)>>>0<le>>>0?1:0),V.high=Z,V.low=q}var he,de=M&F^~M&U,fe=L&N^~L&W,pe=P&O^P&D^O&D,me=A&I^A&j^I&j,ve=(P>>>28|A<<4)^(P<<30|A>>>2)^(P<<25|A>>>7),ge=(A>>>28|P<<4)^(A<<30|P>>>2)^(A<<25|P>>>7),ye=(M>>>14|L<<18)^(M>>>18|L<<14)^(M<<23|L>>>9),_e=(L>>>14|M<<18)^(L>>>18|M<<14)^(L<<23|M>>>9),be=c[G],we=be.high,ke=be.low,Ce=H+ye+((he=$+_e)>>>0<$>>>0?1:0),Se=ge+me;H=U,$=W,U=F,W=N,F=M,N=L,M=B+(Ce=(Ce=(Ce=Ce+de+((he+=fe)>>>0<fe>>>0?1:0))+we+((he+=ke)>>>0<ke>>>0?1:0))+Z+((he+=q)>>>0<q>>>0?1:0))+((L=z+he|0)>>>0<z>>>0?1:0)|0,B=D,z=j,D=O,j=I,O=P,I=A,P=Ce+(ve+pe+(Se>>>0<ge>>>0?1:0))+((A=he+Se|0)>>>0<he>>>0?1:0)|0}p=r.low=p+A,r.high=f+P+(p>>>0<A>>>0?1:0),v=i.low=v+I,i.high=m+O+(v>>>0<I>>>0?1:0),y=o.low=y+j,o.high=g+D+(y>>>0<j>>>0?1:0),b=s.low=b+z,s.high=_+B+(b>>>0<z>>>0?1:0),k=a.low=k+L,a.high=w+M+(k>>>0<L>>>0?1:0),S=l.low=S+N,l.high=C+F+(S>>>0<N>>>0?1:0),E=h.low=E+W,h.high=x+U+(E>>>0<W>>>0?1:0),R=d.low=R+$,d.high=T+H+(R>>>0<$>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(l),e.HmacSHA512=t._createHmacHelper(l)}(),r.SHA512)},4253:function(e,t,n){var r;e.exports=(r=n(8249),n(8269),n(8214),n(888),n(5109),function(){var e=r,t=e.lib,n=t.WordArray,i=t.BlockCipher,o=e.algo,s=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=o.DES=i.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var r=s[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(var i=this._subKeys=[],o=0;o<16;o++){var u=i[o]=[],l=c[o];for(n=0;n<24;n++)u[n/6|0]|=t[(a[n]-1+l)%28]<<31-n%6,u[4+(n/6|0)]|=t[28+(a[n+24]-1+l)%28]<<31-n%6;for(u[0]=u[0]<<1|u[0]>>>31,n=1;n<7;n++)u[n]=u[n]>>>4*(n-1)+3;u[7]=u[7]<<5|u[7]>>>27}var h=this._invSubKeys=[];for(n=0;n<16;n++)h[n]=i[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],d.call(this,4,252645135),d.call(this,16,65535),f.call(this,2,858993459),f.call(this,8,16711935),d.call(this,1,1431655765);for(var r=0;r<16;r++){for(var i=n[r],o=this._lBlock,s=this._rBlock,a=0,c=0;c<8;c++)a|=u[c][((s^i[c])&l[c])>>>0];this._lBlock=s,this._rBlock=o^a}var h=this._lBlock;this._lBlock=this._rBlock,this._rBlock=h,d.call(this,1,1431655765),f.call(this,8,16711935),f.call(this,2,858993459),d.call(this,16,65535),d.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function d(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function f(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=i._createHelper(h);var p=o.TripleDES=i.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),r=e.length<4?e.slice(0,2):e.slice(2,4),i=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=h.createEncryptor(n.create(t)),this._des2=h.createEncryptor(n.create(r)),this._des3=h.createEncryptor(n.create(i))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=i._createHelper(p)}(),r.TripleDES)},4938:function(e,t,n){var r,i,o,s,a,c;e.exports=(r=n(8249),o=(i=r).lib,s=o.Base,a=o.WordArray,(c=i.x64={}).Word=s.extend({init:function(e,t){this.high=e,this.low=t}}),c.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var i=e[r];n.push(i.high),n.push(i.low)}return a.create(n,this.sigBytes)},clone:function(){for(var e=s.clone.call(this),t=e.words=this.words.slice(0),n=t.length,r=0;r<n;r++)t[r]=t[r].clone();return e}}),r)},3536:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=n.p+"8e9c8bd59a9fc4189c74b3530479d3d6.minimud"},3162:function(e,t,n){var r,i;void 0===(i="function"==typeof(r=function(){"use strict";function t(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){a(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,s=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,n,s){var a=o.URL||o.webkitURL,c=document.createElement("a");n=n||e.name||"download",c.download=n,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?i(c):r(c.href)?t(e,n,s):i(c,c.target="_blank")):(c.href=a.createObjectURL(e),setTimeout((function(){a.revokeObjectURL(c.href)}),4e4),setTimeout((function(){i(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,o){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,o),n);else if(r(e))t(e,n,o);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){i(s)}))}}:function(e,n,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,r);var a="application/octet-stream"===e.type,c=/constructor/i.test(o.HTMLElement)||o.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||a&&c||s)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var e=l.result;e=u?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},l.readAsDataURL(e)}else{var h=o.URL||o.webkitURL,d=h.createObjectURL(e);i?i.location=d:location.href=d,i=null,setTimeout((function(){h.revokeObjectURL(d)}),4e4)}});o.saveAs=a.saveAs=a,e.exports=a})?r.apply(t,[]):r)||(e.exports=i)},5733:(e,t,n)=>{e.exports=function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,(function(e){return i(t[s][1][e]||e)}),u,u.exports,e,t,n,r)}return n[s].exports}for(var o=void 0,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,i,s,a,c,u,l=[],h=0,d=e.length,f=d,p="string"!==r.getTypeOf(e);h<e.length;)f=d-h,i=p?(t=e[h++],n=h<d?e[h++]:0,h<d?e[h++]:0):(t=e.charCodeAt(h++),n=h<d?e.charCodeAt(h++):0,h<d?e.charCodeAt(h++):0),s=t>>2,a=(3&t)<<4|n>>4,c=1<f?(15&n)<<2|i>>6:64,u=2<f?63&i:64,l.push(o.charAt(s)+o.charAt(a)+o.charAt(c)+o.charAt(u));return l.join("")},n.decode=function(e){var t,n,r,s,a,c,u=0,l=0,h="data:";if(e.substr(0,5)===h)throw new Error("Invalid base64 input, it looks like a data url.");var d,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===o.charAt(64)&&f--,e.charAt(e.length-2)===o.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=i.uint8array?new Uint8Array(0|f):new Array(0|f);u<e.length;)t=o.indexOf(e.charAt(u++))<<2|(s=o.indexOf(e.charAt(u++)))>>4,n=(15&s)<<4|(a=o.indexOf(e.charAt(u++)))>>2,r=(3&a)<<6|(c=o.indexOf(e.charAt(u++))),d[l++]=t,64!==a&&(d[l++]=n),64!==c&&(d[l++]=r);return d}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var r=e("./external"),i=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),s=e("./stream/DataLengthProbe");function a(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}a.prototype={getContentWorker:function(){var e=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(e,t,n){return e.pipe(new o).pipe(new s("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new s("compressedSize")).withStreamInfo("compression",t)},t.exports=a},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var r=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var r=e("./utils"),i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,n,r){var o=i,s=0+n;e^=-1;for(var a=0;a<s;a++)e=e>>>8^o[255&(e^t[a])];return-1^e}(0|t,e,e.length):function(e,t,n,r){var o=i,s=0+n;e^=-1;for(var a=0;a<s;a++)e=e>>>8^o[255&(e^t.charCodeAt(a))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var r;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),o=e("./utils"),s=e("./stream/GenericWorker"),a=r?"uint8array":"array";function c(e,t){s.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",o.inherits(c,s),c.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(a,e.data),!1)},c.prototype.flush=function(){s.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new c("Deflate",e)},n.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";function r(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r}function i(e,t,n,i,s,l){var h,d,f=e.file,p=e.compression,m=l!==a.utf8encode,v=o.transformTo("string",l(f.name)),g=o.transformTo("string",a.utf8encode(f.name)),y=f.comment,_=o.transformTo("string",l(y)),b=o.transformTo("string",a.utf8encode(y)),w=g.length!==f.name.length,k=b.length!==y.length,C="",S="",x="",E=f.dir,T=f.date,R={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(R.crc32=e.crc32,R.compressedSize=e.compressedSize,R.uncompressedSize=e.uncompressedSize);var P=0;t&&(P|=8),m||!w&&!k||(P|=2048);var A=0,O=0;E&&(A|=16),"UNIX"===s?(O=798,A|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(f.unixPermissions,E)):(O=20,A|=function(e){return 63&(e||0)}(f.dosPermissions)),h=T.getUTCHours(),h<<=6,h|=T.getUTCMinutes(),h<<=5,h|=T.getUTCSeconds()/2,d=T.getUTCFullYear()-1980,d<<=4,d|=T.getUTCMonth()+1,d<<=5,d|=T.getUTCDate(),w&&(S=r(1,1)+r(c(v),4)+g,C+="up"+r(S.length,2)+S),k&&(x=r(1,1)+r(c(_),4)+b,C+="uc"+r(x.length,2)+x);var I="";return I+="\n\0",I+=r(P,2),I+=p.magic,I+=r(h,2),I+=r(d,2),I+=r(R.crc32,4),I+=r(R.compressedSize,4),I+=r(R.uncompressedSize,4),I+=r(v.length,2),I+=r(C.length,2),{fileRecord:u.LOCAL_FILE_HEADER+I+v+C,dirRecord:u.CENTRAL_FILE_HEADER+r(O,2)+I+r(_.length,2)+"\0\0\0\0"+r(A,4)+r(i,4)+v+C+_}}var o=e("../utils"),s=e("../stream/GenericWorker"),a=e("../utf8"),c=e("../crc32"),u=e("../signature");function l(e,t,n,r){s.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(l,s),l.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,s.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},l.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=i(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},l.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=i(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:function(e){return u.DATA_DESCRIPTOR+r(e.crc32,4)+r(e.compressedSize,4)+r(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},l.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,i=function(e,t,n,i,s){var a=o.transformTo("string",s(i));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(e,2)+r(e,2)+r(t,4)+r(n,4)+r(a.length,2)+a}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},l.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},l.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},l.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},l.prototype.error=function(e){var t=this._sources;if(!s.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},l.prototype.lock=function(){s.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=l},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var r=e("../compressions"),i=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var o=new i(t.streamFiles,n,t.platform,t.encodeFileName),s=0;try{e.forEach((function(e,n){s++;var i=function(e,t){var n=e||t,i=r[n];if(!i)throw new Error(n+" is not a valid compression method !");return i}(n.options.compression,t.compression),a=n.options.compressionOptions||t.compressionOptions||{},c=n.dir,u=n.date;n._compressWorker(i,a).withStreamInfo("file",{name:e,dir:c,date:u,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(o)})),o.entriesCount=s}catch(e){o.error(e)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./external"),o=e("./utf8"),s=e("./zipEntries"),a=e("./stream/Crc32Probe"),c=e("./nodejsUtils");function u(e){return new i.Promise((function(t,n){var r=e.decompressed.getContentWorker().pipe(new a);r.on("error",(function(e){n(e)})).on("end",(function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),c.isNode&&c.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var n=new s(t);return n.load(e),n})).then((function(e){var n=[i.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var o=0;o<r.length;o++)n.push(u(r[o]));return i.Promise.all(n)})).then((function(e){for(var i=e.shift(),o=i.files,s=0;s<o.length;s++){var a=o[s],c=a.fileNameStr,u=r.resolve(a.fileNameStr);n.file(u,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:t.createFolders}),a.dir||(n.file(u).unsafeOriginalName=c)}return i.zipComment.length&&(n.comment=i.zipComment),n}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../stream/GenericWorker");function o(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(o,i),o.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var r=e("readable-stream").Readable;function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on("data",(function(e,t){i.push(e)||i._helper.pause(),n&&n(t)})).on("error",(function(e){i.emit("error",e)})).on("end",(function(){i.push(null)}))}e("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";function r(e,t,n){var r,i=o.getTypeOf(t),a=o.extend(n||{},c);a.date=a.date||new Date,null!==a.compression&&(a.compression=a.compression.toUpperCase()),"string"==typeof a.unixPermissions&&(a.unixPermissions=parseInt(a.unixPermissions,8)),a.unixPermissions&&16384&a.unixPermissions&&(a.dir=!0),a.dosPermissions&&16&a.dosPermissions&&(a.dir=!0),a.dir&&(e=m(e)),a.createFolders&&(r=p(e))&&v.call(this,r,!0);var h="string"===i&&!1===a.binary&&!1===a.base64;n&&void 0!==n.binary||(a.binary=!h),(t instanceof u&&0===t.uncompressedSize||a.dir||!t||0===t.length)&&(a.base64=!1,a.binary=!0,t="",a.compression="STORE",i="string");var g;g=t instanceof u||t instanceof s?t:d.isNode&&d.isStream(t)?new f(e,t):o.prepareContent(e,t,a.binary,a.optimizedBinaryString,a.base64);var y=new l(e,g,a);this.files[e]=y}var i=e("./utf8"),o=e("./utils"),s=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),c=e("./defaults"),u=e("./compressedObject"),l=e("./zipObject"),h=e("./generate"),d=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},v=function(e,t){return t=void 0!==t?t:c.createFolders,e=m(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function g(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach((function(n,r){e(n,r)&&t.push(r)})),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,n),this;if(g(e)){var i=e;return this.filter((function(e,t){return!t.dir&&i.test(e)}))}var o=this.files[this.root+e];return o&&!o.dir?o:null},folder:function(e){if(!e)return this;if(g(e))return this.filter((function(t,n){return n.dir&&e.test(t)}));var t=this.root+e,n=v.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter((function(t,n){return n.name.slice(0,e.length)===e})),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=o.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");o.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var r=n.comment||this.comment||"";t=h.generateWorker(this,n,r)}catch(e){(t=new s("error")).error(e)}return new a(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===t&&this.data[o+1]===n&&this.data[o+2]===r&&this.data[o+3]===i)return o-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&n===o[1]&&r===o[2]&&i===o[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var r=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,n){"use strict";var r=e("./Uint8ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var r=e("./ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../support"),o=e("./ArrayReader"),s=e("./StringReader"),a=e("./NodeBufferReader"),c=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new a(e):i.uint8array?new c(r.transformTo("uint8array",e)):new o(r.transformTo("array",e)):new s(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../utils");function o(e){r.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(o,r),o.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../crc32");function o(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,r),o.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function o(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(o,i),o.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function o(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}r.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./ConvertWorker"),o=e("./GenericWorker"),s=e("../base64"),a=e("../support"),c=e("../external"),u=null;if(a.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function l(e,t,n){var s=t;switch(t){case"blob":case"arraybuffer":s="uint8array";break;case"base64":s="string"}try{this._internalType=s,this._outputType=t,this._mimeType=n,r.checkSupport(s),this._worker=e.pipe(new i(s)),e.lock()}catch(e){this._worker=new o("error"),this._worker.error(e)}}l.prototype={accumulate:function(e){return function(e,t){return new c.Promise((function(n,i){var o=[],a=e._internalType,c=e._outputType,u=e._mimeType;e.on("data",(function(e,n){o.push(e),t&&t(n)})).on("error",(function(e){o=[],i(e)})).on("end",(function(){try{var e=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return s.encode(t);default:return r.transformTo(e,t)}}(c,function(e,t){var n,r=0,i=null,o=0;for(n=0;n<t.length;n++)o+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(o),n=0;n<t.length;n++)i.set(t[n],r),r+=t[n].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(a,o),u);n(e)}catch(e){i(e)}o=[]})).resume()}))}(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,(function(e){t.call(n,e.data,e.meta)})):this._worker.on(e,(function(){r.delay(t,arguments,n)})),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=l},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(r),n.blob=0===i.getBlob("application/zip").size}catch(e){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(e){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var r=e("./utils"),i=e("./support"),o=e("./nodejsUtils"),s=e("./stream/GenericWorker"),a=new Array(256),c=0;c<256;c++)a[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(){s.call(this,"utf-8 decode"),this.leftOver=null}function l(){s.call(this,"utf-8 encode")}a[254]=a[254]=1,n.utf8encode=function(e){return i.nodebuffer?o.newBufferFrom(e,"utf-8"):function(e){var t,n,r,o,s,a=e.length,c=0;for(o=0;o<a;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),c+=n<128?1:n<2048?2:n<65536?3:4;for(t=i.uint8array?new Uint8Array(c):new Array(c),o=s=0;s<c;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),n<128?t[s++]=n:(n<2048?t[s++]=192|n>>>6:(n<65536?t[s++]=224|n>>>12:(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63),t[s++]=128|n>>>6&63),t[s++]=128|63&n);return t}(e)},n.utf8decode=function(e){return i.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,i,o,s=e.length,c=new Array(2*s);for(t=n=0;t<s;)if((i=e[t++])<128)c[n++]=i;else if(4<(o=a[i]))c[n++]=65533,t+=o-1;else{for(i&=2===o?31:3===o?15:7;1<o&&t<s;)i=i<<6|63&e[t++],o--;1<o?c[n++]=65533:i<65536?c[n++]=i:(i-=65536,c[n++]=55296|i>>10&1023,c[n++]=56320|1023&i)}return c.length!==n&&(c.subarray?c=c.subarray(0,n):c.length=n),r.applyFromCharCode(c)}(e=r.transformTo(i.uint8array?"uint8array":"array",e))},r.inherits(u,s),u.prototype.processChunk=function(e){var t=r.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var o=t;(t=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),t.set(o,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var s=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+a[e[n]]>t?n:t}(t),c=t;s!==t.length&&(i.uint8array?(c=t.subarray(0,s),this.leftOver=t.subarray(s,t.length)):(c=t.slice(0,s),this.leftOver=t.slice(s,t.length))),this.push({data:n.utf8decode(c),meta:e.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=u,r.inherits(l,s),l.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=l},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";var r=e("./support"),i=e("./base64"),o=e("./nodejsUtils"),s=e("./external");function a(e){return e}function c(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(n){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(e,t,n){var r=[],i=0,o=e.length;if(o<=n)return String.fromCharCode.apply(null,e);for(;i<o;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,o)))):r.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,o)))),i+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(e){return!1}}()}};function l(e){var t=65536,r=n.getTypeOf(e),i=!0;if("uint8array"===r?i=u.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=u.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return u.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return u.stringifyByChar(e)}function h(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=l;var d={};d.string={string:a,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return d.string.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:function(e){return c(e,o.allocBuffer(e.length))}},d.array={string:l,array:a,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(e)}},d.arraybuffer={string:function(e){return l(new Uint8Array(e))},array:function(e){return h(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:a,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(new Uint8Array(e))}},d.uint8array={string:l,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:a,nodebuffer:function(e){return o.newBufferFrom(e)}},d.nodebuffer={string:l,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return d.nodebuffer.uint8array(e).buffer},uint8array:function(e){return h(e,new Uint8Array(e.length))},nodebuffer:a},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return d[r][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var i=t[r];"."===i||""===i&&0!==r&&r!==t.length-1||(".."===i?n.pop():n.push(i))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&o.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},n.delay=function(e,t,n){setImmediate((function(){e.apply(n||null,t||[])}))},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,o,a,u){return s.Promise.resolve(t).then((function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new s.Promise((function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)})):e})).then((function(t){var l=n.getTypeOf(t);return l?("arraybuffer"===l?t=n.transformTo("uint8array",t):"string"===l&&(u?t=i.decode(t):o&&!0!==a&&(t=function(e){return c(e,r.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):s.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),o=e("./signature"),s=e("./zipEntry"),a=e("./support");function c(e){this.files=[],this.loadOptions=e}c.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=a.uint8array?"uint8array":"array",n=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(e=new s({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(0<r)this.isSignature(t,o.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),o=e("./compressedObject"),s=e("./crc32"),a=e("./utf8"),c=e("./compressions"),u=e("./support");function l(e,t){this.options=e,this.loadOptions=t}l.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in c)if(Object.prototype.hasOwnProperty.call(c,t)&&c[t].magic===e)return c[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,r,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(i)},handleUTF8:function(){var e=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var o=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||s(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||s(this.fileComment)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null}},t.exports=l},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";function r(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var i=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),s=e("./utf8"),a=e("./compressedObject"),c=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var o=!this._dataBinary;o&&!r&&(t=t.pipe(new s.Utf8EncodeWorker)),!o&&r&&(t=t.pipe(new s.Utf8DecodeWorker))}catch(e){(t=new c("error")).error(e)}return new i(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof a&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new s.Utf8EncodeWorker)),a.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof c?this._data:new o(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],l=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<u.length;h++)r.prototype[u[h]]=l;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){"use strict";var n,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,s=new i(l),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),n=function(){a.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){l(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(l,0)};else{var c=new e.MessageChannel;c.port1.onmessage=l,n=function(){c.port2.postMessage(0)}}var u=[];function l(){var e,t;r=!0;for(var n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}r=!1}t.exports=function(e){1!==u.push(e)||r||n()}}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){"use strict";var r=e("immediate");function i(){}var o={},s=["REJECTED"],a=["FULFILLED"],c=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==i&&f(this,e)}function l(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(e,t,n){r((function(){var r;try{r=t(n)}catch(r){return o.reject(e,r)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function i(t){n||(n=!0,o.resolve(e,t))}var s=p((function(){t(i,r)}));"error"===s.status&&r(s.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=u).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){throw n}))}))},u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var n=new this.constructor(i);return this.state!==c?h(n,this.state===a?e:t,this.outcome):this.queue.push(new l(n,e,t)),n},l.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){o.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=p(d,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)f(e,r);else{e.state=a,e.outcome=t;for(var i=-1,s=e.queue.length;++i<s;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=s,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},u.resolve=function(e){return e instanceof this?e:o.resolve(new this(i),e)},u.reject=function(e){var t=new this(i);return o.reject(t,e)},u.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,c=-1,u=new this(i);++c<n;)l(e[c],c);return u;function l(e,i){t.resolve(e).then((function(e){s[i]=e,++a!==n||r||(r=!0,o.resolve(u,s))}),(function(e){r||(r=!0,o.reject(u,e))}))}},u.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var r,s=-1,a=new this(i);++s<t;)r=e[s],this.resolve(r).then((function(e){n||(n=!0,o.resolve(a,e))}),(function(e){n||(n=!0,o.reject(a,e))}));return a}},{immediate:36}],38:[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var r=e("./zlib/deflate"),i=e("./utils/common"),o=e("./utils/strings"),s=e("./zlib/messages"),a=e("./zlib/zstream"),c=Object.prototype.toString,u=0,l=-1,h=0,d=8;function f(e){if(!(this instanceof f))return new f(e);this.options=i.assign({level:l,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==u)throw new Error(s[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var p;if(p="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=r.deflateSetDictionary(this.strm,p))!==u)throw new Error(s[n]);this._dict_set=!0}}function p(e,t){var n=new f(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}f.prototype.push=function(e,t){var n,s,a=this.strm,l=this.options.chunkSize;if(this.ended)return!1;s=t===~~t?t:!0===t?4:0,"string"==typeof e?a.input=o.string2buf(e):"[object ArrayBuffer]"===c.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new i.Buf8(l),a.next_out=0,a.avail_out=l),1!==(n=r.deflate(a,s))&&n!==u)return this.onEnd(n),!(this.ended=!0);0!==a.avail_out&&(0!==a.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(a.output,a.next_out))):this.onData(i.shrinkBuf(a.output,a.next_out)))}while((0<a.avail_in||0===a.avail_out)&&1!==n);return 4===s?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===u):2!==s||(this.onEnd(u),!(a.avail_out=0))},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){e===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=f,n.deflate=p,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,p(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var r=e("./zlib/inflate"),i=e("./utils/common"),o=e("./utils/strings"),s=e("./zlib/constants"),a=e("./zlib/messages"),c=e("./zlib/zstream"),u=e("./zlib/gzheader"),l=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==s.Z_OK)throw new Error(a[n]);this.header=new u,r.inflateGetHeader(this.strm,this.header)}function d(e,t){var n=new h(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}h.prototype.push=function(e,t){var n,a,c,u,h,d,f=this.strm,p=this.options.chunkSize,m=this.options.dictionary,v=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof e?f.input=o.binstring2buf(e):"[object ArrayBuffer]"===l.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(p),f.next_out=0,f.avail_out=p),(n=r.inflate(f,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&m&&(d="string"==typeof m?o.string2buf(m):"[object ArrayBuffer]"===l.call(m)?new Uint8Array(m):m,n=r.inflateSetDictionary(this.strm,d)),n===s.Z_BUF_ERROR&&!0===v&&(n=s.Z_OK,v=!1),n!==s.Z_STREAM_END&&n!==s.Z_OK)return this.onEnd(n),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&n!==s.Z_STREAM_END&&(0!==f.avail_in||a!==s.Z_FINISH&&a!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(c=o.utf8border(f.output,f.next_out),u=f.next_out-c,h=o.buf2string(f.output,c),f.next_out=u,f.avail_out=p-u,u&&i.arraySet(f.output,f.output,c,u,0),this.onData(h)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(v=!0)}while((0<f.avail_in||0===f.avail_out)&&n!==s.Z_STREAM_END);return n===s.Z_STREAM_END&&(a=s.Z_FINISH),a===s.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===s.Z_OK):a!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),!(f.avail_out=0))},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=h,n.inflate=d,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},n.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){var t,n,r,i,o,s;for(t=r=0,n=e.length;t<n;t++)r+=e[t].length;for(s=new Uint8Array(r),t=i=0,n=e.length;t<n;t++)o=e[t],s.set(o,i),i+=o.length;return s}},o={arraySet:function(e,t,n,r,i){for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(r)},{}],42:[function(e,t,n){"use strict";var r=e("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var s=new r.Buf8(256),a=0;a<256;a++)s[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function c(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",s=0;s<t;s++)n+=String.fromCharCode(e[s]);return n}s[254]=s[254]=1,n.string2buf=function(e){var t,n,i,o,s,a=e.length,c=0;for(o=0;o<a;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),c+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(c),o=s=0;s<c;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?t[s++]=n:(n<2048?t[s++]=192|n>>>6:(n<65536?t[s++]=224|n>>>12:(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63),t[s++]=128|n>>>6&63),t[s++]=128|63&n);return t},n.buf2binstring=function(e){return c(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,i,o,a=t||e.length,u=new Array(2*a);for(n=r=0;n<a;)if((i=e[n++])<128)u[r++]=i;else if(4<(o=s[i]))u[r++]=65533,n+=o-1;else{for(i&=2===o?31:3===o?15:7;1<o&&n<a;)i=i<<6|63&e[n++],o--;1<o?u[r++]=65533:i<65536?u[r++]=i:(i-=65536,u[r++]=55296|i>>10&1023,u[r++]=56320|1023&i)}return c(u,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var i=65535&e|0,o=e>>>16&65535|0,s=0;0!==n;){for(n-=s=2e3<n?2e3:n;o=o+(i=i+t[r++]|0)|0,--s;);i%=65521,o%=65521}return i|o<<16|0}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,i){var o=r,s=i+n;e^=-1;for(var a=i;a<s;a++)e=e>>>8^o[255&(e^t[a])];return-1^e}},{}],46:[function(e,t,n){"use strict";var r,i=e("../utils/common"),o=e("./trees"),s=e("./adler32"),a=e("./crc32"),c=e("./messages"),u=0,l=4,h=0,d=-2,f=2,p=8,m=286,v=30,g=19,y=2*m+1,_=15,b=3,w=258,k=w+b+1,C=42,S=113,x=1,E=2,T=3,R=4;function P(e,t){return e.msg=c[t],t}function A(e){return(e<<1)-(4<e?9:0)}function O(e){for(var t=e.length;0<=--t;)e[t]=0}function I(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function D(e,t){o._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,I(e.strm)}function j(e,t){e.pending_buf[e.pending++]=t}function B(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function z(e,t){var n,r,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,c=e.strstart>e.w_size-k?e.strstart-(e.w_size-k):0,u=e.window,l=e.w_mask,h=e.prev,d=e.strstart+w,f=u[o+s-1],p=u[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(u[(n=t)+s]===p&&u[n+s-1]===f&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do{}while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<d);if(r=w-(d-o),o=d-w,s<r){if(e.match_start=t,a<=(s=r))break;f=u[o+s-1],p=u[o+s]}}}while((t=h[t&l])>c&&0!=--i);return s<=e.lookahead?s:e.lookahead}function M(e){var t,n,r,o,c,u,l,h,d,f,p=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-k)){for(i.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=n=e.hash_size;r=e.head[--t],e.head[t]=p<=r?r-p:0,--n;);for(t=n=p;r=e.prev[--t],e.prev[t]=p<=r?r-p:0,--n;);o+=p}if(0===e.strm.avail_in)break;if(u=e.strm,l=e.window,h=e.strstart+e.lookahead,f=void 0,(d=o)<(f=u.avail_in)&&(f=d),n=0===f?0:(u.avail_in-=f,i.arraySet(l,u.input,u.next_in,f,h),1===u.state.wrap?u.adler=s(u.adler,l,f,h):2===u.state.wrap&&(u.adler=a(u.adler,l,f,h)),u.next_in+=f,u.total_in+=f,f),e.lookahead+=n,e.lookahead+e.insert>=b)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+b-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<b)););}while(e.lookahead<k&&0!==e.strm.avail_in)}function L(e,t){for(var n,r;;){if(e.lookahead<k){if(M(e),e.lookahead<k&&t===u)return x;if(0===e.lookahead)break}if(n=0,e.lookahead>=b&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+b-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-k&&(e.match_length=z(e,n)),e.match_length>=b)if(r=o._tr_tally(e,e.strstart-e.match_start,e.match_length-b),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=b){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+b-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(D(e,!1),0===e.strm.avail_out))return x}return e.insert=e.strstart<b-1?e.strstart:b-1,t===l?(D(e,!0),0===e.strm.avail_out?T:R):e.last_lit&&(D(e,!1),0===e.strm.avail_out)?x:E}function F(e,t){for(var n,r,i;;){if(e.lookahead<k){if(M(e),e.lookahead<k&&t===u)return x;if(0===e.lookahead)break}if(n=0,e.lookahead>=b&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+b-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=b-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-k&&(e.match_length=z(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===b&&4096<e.strstart-e.match_start)&&(e.match_length=b-1)),e.prev_length>=b&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-b,r=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-b),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+b-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=b-1,e.strstart++,r&&(D(e,!1),0===e.strm.avail_out))return x}else if(e.match_available){if((r=o._tr_tally(e,0,e.window[e.strstart-1]))&&D(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return x}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<b-1?e.strstart:b-1,t===l?(D(e,!0),0===e.strm.avail_out?T:R):e.last_lit&&(D(e,!1),0===e.strm.avail_out)?x:E}function N(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function U(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=p,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*y),this.dyn_dtree=new i.Buf16(2*(2*v+1)),this.bl_tree=new i.Buf16(2*(2*g+1)),O(this.dyn_ltree),O(this.dyn_dtree),O(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(_+1),this.heap=new i.Buf16(2*m+1),O(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*m+1),O(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function W(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=f,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?C:S,e.adler=2===t.wrap?0:1,t.last_flush=u,o._tr_init(t),h):P(e,d)}function H(e){var t=W(e);return t===h&&function(e){e.window_size=2*e.w_size,O(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=b-1,e.match_available=0,e.ins_h=0}(e.state),t}function $(e,t,n,r,o,s){if(!e)return d;var a=1;if(-1===t&&(t=6),r<0?(a=0,r=-r):15<r&&(a=2,r-=16),o<1||9<o||n!==p||r<8||15<r||t<0||9<t||s<0||4<s)return P(e,d);8===r&&(r=9);var c=new U;return(e.state=c).strm=e,c.wrap=a,c.gzhead=null,c.w_bits=r,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=o+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+b-1)/b),c.window=new i.Buf8(2*c.w_size),c.head=new i.Buf16(c.hash_size),c.prev=new i.Buf16(c.w_size),c.lit_bufsize=1<<o+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new i.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=s,c.method=n,H(e)}r=[new N(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(M(e),0===e.lookahead&&t===u)return x;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,D(e,!1),0===e.strm.avail_out))return x;if(e.strstart-e.block_start>=e.w_size-k&&(D(e,!1),0===e.strm.avail_out))return x}return e.insert=0,t===l?(D(e,!0),0===e.strm.avail_out?T:R):(e.strstart>e.block_start&&(D(e,!1),e.strm.avail_out),x)})),new N(4,4,8,4,L),new N(4,5,16,8,L),new N(4,6,32,32,L),new N(4,4,16,16,F),new N(8,16,32,32,F),new N(8,16,128,128,F),new N(8,32,128,256,F),new N(32,128,258,1024,F),new N(32,258,258,4096,F)],n.deflateInit=function(e,t){return $(e,t,p,15,8,0)},n.deflateInit2=$,n.deflateReset=H,n.deflateResetKeep=W,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?d:(e.state.gzhead=t,h):d},n.deflate=function(e,t){var n,i,s,c;if(!e||!e.state||5<t||t<0)return e?P(e,d):d;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&t!==l)return P(e,0===e.avail_out?-5:d);if(i.strm=e,n=i.last_flush,i.last_flush=t,i.status===C)if(2===i.wrap)e.adler=0,j(i,31),j(i,139),j(i,8),i.gzhead?(j(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),j(i,255&i.gzhead.time),j(i,i.gzhead.time>>8&255),j(i,i.gzhead.time>>16&255),j(i,i.gzhead.time>>24&255),j(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),j(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(j(i,255&i.gzhead.extra.length),j(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=a(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(j(i,0),j(i,0),j(i,0),j(i,0),j(i,0),j(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),j(i,3),i.status=S);else{var f=p+(i.w_bits-8<<4)<<8;f|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(f|=32),f+=31-f%31,i.status=S,B(i,f),0!==i.strstart&&(B(i,e.adler>>>16),B(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(s=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),I(e),s=i.pending,i.pending!==i.pending_buf_size));)j(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),I(e),s=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,j(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),0===c&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),I(e),s=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,j(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),0===c&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&I(e),i.pending+2<=i.pending_buf_size&&(j(i,255&e.adler),j(i,e.adler>>8&255),e.adler=0,i.status=S)):i.status=S),0!==i.pending){if(I(e),0===e.avail_out)return i.last_flush=-1,h}else if(0===e.avail_in&&A(t)<=A(n)&&t!==l)return P(e,-5);if(666===i.status&&0!==e.avail_in)return P(e,-5);if(0!==e.avail_in||0!==i.lookahead||t!==u&&666!==i.status){var m=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(M(e),0===e.lookahead)){if(t===u)return x;break}if(e.match_length=0,n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(D(e,!1),0===e.strm.avail_out))return x}return e.insert=0,t===l?(D(e,!0),0===e.strm.avail_out?T:R):e.last_lit&&(D(e,!1),0===e.strm.avail_out)?x:E}(i,t):3===i.strategy?function(e,t){for(var n,r,i,s,a=e.window;;){if(e.lookahead<=w){if(M(e),e.lookahead<=w&&t===u)return x;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=b&&0<e.strstart&&(r=a[i=e.strstart-1])===a[++i]&&r===a[++i]&&r===a[++i]){s=e.strstart+w;do{}while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<s);e.match_length=w-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=b?(n=o._tr_tally(e,1,e.match_length-b),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(D(e,!1),0===e.strm.avail_out))return x}return e.insert=0,t===l?(D(e,!0),0===e.strm.avail_out?T:R):e.last_lit&&(D(e,!1),0===e.strm.avail_out)?x:E}(i,t):r[i.level].func(i,t);if(m!==T&&m!==R||(i.status=666),m===x||m===T)return 0===e.avail_out&&(i.last_flush=-1),h;if(m===E&&(1===t?o._tr_align(i):5!==t&&(o._tr_stored_block(i,0,0,!1),3===t&&(O(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),I(e),0===e.avail_out))return i.last_flush=-1,h}return t!==l?h:i.wrap<=0?1:(2===i.wrap?(j(i,255&e.adler),j(i,e.adler>>8&255),j(i,e.adler>>16&255),j(i,e.adler>>24&255),j(i,255&e.total_in),j(i,e.total_in>>8&255),j(i,e.total_in>>16&255),j(i,e.total_in>>24&255)):(B(i,e.adler>>>16),B(i,65535&e.adler)),I(e),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?h:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==C&&69!==t&&73!==t&&91!==t&&103!==t&&t!==S&&666!==t?P(e,d):(e.state=null,t===S?P(e,-3):h):d},n.deflateSetDictionary=function(e,t){var n,r,o,a,c,u,l,f,p=t.length;if(!e||!e.state)return d;if(2===(a=(n=e.state).wrap)||1===a&&n.status!==C||n.lookahead)return d;for(1===a&&(e.adler=s(e.adler,t,p,0)),n.wrap=0,p>=n.w_size&&(0===a&&(O(n.head),n.strstart=0,n.block_start=0,n.insert=0),f=new i.Buf8(n.w_size),i.arraySet(f,t,p-n.w_size,n.w_size,0),t=f,p=n.w_size),c=e.avail_in,u=e.next_in,l=e.input,e.avail_in=p,e.next_in=0,e.input=t,M(n);n.lookahead>=b;){for(r=n.strstart,o=n.lookahead-(b-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+b-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--o;);n.strstart=r,n.lookahead=b-1,M(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=b-1,n.match_available=0,e.next_in=u,e.input=l,e.avail_in=c,n.wrap=a,h},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,i,o,s,a,c,u,l,h,d,f,p,m,v,g,y,_,b,w,k,C,S,x,E;n=e.state,r=e.next_in,x=e.input,i=r+(e.avail_in-5),o=e.next_out,E=e.output,s=o-(t-e.avail_out),a=o+(e.avail_out-257),c=n.dmax,u=n.wsize,l=n.whave,h=n.wnext,d=n.window,f=n.hold,p=n.bits,m=n.lencode,v=n.distcode,g=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{p<15&&(f+=x[r++]<<p,p+=8,f+=x[r++]<<p,p+=8),_=m[f&g];t:for(;;){if(f>>>=b=_>>>24,p-=b,0==(b=_>>>16&255))E[o++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=m[(65535&_)+(f&(1<<b)-1)];continue t}if(32&b){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}w=65535&_,(b&=15)&&(p<b&&(f+=x[r++]<<p,p+=8),w+=f&(1<<b)-1,f>>>=b,p-=b),p<15&&(f+=x[r++]<<p,p+=8,f+=x[r++]<<p,p+=8),_=v[f&y];n:for(;;){if(f>>>=b=_>>>24,p-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=v[(65535&_)+(f&(1<<b)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(k=65535&_,p<(b&=15)&&(f+=x[r++]<<p,(p+=8)<b&&(f+=x[r++]<<p,p+=8)),c<(k+=f&(1<<b)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=b,p-=b,(b=o-s)<k){if(l<(b=k-b)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(S=d,(C=0)===h){if(C+=u-b,b<w){for(w-=b;E[o++]=d[C++],--b;);C=o-k,S=E}}else if(h<b){if(C+=u+h-b,(b-=h)<w){for(w-=b;E[o++]=d[C++],--b;);if(C=0,h<w){for(w-=b=h;E[o++]=d[C++],--b;);C=o-k,S=E}}}else if(C+=h-b,b<w){for(w-=b;E[o++]=d[C++],--b;);C=o-k,S=E}for(;2<w;)E[o++]=S[C++],E[o++]=S[C++],E[o++]=S[C++],w-=3;w&&(E[o++]=S[C++],1<w&&(E[o++]=S[C++]))}else{for(C=o-k;E[o++]=E[C++],E[o++]=E[C++],E[o++]=E[C++],2<(w-=3););w&&(E[o++]=E[C++],1<w&&(E[o++]=E[C++]))}break}}break}}while(r<i&&o<a);r-=w=p>>3,f&=(1<<(p-=w<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=o<a?a-o+257:257-(o-a),n.hold=f,n.bits=p}},{}],49:[function(e,t,n){"use strict";var r=e("../utils/common"),i=e("./adler32"),o=e("./crc32"),s=e("./inffast"),a=e("./inftrees"),c=1,u=2,l=0,h=-2,d=1,f=852,p=592;function m(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function g(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=d,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(f),t.distcode=t.distdyn=new r.Buf32(p),t.sane=1,t.back=-1,l):h}function y(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,g(e)):h}function _(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?h:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,y(e))):h}function b(e,t){var n,r;return e?(r=new v,(e.state=r).window=null,(n=_(e,t))!==l&&(e.state=null),n):h}var w,k,C=!0;function S(e){if(C){var t;for(w=new r.Buf32(512),k=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(c,e.lens,0,288,w,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(u,e.lens,0,32,k,0,e.work,{bits:5}),C=!1}e.lencode=w,e.lenbits=9,e.distcode=k,e.distbits=5}function x(e,t,n,i){var o,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new r.Buf8(s.wsize)),i>=s.wsize?(r.arraySet(s.window,t,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(i<(o=s.wsize-s.wnext)&&(o=i),r.arraySet(s.window,t,n-i,o,s.wnext),(i-=o)?(r.arraySet(s.window,t,n-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0}n.inflateReset=y,n.inflateReset2=_,n.inflateResetKeep=g,n.inflateInit=function(e){return b(e,15)},n.inflateInit2=b,n.inflate=function(e,t){var n,f,p,v,g,y,_,b,w,k,C,E,T,R,P,A,O,I,D,j,B,z,M,L,F=0,N=new r.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return h;12===(n=e.state).mode&&(n.mode=13),g=e.next_out,p=e.output,_=e.avail_out,v=e.next_in,f=e.input,y=e.avail_in,b=n.hold,w=n.bits,k=y,C=_,z=l;e:for(;;)switch(n.mode){case d:if(0===n.wrap){n.mode=13;break}for(;w<16;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}if(2&n.wrap&&35615===b){N[n.check=0]=255&b,N[1]=b>>>8&255,n.check=o(n.check,N,2,0),w=b=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&b)<<8)+(b>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&b)){e.msg="unknown compression method",n.mode=30;break}if(w-=4,B=8+(15&(b>>>=4)),0===n.wbits)n.wbits=B;else if(B>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<B,e.adler=n.check=1,n.mode=512&b?10:12,w=b=0;break;case 2:for(;w<16;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}if(n.flags=b,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=b>>8&1),512&n.flags&&(N[0]=255&b,N[1]=b>>>8&255,n.check=o(n.check,N,2,0)),w=b=0,n.mode=3;case 3:for(;w<32;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}n.head&&(n.head.time=b),512&n.flags&&(N[0]=255&b,N[1]=b>>>8&255,N[2]=b>>>16&255,N[3]=b>>>24&255,n.check=o(n.check,N,4,0)),w=b=0,n.mode=4;case 4:for(;w<16;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}n.head&&(n.head.xflags=255&b,n.head.os=b>>8),512&n.flags&&(N[0]=255&b,N[1]=b>>>8&255,n.check=o(n.check,N,2,0)),w=b=0,n.mode=5;case 5:if(1024&n.flags){for(;w<16;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}n.length=b,n.head&&(n.head.extra_len=b),512&n.flags&&(N[0]=255&b,N[1]=b>>>8&255,n.check=o(n.check,N,2,0)),w=b=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(y<(E=n.length)&&(E=y),E&&(n.head&&(B=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,f,v,E,B)),512&n.flags&&(n.check=o(n.check,f,E,v)),y-=E,v+=E,n.length-=E),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===y)break e;for(E=0;B=f[v+E++],n.head&&B&&n.length<65536&&(n.head.name+=String.fromCharCode(B)),B&&E<y;);if(512&n.flags&&(n.check=o(n.check,f,E,v)),y-=E,v+=E,B)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===y)break e;for(E=0;B=f[v+E++],n.head&&B&&n.length<65536&&(n.head.comment+=String.fromCharCode(B)),B&&E<y;);if(512&n.flags&&(n.check=o(n.check,f,E,v)),y-=E,v+=E,B)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;w<16;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}if(b!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}w=b=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;w<32;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}e.adler=n.check=m(b),w=b=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=g,e.avail_out=_,e.next_in=v,e.avail_in=y,n.hold=b,n.bits=w,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){b>>>=7&w,w-=7&w,n.mode=27;break}for(;w<3;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}switch(n.last=1&b,w-=1,3&(b>>>=1)){case 0:n.mode=14;break;case 1:if(S(n),n.mode=20,6!==t)break;b>>>=2,w-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}b>>>=2,w-=2;break;case 14:for(b>>>=7&w,w-=7&w;w<32;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}if((65535&b)!=(b>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&b,w=b=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(E=n.length){if(y<E&&(E=y),_<E&&(E=_),0===E)break e;r.arraySet(p,f,v,E,g),y-=E,v+=E,_-=E,g+=E,n.length-=E;break}n.mode=12;break;case 17:for(;w<14;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}if(n.nlen=257+(31&b),b>>>=5,w-=5,n.ndist=1+(31&b),b>>>=5,w-=5,n.ncode=4+(15&b),b>>>=4,w-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;w<3;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}n.lens[U[n.have++]]=7&b,b>>>=3,w-=3}for(;n.have<19;)n.lens[U[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,M={bits:n.lenbits},z=a(0,n.lens,0,19,n.lencode,0,n.work,M),n.lenbits=M.bits,z){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;A=(F=n.lencode[b&(1<<n.lenbits)-1])>>>16&255,O=65535&F,!((P=F>>>24)<=w);){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}if(O<16)b>>>=P,w-=P,n.lens[n.have++]=O;else{if(16===O){for(L=P+2;w<L;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}if(b>>>=P,w-=P,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}B=n.lens[n.have-1],E=3+(3&b),b>>>=2,w-=2}else if(17===O){for(L=P+3;w<L;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}w-=P,B=0,E=3+(7&(b>>>=P)),b>>>=3,w-=3}else{for(L=P+7;w<L;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}w-=P,B=0,E=11+(127&(b>>>=P)),b>>>=7,w-=7}if(n.have+E>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;E--;)n.lens[n.have++]=B}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,M={bits:n.lenbits},z=a(c,n.lens,0,n.nlen,n.lencode,0,n.work,M),n.lenbits=M.bits,z){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,M={bits:n.distbits},z=a(u,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,M),n.distbits=M.bits,z){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=y&&258<=_){e.next_out=g,e.avail_out=_,e.next_in=v,e.avail_in=y,n.hold=b,n.bits=w,s(e,C),g=e.next_out,p=e.output,_=e.avail_out,v=e.next_in,f=e.input,y=e.avail_in,b=n.hold,w=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;A=(F=n.lencode[b&(1<<n.lenbits)-1])>>>16&255,O=65535&F,!((P=F>>>24)<=w);){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}if(A&&0==(240&A)){for(I=P,D=A,j=O;A=(F=n.lencode[j+((b&(1<<I+D)-1)>>I)])>>>16&255,O=65535&F,!(I+(P=F>>>24)<=w);){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}b>>>=I,w-=I,n.back+=I}if(b>>>=P,w-=P,n.back+=P,n.length=O,0===A){n.mode=26;break}if(32&A){n.back=-1,n.mode=12;break}if(64&A){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&A,n.mode=22;case 22:if(n.extra){for(L=n.extra;w<L;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}n.length+=b&(1<<n.extra)-1,b>>>=n.extra,w-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;A=(F=n.distcode[b&(1<<n.distbits)-1])>>>16&255,O=65535&F,!((P=F>>>24)<=w);){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}if(0==(240&A)){for(I=P,D=A,j=O;A=(F=n.distcode[j+((b&(1<<I+D)-1)>>I)])>>>16&255,O=65535&F,!(I+(P=F>>>24)<=w);){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}b>>>=I,w-=I,n.back+=I}if(b>>>=P,w-=P,n.back+=P,64&A){e.msg="invalid distance code",n.mode=30;break}n.offset=O,n.extra=15&A,n.mode=24;case 24:if(n.extra){for(L=n.extra;w<L;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}n.offset+=b&(1<<n.extra)-1,b>>>=n.extra,w-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===_)break e;if(E=C-_,n.offset>E){if((E=n.offset-E)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}T=E>n.wnext?(E-=n.wnext,n.wsize-E):n.wnext-E,E>n.length&&(E=n.length),R=n.window}else R=p,T=g-n.offset,E=n.length;for(_<E&&(E=_),_-=E,n.length-=E;p[g++]=R[T++],--E;);0===n.length&&(n.mode=21);break;case 26:if(0===_)break e;p[g++]=n.length,_--,n.mode=21;break;case 27:if(n.wrap){for(;w<32;){if(0===y)break e;y--,b|=f[v++]<<w,w+=8}if(C-=_,e.total_out+=C,n.total+=C,C&&(e.adler=n.check=n.flags?o(n.check,p,C,g-C):i(n.check,p,C,g-C)),C=_,(n.flags?b:m(b))!==n.check){e.msg="incorrect data check",n.mode=30;break}w=b=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;w<32;){if(0===y)break e;y--,b+=f[v++]<<w,w+=8}if(b!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}w=b=0}n.mode=29;case 29:z=1;break e;case 30:z=-3;break e;case 31:return-4;default:return h}return e.next_out=g,e.avail_out=_,e.next_in=v,e.avail_in=y,n.hold=b,n.bits=w,(n.wsize||C!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&x(e,e.output,e.next_out,C-e.avail_out)?(n.mode=31,-4):(k-=e.avail_in,C-=e.avail_out,e.total_in+=k,e.total_out+=C,n.total+=C,n.wrap&&C&&(e.adler=n.check=n.flags?o(n.check,p,C,e.next_out-C):i(n.check,p,C,e.next_out-C)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==k&&0===C||4===t)&&z===l&&(z=-5),z)},n.inflateEnd=function(e){if(!e||!e.state)return h;var t=e.state;return t.window&&(t.window=null),e.state=null,l},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?h:((n.head=t).done=!1,l):h},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?h:11===n.mode&&i(1,t,r,0)!==n.check?-3:x(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,l):h},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var r=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,c,u,l,h,d){var f,p,m,v,g,y,_,b,w,k=d.bits,C=0,S=0,x=0,E=0,T=0,R=0,P=0,A=0,O=0,I=0,D=null,j=0,B=new r.Buf16(16),z=new r.Buf16(16),M=null,L=0;for(C=0;C<=15;C++)B[C]=0;for(S=0;S<c;S++)B[t[n+S]]++;for(T=k,E=15;1<=E&&0===B[E];E--);if(E<T&&(T=E),0===E)return u[l++]=20971520,u[l++]=20971520,d.bits=1,0;for(x=1;x<E&&0===B[x];x++);for(T<x&&(T=x),C=A=1;C<=15;C++)if(A<<=1,(A-=B[C])<0)return-1;if(0<A&&(0===e||1!==E))return-1;for(z[1]=0,C=1;C<15;C++)z[C+1]=z[C]+B[C];for(S=0;S<c;S++)0!==t[n+S]&&(h[z[t[n+S]]++]=S);if(y=0===e?(D=M=h,19):1===e?(D=i,j-=257,M=o,L-=257,256):(D=s,M=a,-1),C=x,g=l,P=S=I=0,m=-1,v=(O=1<<(R=T))-1,1===e&&852<O||2===e&&592<O)return 1;for(;;){for(_=C-P,w=h[S]<y?(b=0,h[S]):h[S]>y?(b=M[L+h[S]],D[j+h[S]]):(b=96,0),f=1<<C-P,x=p=1<<R;u[g+(I>>P)+(p-=f)]=_<<24|b<<16|w|0,0!==p;);for(f=1<<C-1;I&f;)f>>=1;if(0!==f?(I&=f-1,I+=f):I=0,S++,0==--B[C]){if(C===E)break;C=t[n+h[S]]}if(T<C&&(I&v)!==m){for(0===P&&(P=T),g+=x,A=1<<(R=C-P);R+P<E&&!((A-=B[R+P])<=0);)R++,A<<=1;if(O+=1<<R,1===e&&852<O||2===e&&592<O)return 1;u[m=I&v]=T<<24|R<<16|g-l|0}}return 0!==I&&(u[g+I]=C-P<<24|64<<16|0),d.bits=T,0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var r=e("../utils/common");function i(e){for(var t=e.length;0<=--t;)e[t]=0}var o=256,s=o+1+29,a=30,c=19,u=2*s+1,l=15,h=16,d=256,f=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],p=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],v=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],g=new Array(2*(s+2));i(g);var y=new Array(60);i(y);var _=new Array(512);i(_);var b=new Array(256);i(b);var w=new Array(29);i(w);var k,C,S,x=new Array(a);function E(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function T(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function R(e){return e<256?_[e]:_[256+(e>>>7)]}function P(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function A(e,t,n){e.bi_valid>h-n?(e.bi_buf|=t<<e.bi_valid&65535,P(e,e.bi_buf),e.bi_buf=t>>h-e.bi_valid,e.bi_valid+=n-h):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function O(e,t,n){A(e,n[2*t],n[2*t+1])}function I(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function D(e,t,n){var r,i,o=new Array(l+1),s=0;for(r=1;r<=l;r++)o[r]=s=s+n[r-1]<<1;for(i=0;i<=t;i++){var a=e[2*i+1];0!==a&&(e[2*i]=I(o[a]++,a))}}function j(e){var t;for(t=0;t<s;t++)e.dyn_ltree[2*t]=0;for(t=0;t<a;t++)e.dyn_dtree[2*t]=0;for(t=0;t<c;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*d]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function B(e){8<e.bi_valid?P(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function z(e,t,n,r){var i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]}function M(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&z(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!z(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function L(e,t,n){var r,i,s,a,c=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],i=e.pending_buf[e.l_buf+c],c++,0===r?O(e,i,t):(O(e,(s=b[i])+o+1,t),0!==(a=f[s])&&A(e,i-=w[s],a),O(e,s=R(--r),n),0!==(a=p[s])&&A(e,r-=x[s],a)),c<e.last_lit;);O(e,d,t)}function F(e,t){var n,r,i,o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,c=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=u,n=0;n<c;n++)0!==o[2*n]?(e.heap[++e.heap_len]=h=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=h<2?++h:0)]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=s[2*i+1]);for(t.max_code=h,n=e.heap_len>>1;1<=n;n--)M(e,o,n);for(i=c;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],M(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*i]=o[2*n]+o[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=i,e.heap[1]=i++,M(e,o,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,o,s,a,c=t.dyn_tree,h=t.max_code,d=t.stat_desc.static_tree,f=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,v=t.stat_desc.max_length,g=0;for(o=0;o<=l;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<u;n++)v<(o=c[2*c[2*(r=e.heap[n])+1]+1]+1)&&(o=v,g++),c[2*r+1]=o,h<r||(e.bl_count[o]++,s=0,m<=r&&(s=p[r-m]),a=c[2*r],e.opt_len+=a*(o+s),f&&(e.static_len+=a*(d[2*r+1]+s)));if(0!==g){do{for(o=v-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[v]--,g-=2}while(0<g);for(o=v;0!==o;o--)for(r=e.bl_count[o];0!==r;)h<(i=e.heap[--n])||(c[2*i+1]!==o&&(e.opt_len+=(o-c[2*i+1])*c[2*i],c[2*i+1]=o),r--)}}(e,t),D(o,h,e.bl_count)}function N(e,t,n){var r,i,o=-1,s=t[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=t[2*(r+1)+1],++a<c&&i===s||(a<u?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=i,u=(a=0)===s?(c=138,3):i===s?(c=6,3):(c=7,4))}function U(e,t,n){var r,i,o=-1,s=t[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),r=0;r<=n;r++)if(i=s,s=t[2*(r+1)+1],!(++a<c&&i===s)){if(a<u)for(;O(e,i,e.bl_tree),0!=--a;);else 0!==i?(i!==o&&(O(e,i,e.bl_tree),a--),O(e,16,e.bl_tree),A(e,a-3,2)):a<=10?(O(e,17,e.bl_tree),A(e,a-3,3)):(O(e,18,e.bl_tree),A(e,a-11,7));o=i,u=(a=0)===s?(c=138,3):i===s?(c=6,3):(c=7,4)}}i(x);var W=!1;function H(e,t,n,i){A(e,0+(i?1:0),3),function(e,t,n,i){B(e),P(e,n),P(e,~n),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}n._tr_init=function(e){W||(function(){var e,t,n,r,i,u=new Array(l+1);for(r=n=0;r<28;r++)for(w[r]=n,e=0;e<1<<f[r];e++)b[n++]=r;for(b[n-1]=r,r=i=0;r<16;r++)for(x[r]=i,e=0;e<1<<p[r];e++)_[i++]=r;for(i>>=7;r<a;r++)for(x[r]=i<<7,e=0;e<1<<p[r]-7;e++)_[256+i++]=r;for(t=0;t<=l;t++)u[t]=0;for(e=0;e<=143;)g[2*e+1]=8,e++,u[8]++;for(;e<=255;)g[2*e+1]=9,e++,u[9]++;for(;e<=279;)g[2*e+1]=7,e++,u[7]++;for(;e<=287;)g[2*e+1]=8,e++,u[8]++;for(D(g,s+1,u),e=0;e<a;e++)y[2*e+1]=5,y[2*e]=I(e,5);k=new E(g,f,o+1,s,l),C=new E(y,p,0,a,l),S=new E(new Array(0),m,0,c,7)}(),W=!0),e.l_desc=new T(e.dyn_ltree,k),e.d_desc=new T(e.dyn_dtree,C),e.bl_desc=new T(e.bl_tree,S),e.bi_buf=0,e.bi_valid=0,j(e)},n._tr_stored_block=H,n._tr_flush_block=function(e,t,n,r){var i,s,a=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<o;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),F(e,e.l_desc),F(e,e.d_desc),a=function(e){var t;for(N(e,e.dyn_ltree,e.l_desc.max_code),N(e,e.dyn_dtree,e.d_desc.max_code),F(e,e.bl_desc),t=c-1;3<=t&&0===e.bl_tree[2*v[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=i&&(i=s)):i=s=n+5,n+4<=i&&-1!==t?H(e,t,n,r):4===e.strategy||s===i?(A(e,2+(r?1:0),3),L(e,g,y)):(A(e,4+(r?1:0),3),function(e,t,n,r){var i;for(A(e,t-257,5),A(e,n-1,5),A(e,r-4,4),i=0;i<r;i++)A(e,e.bl_tree[2*v[i]+1],3);U(e,e.dyn_ltree,t-1),U(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),L(e,e.dyn_ltree,e.dyn_dtree)),j(e),r&&B(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(b[n]+o+1)]++,e.dyn_dtree[2*R(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){A(e,2,3),O(e,d,g),function(e){16===e.bi_valid?(P(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(e,t){"use strict";if(!e.setImmediate){var n,r,i,o,s=1,a={},c=!1,u=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,n="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick((function(){d(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(o="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",f,!1):e.attachEvent("onmessage",f),function(t){e.postMessage(o+t,"*")}):e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){d(e.data)},function(e){i.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(r=u.documentElement,function(e){var t=u.createElement("script");t.onreadystatechange=function(){d(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):function(e){setTimeout(d,0,e)},l.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var i={callback:e,args:t};return a[s]=i,n(s),s++},l.clearImmediate=h}function h(e){delete a[e]}function d(e){if(c)setTimeout(d,0,e);else{var n=a[e];if(n){c=!0;try{!function(e){var n=e.callback,r=e.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(t,r)}}(n)}finally{h(e),c=!1}}}}function f(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&d(+t.data.slice(o.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},6486:function(e,t,n){var r;e=n.nmd(e),function(){var i,o="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",c=32,u=128,l=1/0,h=9007199254740991,d=NaN,f=4294967295,p=[["ary",u],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",c],["partialRight",64],["rearg",256]],m="[object Arguments]",v="[object Array]",g="[object Boolean]",y="[object Date]",_="[object Error]",b="[object Function]",w="[object GeneratorFunction]",k="[object Map]",C="[object Number]",S="[object Object]",x="[object Promise]",E="[object RegExp]",T="[object Set]",R="[object String]",P="[object Symbol]",A="[object WeakMap]",O="[object ArrayBuffer]",I="[object DataView]",D="[object Float32Array]",j="[object Float64Array]",B="[object Int8Array]",z="[object Int16Array]",M="[object Int32Array]",L="[object Uint8Array]",F="[object Uint8ClampedArray]",N="[object Uint16Array]",U="[object Uint32Array]",W=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,$=/(__e\(.*?\)|\b__t\)) \+\n'';/g,G=/&(?:amp|lt|gt|quot|#39);/g,q=/[&<>"']/g,Z=RegExp(G.source),V=RegExp(q.source),K=/<%-([\s\S]+?)%>/g,J=/<%([\s\S]+?)%>/g,Y=/<%=([\s\S]+?)%>/g,X=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,ee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,te=/[\\^$.*+?()[\]{}|]/g,ne=RegExp(te.source),re=/^\s+/,ie=/\s/,oe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,se=/\{\n\/\* \[wrapped with (.+)\] \*/,ae=/,? & /,ce=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ue=/[()=,{}\[\]\/\s]/,le=/\\(\\)?/g,he=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,de=/\w*$/,fe=/^[-+]0x[0-9a-f]+$/i,pe=/^0b[01]+$/i,me=/^\[object .+?Constructor\]$/,ve=/^0o[0-7]+$/i,ge=/^(?:0|[1-9]\d*)$/,ye=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_e=/($^)/,be=/['\n\r\u2028\u2029\\]/g,we="\\ud800-\\udfff",ke="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ce="\\u2700-\\u27bf",Se="a-z\\xdf-\\xf6\\xf8-\\xff",xe="A-Z\\xc0-\\xd6\\xd8-\\xde",Ee="\\ufe0e\\ufe0f",Te="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Re="["+we+"]",Pe="["+Te+"]",Ae="["+ke+"]",Oe="\\d+",Ie="["+Ce+"]",De="["+Se+"]",je="[^"+we+Te+Oe+Ce+Se+xe+"]",Be="\\ud83c[\\udffb-\\udfff]",ze="[^"+we+"]",Me="(?:\\ud83c[\\udde6-\\uddff]){2}",Le="[\\ud800-\\udbff][\\udc00-\\udfff]",Fe="["+xe+"]",Ne="\\u200d",Ue="(?:"+De+"|"+je+")",We="(?:"+Fe+"|"+je+")",He="(?:['](?:d|ll|m|re|s|t|ve))?",$e="(?:['](?:D|LL|M|RE|S|T|VE))?",Ge="(?:"+Ae+"|"+Be+")?",qe="["+Ee+"]?",Ze=qe+Ge+"(?:"+Ne+"(?:"+[ze,Me,Le].join("|")+")"+qe+Ge+")*",Ve="(?:"+[Ie,Me,Le].join("|")+")"+Ze,Ke="(?:"+[ze+Ae+"?",Ae,Me,Le,Re].join("|")+")",Je=RegExp("[']","g"),Ye=RegExp(Ae,"g"),Xe=RegExp(Be+"(?="+Be+")|"+Ke+Ze,"g"),Qe=RegExp([Fe+"?"+De+"+"+He+"(?="+[Pe,Fe,"$"].join("|")+")",We+"+"+$e+"(?="+[Pe,Fe+Ue,"$"].join("|")+")",Fe+"?"+Ue+"+"+He,Fe+"+"+$e,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Oe,Ve].join("|"),"g"),et=RegExp("["+Ne+we+ke+Ee+"]"),tt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,nt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],rt=-1,it={};it[D]=it[j]=it[B]=it[z]=it[M]=it[L]=it[F]=it[N]=it[U]=!0,it[m]=it[v]=it[O]=it[g]=it[I]=it[y]=it[_]=it[b]=it[k]=it[C]=it[S]=it[E]=it[T]=it[R]=it[A]=!1;var ot={};ot[m]=ot[v]=ot[O]=ot[I]=ot[g]=ot[y]=ot[D]=ot[j]=ot[B]=ot[z]=ot[M]=ot[k]=ot[C]=ot[S]=ot[E]=ot[T]=ot[R]=ot[P]=ot[L]=ot[F]=ot[N]=ot[U]=!0,ot[_]=ot[b]=ot[A]=!1;var st={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,ct=parseInt,ut="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,lt="object"==typeof self&&self&&self.Object===Object&&self,ht=ut||lt||Function("return this")(),dt=t&&!t.nodeType&&t,ft=dt&&e&&!e.nodeType&&e,pt=ft&&ft.exports===dt,mt=pt&&ut.process,vt=function(){try{return ft&&ft.require&&ft.require("util").types||mt&&mt.binding&&mt.binding("util")}catch(e){}}(),gt=vt&&vt.isArrayBuffer,yt=vt&&vt.isDate,_t=vt&&vt.isMap,bt=vt&&vt.isRegExp,wt=vt&&vt.isSet,kt=vt&&vt.isTypedArray;function Ct(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function St(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}function xt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Et(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Tt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Rt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}function Pt(e,t){return!(null==e||!e.length)&&Ft(e,t,0)>-1}function At(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Ot(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function It(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Dt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function jt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Bt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var zt=Ht("length");function Mt(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function Lt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Ft(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Lt(e,Ut,n)}function Nt(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Ut(e){return e!=e}function Wt(e,t){var n=null==e?0:e.length;return n?qt(e,t)/n:d}function Ht(e){return function(t){return null==t?i:t[e]}}function $t(e){return function(t){return null==e?i:e[t]}}function Gt(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function qt(e,t){for(var n,r=-1,o=e.length;++r<o;){var s=t(e[r]);s!==i&&(n=n===i?s:n+s)}return n}function Zt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Vt(e){return e?e.slice(0,dn(e)+1).replace(re,""):e}function Kt(e){return function(t){return e(t)}}function Jt(e,t){return Ot(t,(function(t){return e[t]}))}function Yt(e,t){return e.has(t)}function Xt(e,t){for(var n=-1,r=e.length;++n<r&&Ft(t,e[n],0)>-1;);return n}function Qt(e,t){for(var n=e.length;n--&&Ft(t,e[n],0)>-1;);return n}var en=$t({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),tn=$t({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function nn(e){return"\\"+st[e]}function rn(e){return et.test(e)}function on(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function sn(e,t){return function(n){return e(t(n))}}function an(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n];s!==t&&s!==a||(e[n]=a,o[i++]=n)}return o}function cn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function un(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function ln(e){return rn(e)?function(e){for(var t=Xe.lastIndex=0;Xe.test(e);)++t;return t}(e):zt(e)}function hn(e){return rn(e)?function(e){return e.match(Xe)||[]}(e):function(e){return e.split("")}(e)}function dn(e){for(var t=e.length;t--&&ie.test(e.charAt(t)););return t}var fn=$t({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),pn=function e(t){var n,r=(t=null==t?ht:pn.defaults(ht.Object(),t,pn.pick(ht,nt))).Array,ie=t.Date,we=t.Error,ke=t.Function,Ce=t.Math,Se=t.Object,xe=t.RegExp,Ee=t.String,Te=t.TypeError,Re=r.prototype,Pe=ke.prototype,Ae=Se.prototype,Oe=t["__core-js_shared__"],Ie=Pe.toString,De=Ae.hasOwnProperty,je=0,Be=(n=/[^.]+$/.exec(Oe&&Oe.keys&&Oe.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",ze=Ae.toString,Me=Ie.call(Se),Le=ht._,Fe=xe("^"+Ie.call(De).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ne=pt?t.Buffer:i,Ue=t.Symbol,We=t.Uint8Array,He=Ne?Ne.allocUnsafe:i,$e=sn(Se.getPrototypeOf,Se),Ge=Se.create,qe=Ae.propertyIsEnumerable,Ze=Re.splice,Ve=Ue?Ue.isConcatSpreadable:i,Ke=Ue?Ue.iterator:i,Xe=Ue?Ue.toStringTag:i,et=function(){try{var e=co(Se,"defineProperty");return e({},"",{}),e}catch(e){}}(),st=t.clearTimeout!==ht.clearTimeout&&t.clearTimeout,ut=ie&&ie.now!==ht.Date.now&&ie.now,lt=t.setTimeout!==ht.setTimeout&&t.setTimeout,dt=Ce.ceil,ft=Ce.floor,mt=Se.getOwnPropertySymbols,vt=Ne?Ne.isBuffer:i,zt=t.isFinite,$t=Re.join,mn=sn(Se.keys,Se),vn=Ce.max,gn=Ce.min,yn=ie.now,_n=t.parseInt,bn=Ce.random,wn=Re.reverse,kn=co(t,"DataView"),Cn=co(t,"Map"),Sn=co(t,"Promise"),xn=co(t,"Set"),En=co(t,"WeakMap"),Tn=co(Se,"create"),Rn=En&&new En,Pn={},An=Mo(kn),On=Mo(Cn),In=Mo(Sn),Dn=Mo(xn),jn=Mo(En),Bn=Ue?Ue.prototype:i,zn=Bn?Bn.valueOf:i,Mn=Bn?Bn.toString:i;function Ln(e){if(ea(e)&&!Hs(e)&&!(e instanceof Wn)){if(e instanceof Un)return e;if(De.call(e,"__wrapped__"))return Lo(e)}return new Un(e)}var Fn=function(){function e(){}return function(t){if(!Qs(t))return{};if(Ge)return Ge(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function Nn(){}function Un(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function Wn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=f,this.__views__=[]}function Hn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function $n(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Gn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function qn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Gn;++t<n;)this.add(e[t])}function Zn(e){var t=this.__data__=new $n(e);this.size=t.size}function Vn(e,t){var n=Hs(e),r=!n&&Ws(e),i=!n&&!r&&Zs(e),o=!n&&!r&&!i&&ca(e),s=n||r||i||o,a=s?Zt(e.length,Ee):[],c=a.length;for(var u in e)!t&&!De.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||vo(u,c))||a.push(u);return a}function Kn(e){var t=e.length;return t?e[Gr(0,t-1)]:i}function Jn(e,t){return Io(Ei(e),or(t,0,e.length))}function Yn(e){return Io(Ei(e))}function Xn(e,t,n){(n!==i&&!Fs(e[t],n)||n===i&&!(t in e))&&rr(e,t,n)}function Qn(e,t,n){var r=e[t];De.call(e,t)&&Fs(r,n)&&(n!==i||t in e)||rr(e,t,n)}function er(e,t){for(var n=e.length;n--;)if(Fs(e[n][0],t))return n;return-1}function tr(e,t,n,r){return lr(e,(function(e,i,o){t(r,e,n(e),o)})),r}function nr(e,t){return e&&Ti(t,Aa(t),e)}function rr(e,t,n){"__proto__"==t&&et?et(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ir(e,t){for(var n=-1,o=t.length,s=r(o),a=null==e;++n<o;)s[n]=a?i:xa(e,t[n]);return s}function or(e,t,n){return e==e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function sr(e,t,n,r,o,s){var a,c=1&t,u=2&t,l=4&t;if(n&&(a=o?n(e,r,o,s):n(e)),a!==i)return a;if(!Qs(e))return e;var h=Hs(e);if(h){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&De.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!c)return Ei(e,a)}else{var d=ho(e),f=d==b||d==w;if(Zs(e))return bi(e,c);if(d==S||d==m||f&&!o){if(a=u||f?{}:po(e),!c)return u?function(e,t){return Ti(e,lo(e),t)}(e,function(e,t){return e&&Ti(t,Oa(t),e)}(a,e)):function(e,t){return Ti(e,uo(e),t)}(e,nr(a,e))}else{if(!ot[d])return o?e:{};a=function(e,t,n){var r,i=e.constructor;switch(t){case O:return wi(e);case g:case y:return new i(+e);case I:return function(e,t){var n=t?wi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case D:case j:case B:case z:case M:case L:case F:case N:case U:return ki(e,n);case k:return new i;case C:case R:return new i(e);case E:return function(e){var t=new e.constructor(e.source,de.exec(e));return t.lastIndex=e.lastIndex,t}(e);case T:return new i;case P:return r=e,zn?Se(zn.call(r)):{}}}(e,d,c)}}s||(s=new Zn);var p=s.get(e);if(p)return p;s.set(e,a),oa(e)?e.forEach((function(r){a.add(sr(r,t,n,r,e,s))})):ta(e)&&e.forEach((function(r,i){a.set(i,sr(r,t,n,i,e,s))}));var v=h?i:(l?u?to:eo:u?Oa:Aa)(e);return xt(v||e,(function(r,i){v&&(r=e[i=r]),Qn(a,i,sr(r,t,n,i,e,s))})),a}function ar(e,t,n){var r=n.length;if(null==e)return!r;for(e=Se(e);r--;){var o=n[r],s=t[o],a=e[o];if(a===i&&!(o in e)||!s(a))return!1}return!0}function cr(e,t,n){if("function"!=typeof e)throw new Te(o);return Ro((function(){e.apply(i,n)}),t)}function ur(e,t,n,r){var i=-1,o=Pt,s=!0,a=e.length,c=[],u=t.length;if(!a)return c;n&&(t=Ot(t,Kt(n))),r?(o=At,s=!1):t.length>=200&&(o=Yt,s=!1,t=new qn(t));e:for(;++i<a;){var l=e[i],h=null==n?l:n(l);if(l=r||0!==l?l:0,s&&h==h){for(var d=u;d--;)if(t[d]===h)continue e;c.push(l)}else o(t,h,r)||c.push(l)}return c}Ln.templateSettings={escape:K,evaluate:J,interpolate:Y,variable:"",imports:{_:Ln}},Ln.prototype=Nn.prototype,Ln.prototype.constructor=Ln,Un.prototype=Fn(Nn.prototype),Un.prototype.constructor=Un,Wn.prototype=Fn(Nn.prototype),Wn.prototype.constructor=Wn,Hn.prototype.clear=function(){this.__data__=Tn?Tn(null):{},this.size=0},Hn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Hn.prototype.get=function(e){var t=this.__data__;if(Tn){var n=t[e];return n===s?i:n}return De.call(t,e)?t[e]:i},Hn.prototype.has=function(e){var t=this.__data__;return Tn?t[e]!==i:De.call(t,e)},Hn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Tn&&t===i?s:t,this},$n.prototype.clear=function(){this.__data__=[],this.size=0},$n.prototype.delete=function(e){var t=this.__data__,n=er(t,e);return!(n<0||(n==t.length-1?t.pop():Ze.call(t,n,1),--this.size,0))},$n.prototype.get=function(e){var t=this.__data__,n=er(t,e);return n<0?i:t[n][1]},$n.prototype.has=function(e){return er(this.__data__,e)>-1},$n.prototype.set=function(e,t){var n=this.__data__,r=er(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Gn.prototype.clear=function(){this.size=0,this.__data__={hash:new Hn,map:new(Cn||$n),string:new Hn}},Gn.prototype.delete=function(e){var t=so(this,e).delete(e);return this.size-=t?1:0,t},Gn.prototype.get=function(e){return so(this,e).get(e)},Gn.prototype.has=function(e){return so(this,e).has(e)},Gn.prototype.set=function(e,t){var n=so(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},qn.prototype.add=qn.prototype.push=function(e){return this.__data__.set(e,s),this},qn.prototype.has=function(e){return this.__data__.has(e)},Zn.prototype.clear=function(){this.__data__=new $n,this.size=0},Zn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Zn.prototype.get=function(e){return this.__data__.get(e)},Zn.prototype.has=function(e){return this.__data__.has(e)},Zn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof $n){var r=n.__data__;if(!Cn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Gn(r)}return n.set(e,t),this.size=n.size,this};var lr=Ai(yr),hr=Ai(_r,!0);function dr(e,t){var n=!0;return lr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function fr(e,t,n){for(var r=-1,o=e.length;++r<o;){var s=e[r],a=t(s);if(null!=a&&(c===i?a==a&&!aa(a):n(a,c)))var c=a,u=s}return u}function pr(e,t){var n=[];return lr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function mr(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=mo),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?mr(a,t-1,n,r,i):It(i,a):r||(i[i.length]=a)}return i}var vr=Oi(),gr=Oi(!0);function yr(e,t){return e&&vr(e,t,Aa)}function _r(e,t){return e&&gr(e,t,Aa)}function br(e,t){return Rt(t,(function(t){return Js(e[t])}))}function wr(e,t){for(var n=0,r=(t=vi(t,e)).length;null!=e&&n<r;)e=e[zo(t[n++])];return n&&n==r?e:i}function kr(e,t,n){var r=t(e);return Hs(e)?r:It(r,n(e))}function Cr(e){return null==e?e===i?"[object Undefined]":"[object Null]":Xe&&Xe in Se(e)?function(e){var t=De.call(e,Xe),n=e[Xe];try{e[Xe]=i;var r=!0}catch(e){}var o=ze.call(e);return r&&(t?e[Xe]=n:delete e[Xe]),o}(e):function(e){return ze.call(e)}(e)}function Sr(e,t){return e>t}function xr(e,t){return null!=e&&De.call(e,t)}function Er(e,t){return null!=e&&t in Se(e)}function Tr(e,t,n){for(var o=n?At:Pt,s=e[0].length,a=e.length,c=a,u=r(a),l=1/0,h=[];c--;){var d=e[c];c&&t&&(d=Ot(d,Kt(t))),l=gn(d.length,l),u[c]=!n&&(t||s>=120&&d.length>=120)?new qn(c&&d):i}d=e[0];var f=-1,p=u[0];e:for(;++f<s&&h.length<l;){var m=d[f],v=t?t(m):m;if(m=n||0!==m?m:0,!(p?Yt(p,v):o(h,v,n))){for(c=a;--c;){var g=u[c];if(!(g?Yt(g,v):o(e[c],v,n)))continue e}p&&p.push(v),h.push(m)}}return h}function Rr(e,t,n){var r=null==(e=xo(e,t=vi(t,e)))?e:e[zo(Ko(t))];return null==r?i:Ct(r,e,n)}function Pr(e){return ea(e)&&Cr(e)==m}function Ar(e,t,n,r,o){return e===t||(null==e||null==t||!ea(e)&&!ea(t)?e!=e&&t!=t:function(e,t,n,r,o,s){var a=Hs(e),c=Hs(t),u=a?v:ho(e),l=c?v:ho(t),h=(u=u==m?S:u)==S,d=(l=l==m?S:l)==S,f=u==l;if(f&&Zs(e)){if(!Zs(t))return!1;a=!0,h=!1}if(f&&!h)return s||(s=new Zn),a||ca(e)?Xi(e,t,n,r,o,s):function(e,t,n,r,i,o,s){switch(n){case I:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case O:return!(e.byteLength!=t.byteLength||!o(new We(e),new We(t)));case g:case y:case C:return Fs(+e,+t);case _:return e.name==t.name&&e.message==t.message;case E:case R:return e==t+"";case k:var a=on;case T:var c=1&r;if(a||(a=cn),e.size!=t.size&&!c)return!1;var u=s.get(e);if(u)return u==t;r|=2,s.set(e,t);var l=Xi(a(e),a(t),r,i,o,s);return s.delete(e),l;case P:if(zn)return zn.call(e)==zn.call(t)}return!1}(e,t,u,n,r,o,s);if(!(1&n)){var p=h&&De.call(e,"__wrapped__"),b=d&&De.call(t,"__wrapped__");if(p||b){var w=p?e.value():e,x=b?t.value():t;return s||(s=new Zn),o(w,x,n,r,s)}}return!!f&&(s||(s=new Zn),function(e,t,n,r,o,s){var a=1&n,c=eo(e),u=c.length;if(u!=eo(t).length&&!a)return!1;for(var l=u;l--;){var h=c[l];if(!(a?h in t:De.call(t,h)))return!1}var d=s.get(e),f=s.get(t);if(d&&f)return d==t&&f==e;var p=!0;s.set(e,t),s.set(t,e);for(var m=a;++l<u;){var v=e[h=c[l]],g=t[h];if(r)var y=a?r(g,v,h,t,e,s):r(v,g,h,e,t,s);if(!(y===i?v===g||o(v,g,n,r,s):y)){p=!1;break}m||(m="constructor"==h)}if(p&&!m){var _=e.constructor,b=t.constructor;_==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof b&&b instanceof b||(p=!1)}return s.delete(e),s.delete(t),p}(e,t,n,r,o,s))}(e,t,n,r,Ar,o))}function Or(e,t,n,r){var o=n.length,s=o,a=!r;if(null==e)return!s;for(e=Se(e);o--;){var c=n[o];if(a&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<s;){var u=(c=n[o])[0],l=e[u],h=c[1];if(a&&c[2]){if(l===i&&!(u in e))return!1}else{var d=new Zn;if(r)var f=r(l,h,u,e,t,d);if(!(f===i?Ar(h,l,3,r,d):f))return!1}}return!0}function Ir(e){return!(!Qs(e)||(t=e,Be&&Be in t))&&(Js(e)?Fe:me).test(Mo(e));var t}function Dr(e){return"function"==typeof e?e:null==e?nc:"object"==typeof e?Hs(e)?Lr(e[0],e[1]):Mr(e):hc(e)}function jr(e){if(!wo(e))return mn(e);var t=[];for(var n in Se(e))De.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Br(e,t){return e<t}function zr(e,t){var n=-1,i=Gs(e)?r(e.length):[];return lr(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function Mr(e){var t=ao(e);return 1==t.length&&t[0][2]?Co(t[0][0],t[0][1]):function(n){return n===e||Or(n,e,t)}}function Lr(e,t){return yo(e)&&ko(t)?Co(zo(e),t):function(n){var r=xa(n,e);return r===i&&r===t?Ea(n,e):Ar(t,r,3)}}function Fr(e,t,n,r,o){e!==t&&vr(t,(function(s,a){if(o||(o=new Zn),Qs(s))!function(e,t,n,r,o,s,a){var c=Eo(e,n),u=Eo(t,n),l=a.get(u);if(l)Xn(e,n,l);else{var h=s?s(c,u,n+"",e,t,a):i,d=h===i;if(d){var f=Hs(u),p=!f&&Zs(u),m=!f&&!p&&ca(u);h=u,f||p||m?Hs(c)?h=c:qs(c)?h=Ei(c):p?(d=!1,h=bi(u,!0)):m?(d=!1,h=ki(u,!0)):h=[]:ra(u)||Ws(u)?(h=c,Ws(c)?h=va(c):Qs(c)&&!Js(c)||(h=po(u))):d=!1}d&&(a.set(u,h),o(h,u,r,s,a),a.delete(u)),Xn(e,n,h)}}(e,t,a,n,Fr,r,o);else{var c=r?r(Eo(e,a),s,a+"",e,t,o):i;c===i&&(c=s),Xn(e,a,c)}}),Oa)}function Nr(e,t){var n=e.length;if(n)return vo(t+=t<0?n:0,n)?e[t]:i}function Ur(e,t,n){t=t.length?Ot(t,(function(e){return Hs(e)?function(t){return wr(t,1===e.length?e[0]:e)}:e})):[nc];var r=-1;t=Ot(t,Kt(oo()));var i=zr(e,(function(e,n,i){var o=Ot(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return function(e,t){var r=e.length;for(e.sort((function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;++r<s;){var c=Ci(i[r],o[r]);if(c)return r>=a?c:c*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}));r--;)e[r]=e[r].value;return e}(i)}function Wr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=wr(e,s);n(a,s)&&Jr(o,vi(s,e),a)}return o}function Hr(e,t,n,r){var i=r?Nt:Ft,o=-1,s=t.length,a=e;for(e===t&&(t=Ei(t)),n&&(a=Ot(e,Kt(n)));++o<s;)for(var c=0,u=t[o],l=n?n(u):u;(c=i(a,l,c,r))>-1;)a!==e&&Ze.call(a,c,1),Ze.call(e,c,1);return e}function $r(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;vo(i)?Ze.call(e,i,1):ci(e,i)}}return e}function Gr(e,t){return e+ft(bn()*(t-e+1))}function qr(e,t){var n="";if(!e||t<1||t>h)return n;do{t%2&&(n+=e),(t=ft(t/2))&&(e+=e)}while(t);return n}function Zr(e,t){return Po(So(e,t,nc),e+"")}function Vr(e){return Kn(Fa(e))}function Kr(e,t){var n=Fa(e);return Io(n,or(t,0,n.length))}function Jr(e,t,n,r){if(!Qs(e))return e;for(var o=-1,s=(t=vi(t,e)).length,a=s-1,c=e;null!=c&&++o<s;){var u=zo(t[o]),l=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(o!=a){var h=c[u];(l=r?r(h,u,c):i)===i&&(l=Qs(h)?h:vo(t[o+1])?[]:{})}Qn(c,u,l),c=c[u]}return e}var Yr=Rn?function(e,t){return Rn.set(e,t),e}:nc,Xr=et?function(e,t){return et(e,"toString",{configurable:!0,enumerable:!1,value:Qa(t),writable:!0})}:nc;function Qr(e){return Io(Fa(e))}function ei(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var s=r(o);++i<o;)s[i]=e[i+t];return s}function ti(e,t){var n;return lr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function ni(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=e[o];null!==s&&!aa(s)&&(n?s<=t:s<t)?r=o+1:i=o}return i}return ri(e,t,nc,n)}function ri(e,t,n,r){var o=0,s=null==e?0:e.length;if(0===s)return 0;for(var a=(t=n(t))!=t,c=null===t,u=aa(t),l=t===i;o<s;){var h=ft((o+s)/2),d=n(e[h]),f=d!==i,p=null===d,m=d==d,v=aa(d);if(a)var g=r||m;else g=l?m&&(r||f):c?m&&f&&(r||!p):u?m&&f&&!p&&(r||!v):!p&&!v&&(r?d<=t:d<t);g?o=h+1:s=h}return gn(s,4294967294)}function ii(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n],a=t?t(s):s;if(!n||!Fs(a,c)){var c=a;o[i++]=0===s?0:s}}return o}function oi(e){return"number"==typeof e?e:aa(e)?d:+e}function si(e){if("string"==typeof e)return e;if(Hs(e))return Ot(e,si)+"";if(aa(e))return Mn?Mn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ai(e,t,n){var r=-1,i=Pt,o=e.length,s=!0,a=[],c=a;if(n)s=!1,i=At;else if(o>=200){var u=t?null:qi(e);if(u)return cn(u);s=!1,i=Yt,c=new qn}else c=t?[]:a;e:for(;++r<o;){var l=e[r],h=t?t(l):l;if(l=n||0!==l?l:0,s&&h==h){for(var d=c.length;d--;)if(c[d]===h)continue e;t&&c.push(h),a.push(l)}else i(c,h,n)||(c!==a&&c.push(h),a.push(l))}return a}function ci(e,t){return null==(e=xo(e,t=vi(t,e)))||delete e[zo(Ko(t))]}function ui(e,t,n,r){return Jr(e,t,n(wr(e,t)),r)}function li(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ei(e,r?0:o,r?o+1:i):ei(e,r?o+1:0,r?i:o)}function hi(e,t){var n=e;return n instanceof Wn&&(n=n.value()),Dt(t,(function(e,t){return t.func.apply(t.thisArg,It([e],t.args))}),n)}function di(e,t,n){var i=e.length;if(i<2)return i?ai(e[0]):[];for(var o=-1,s=r(i);++o<i;)for(var a=e[o],c=-1;++c<i;)c!=o&&(s[o]=ur(s[o]||a,e[c],t,n));return ai(mr(s,1),t,n)}function fi(e,t,n){for(var r=-1,o=e.length,s=t.length,a={};++r<o;){var c=r<s?t[r]:i;n(a,e[r],c)}return a}function pi(e){return qs(e)?e:[]}function mi(e){return"function"==typeof e?e:nc}function vi(e,t){return Hs(e)?e:yo(e,t)?[e]:Bo(ga(e))}var gi=Zr;function yi(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:ei(e,t,n)}var _i=st||function(e){return ht.clearTimeout(e)};function bi(e,t){if(t)return e.slice();var n=e.length,r=He?He(n):new e.constructor(n);return e.copy(r),r}function wi(e){var t=new e.constructor(e.byteLength);return new We(t).set(new We(e)),t}function ki(e,t){var n=t?wi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ci(e,t){if(e!==t){var n=e!==i,r=null===e,o=e==e,s=aa(e),a=t!==i,c=null===t,u=t==t,l=aa(t);if(!c&&!l&&!s&&e>t||s&&a&&u&&!c&&!l||r&&a&&u||!n&&u||!o)return 1;if(!r&&!s&&!l&&e<t||l&&n&&o&&!r&&!s||c&&n&&o||!a&&o||!u)return-1}return 0}function Si(e,t,n,i){for(var o=-1,s=e.length,a=n.length,c=-1,u=t.length,l=vn(s-a,0),h=r(u+l),d=!i;++c<u;)h[c]=t[c];for(;++o<a;)(d||o<s)&&(h[n[o]]=e[o]);for(;l--;)h[c++]=e[o++];return h}function xi(e,t,n,i){for(var o=-1,s=e.length,a=-1,c=n.length,u=-1,l=t.length,h=vn(s-c,0),d=r(h+l),f=!i;++o<h;)d[o]=e[o];for(var p=o;++u<l;)d[p+u]=t[u];for(;++a<c;)(f||o<s)&&(d[p+n[a]]=e[o++]);return d}function Ei(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function Ti(e,t,n,r){var o=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var c=t[s],u=r?r(n[c],e[c],c,n,e):i;u===i&&(u=e[c]),o?rr(n,c,u):Qn(n,c,u)}return n}function Ri(e,t){return function(n,r){var i=Hs(n)?St:tr,o=t?t():{};return i(n,e,oo(r,2),o)}}function Pi(e){return Zr((function(t,n){var r=-1,o=n.length,s=o>1?n[o-1]:i,a=o>2?n[2]:i;for(s=e.length>3&&"function"==typeof s?(o--,s):i,a&&go(n[0],n[1],a)&&(s=o<3?i:s,o=1),t=Se(t);++r<o;){var c=n[r];c&&e(t,c,r,s)}return t}))}function Ai(e,t){return function(n,r){if(null==n)return n;if(!Gs(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=Se(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}function Oi(e){return function(t,n,r){for(var i=-1,o=Se(t),s=r(t),a=s.length;a--;){var c=s[e?a:++i];if(!1===n(o[c],c,o))break}return t}}function Ii(e){return function(t){var n=rn(t=ga(t))?hn(t):i,r=n?n[0]:t.charAt(0),o=n?yi(n,1).join(""):t.slice(1);return r[e]()+o}}function Di(e){return function(t){return Dt(Ja(Wa(t).replace(Je,"")),e,"")}}function ji(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Fn(e.prototype),r=e.apply(n,t);return Qs(r)?r:n}}function Bi(e){return function(t,n,r){var o=Se(t);if(!Gs(t)){var s=oo(n,3);t=Aa(t),n=function(e){return s(o[e],e,o)}}var a=e(t,n,r);return a>-1?o[s?t[a]:a]:i}}function zi(e){return Qi((function(t){var n=t.length,r=n,s=Un.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new Te(o);if(s&&!c&&"wrapper"==ro(a))var c=new Un([],!0)}for(r=c?r:n;++r<n;){var u=ro(a=t[r]),l="wrapper"==u?no(a):i;c=l&&_o(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?c[ro(l[0])].apply(c,l[3]):1==a.length&&_o(a)?c[u]():c.thru(a)}return function(){var e=arguments,r=e[0];if(c&&1==e.length&&Hs(r))return c.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function Mi(e,t,n,o,s,a,c,l,h,d){var f=t&u,p=1&t,m=2&t,v=24&t,g=512&t,y=m?i:ji(e);return function u(){for(var _=arguments.length,b=r(_),w=_;w--;)b[w]=arguments[w];if(v)var k=io(u),C=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(b,k);if(o&&(b=Si(b,o,s,v)),a&&(b=xi(b,a,c,v)),_-=C,v&&_<d){var S=an(b,k);return $i(e,t,Mi,u.placeholder,n,b,S,l,h,d-_)}var x=p?n:this,E=m?x[e]:e;return _=b.length,l?b=function(e,t){for(var n=e.length,r=gn(t.length,n),o=Ei(e);r--;){var s=t[r];e[r]=vo(s,n)?o[s]:i}return e}(b,l):g&&_>1&&b.reverse(),f&&h<_&&(b.length=h),this&&this!==ht&&this instanceof u&&(E=y||ji(E)),E.apply(x,b)}}function Li(e,t){return function(n,r){return function(e,t,n,r){return yr(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function Fi(e,t){return function(n,r){var o;if(n===i&&r===i)return t;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=si(n),r=si(r)):(n=oi(n),r=oi(r)),o=e(n,r)}return o}}function Ni(e){return Qi((function(t){return t=Ot(t,Kt(oo())),Zr((function(n){var r=this;return e(t,(function(e){return Ct(e,r,n)}))}))}))}function Ui(e,t){var n=(t=t===i?" ":si(t)).length;if(n<2)return n?qr(t,e):t;var r=qr(t,dt(e/ln(t)));return rn(t)?yi(hn(r),0,e).join(""):r.slice(0,e)}function Wi(e){return function(t,n,o){return o&&"number"!=typeof o&&go(t,n,o)&&(n=o=i),t=da(t),n===i?(n=t,t=0):n=da(n),function(e,t,n,i){for(var o=-1,s=vn(dt((t-e)/(n||1)),0),a=r(s);s--;)a[i?s:++o]=e,e+=n;return a}(t,n,o=o===i?t<n?1:-1:da(o),e)}}function Hi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ma(t),n=ma(n)),e(t,n)}}function $i(e,t,n,r,o,s,a,u,l,h){var d=8&t;t|=d?c:64,4&(t&=~(d?64:c))||(t&=-4);var f=[e,t,o,d?s:i,d?a:i,d?i:s,d?i:a,u,l,h],p=n.apply(i,f);return _o(e)&&To(p,f),p.placeholder=r,Ao(p,e,t)}function Gi(e){var t=Ce[e];return function(e,n){if(e=ma(e),(n=null==n?0:gn(fa(n),292))&&zt(e)){var r=(ga(e)+"e").split("e");return+((r=(ga(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var qi=xn&&1/cn(new xn([,-0]))[1]==l?function(e){return new xn(e)}:ac;function Zi(e){return function(t){var n=ho(t);return n==k?on(t):n==T?un(t):function(e,t){return Ot(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Vi(e,t,n,s,l,h,d,f){var p=2&t;if(!p&&"function"!=typeof e)throw new Te(o);var m=s?s.length:0;if(m||(t&=-97,s=l=i),d=d===i?d:vn(fa(d),0),f=f===i?f:fa(f),m-=l?l.length:0,64&t){var v=s,g=l;s=l=i}var y=p?i:no(e),_=[e,t,n,s,l,v,g,h,d,f];if(y&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,s=r==u&&8==n||r==u&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!s)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var c=t[3];if(c){var l=e[3];e[3]=l?Si(l,c,t[4]):c,e[4]=l?an(e[3],a):t[4]}(c=t[5])&&(l=e[5],e[5]=l?xi(l,c,t[6]):c,e[6]=l?an(e[5],a):t[6]),(c=t[7])&&(e[7]=c),r&u&&(e[8]=null==e[8]?t[8]:gn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(_,y),e=_[0],t=_[1],n=_[2],s=_[3],l=_[4],!(f=_[9]=_[9]===i?p?0:e.length:vn(_[9]-m,0))&&24&t&&(t&=-25),t&&1!=t)b=8==t||16==t?function(e,t,n){var o=ji(e);return function s(){for(var a=arguments.length,c=r(a),u=a,l=io(s);u--;)c[u]=arguments[u];var h=a<3&&c[0]!==l&&c[a-1]!==l?[]:an(c,l);return(a-=h.length)<n?$i(e,t,Mi,s.placeholder,i,c,h,i,i,n-a):Ct(this&&this!==ht&&this instanceof s?o:e,this,c)}}(e,t,f):t!=c&&33!=t||l.length?Mi.apply(i,_):function(e,t,n,i){var o=1&t,s=ji(e);return function t(){for(var a=-1,c=arguments.length,u=-1,l=i.length,h=r(l+c),d=this&&this!==ht&&this instanceof t?s:e;++u<l;)h[u]=i[u];for(;c--;)h[u++]=arguments[++a];return Ct(d,o?n:this,h)}}(e,t,n,s);else var b=function(e,t,n){var r=1&t,i=ji(e);return function t(){return(this&&this!==ht&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return Ao((y?Yr:To)(b,_),e,t)}function Ki(e,t,n,r){return e===i||Fs(e,Ae[n])&&!De.call(r,n)?t:e}function Ji(e,t,n,r,o,s){return Qs(e)&&Qs(t)&&(s.set(t,e),Fr(e,t,i,Ji,s),s.delete(t)),e}function Yi(e){return ra(e)?i:e}function Xi(e,t,n,r,o,s){var a=1&n,c=e.length,u=t.length;if(c!=u&&!(a&&u>c))return!1;var l=s.get(e),h=s.get(t);if(l&&h)return l==t&&h==e;var d=-1,f=!0,p=2&n?new qn:i;for(s.set(e,t),s.set(t,e);++d<c;){var m=e[d],v=t[d];if(r)var g=a?r(v,m,d,t,e,s):r(m,v,d,e,t,s);if(g!==i){if(g)continue;f=!1;break}if(p){if(!Bt(t,(function(e,t){if(!Yt(p,t)&&(m===e||o(m,e,n,r,s)))return p.push(t)}))){f=!1;break}}else if(m!==v&&!o(m,v,n,r,s)){f=!1;break}}return s.delete(e),s.delete(t),f}function Qi(e){return Po(So(e,i,$o),e+"")}function eo(e){return kr(e,Aa,uo)}function to(e){return kr(e,Oa,lo)}var no=Rn?function(e){return Rn.get(e)}:ac;function ro(e){for(var t=e.name+"",n=Pn[t],r=De.call(Pn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function io(e){return(De.call(Ln,"placeholder")?Ln:e).placeholder}function oo(){var e=Ln.iteratee||rc;return e=e===rc?Dr:e,arguments.length?e(arguments[0],arguments[1]):e}function so(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function ao(e){for(var t=Aa(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,ko(i)]}return t}function co(e,t){var n=function(e,t){return null==e?i:e[t]}(e,t);return Ir(n)?n:i}var uo=mt?function(e){return null==e?[]:(e=Se(e),Rt(mt(e),(function(t){return qe.call(e,t)})))}:pc,lo=mt?function(e){for(var t=[];e;)It(t,uo(e)),e=$e(e);return t}:pc,ho=Cr;function fo(e,t,n){for(var r=-1,i=(t=vi(t,e)).length,o=!1;++r<i;){var s=zo(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Xs(i)&&vo(s,i)&&(Hs(e)||Ws(e))}function po(e){return"function"!=typeof e.constructor||wo(e)?{}:Fn($e(e))}function mo(e){return Hs(e)||Ws(e)||!!(Ve&&e&&e[Ve])}function vo(e,t){var n=typeof e;return!!(t=null==t?h:t)&&("number"==n||"symbol"!=n&&ge.test(e))&&e>-1&&e%1==0&&e<t}function go(e,t,n){if(!Qs(n))return!1;var r=typeof t;return!!("number"==r?Gs(n)&&vo(t,n.length):"string"==r&&t in n)&&Fs(n[t],e)}function yo(e,t){if(Hs(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!aa(e))||Q.test(e)||!X.test(e)||null!=t&&e in Se(t)}function _o(e){var t=ro(e),n=Ln[t];if("function"!=typeof n||!(t in Wn.prototype))return!1;if(e===n)return!0;var r=no(n);return!!r&&e===r[0]}(kn&&ho(new kn(new ArrayBuffer(1)))!=I||Cn&&ho(new Cn)!=k||Sn&&ho(Sn.resolve())!=x||xn&&ho(new xn)!=T||En&&ho(new En)!=A)&&(ho=function(e){var t=Cr(e),n=t==S?e.constructor:i,r=n?Mo(n):"";if(r)switch(r){case An:return I;case On:return k;case In:return x;case Dn:return T;case jn:return A}return t});var bo=Oe?Js:mc;function wo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ae)}function ko(e){return e==e&&!Qs(e)}function Co(e,t){return function(n){return null!=n&&n[e]===t&&(t!==i||e in Se(n))}}function So(e,t,n){return t=vn(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=vn(i.length-t,0),a=r(s);++o<s;)a[o]=i[t+o];o=-1;for(var c=r(t+1);++o<t;)c[o]=i[o];return c[t]=n(a),Ct(e,this,c)}}function xo(e,t){return t.length<2?e:wr(e,ei(t,0,-1))}function Eo(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var To=Oo(Yr),Ro=lt||function(e,t){return ht.setTimeout(e,t)},Po=Oo(Xr);function Ao(e,t,n){var r=t+"";return Po(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(oe,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return xt(p,(function(n){var r="_."+n[0];t&n[1]&&!Pt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(se);return t?t[1].split(ae):[]}(r),n)))}function Oo(e){var t=0,n=0;return function(){var r=yn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Io(e,t){var n=-1,r=e.length,o=r-1;for(t=t===i?r:t;++n<t;){var s=Gr(n,o),a=e[s];e[s]=e[n],e[n]=a}return e.length=t,e}var Do,jo,Bo=(Do=Ds((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ee,(function(e,n,r,i){t.push(r?i.replace(le,"$1"):n||e)})),t}),(function(e){return 500===jo.size&&jo.clear(),e})),jo=Do.cache,Do);function zo(e){if("string"==typeof e||aa(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Mo(e){if(null!=e){try{return Ie.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Lo(e){if(e instanceof Wn)return e.clone();var t=new Un(e.__wrapped__,e.__chain__);return t.__actions__=Ei(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Fo=Zr((function(e,t){return qs(e)?ur(e,mr(t,1,qs,!0)):[]})),No=Zr((function(e,t){var n=Ko(t);return qs(n)&&(n=i),qs(e)?ur(e,mr(t,1,qs,!0),oo(n,2)):[]})),Uo=Zr((function(e,t){var n=Ko(t);return qs(n)&&(n=i),qs(e)?ur(e,mr(t,1,qs,!0),i,n):[]}));function Wo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:fa(n);return i<0&&(i=vn(r+i,0)),Lt(e,oo(t,3),i)}function Ho(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==i&&(o=fa(n),o=n<0?vn(r+o,0):gn(o,r-1)),Lt(e,oo(t,3),o,!0)}function $o(e){return null!=e&&e.length?mr(e,1):[]}function Go(e){return e&&e.length?e[0]:i}var qo=Zr((function(e){var t=Ot(e,pi);return t.length&&t[0]===e[0]?Tr(t):[]})),Zo=Zr((function(e){var t=Ko(e),n=Ot(e,pi);return t===Ko(n)?t=i:n.pop(),n.length&&n[0]===e[0]?Tr(n,oo(t,2)):[]})),Vo=Zr((function(e){var t=Ko(e),n=Ot(e,pi);return(t="function"==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?Tr(n,i,t):[]}));function Ko(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Jo=Zr(Yo);function Yo(e,t){return e&&e.length&&t&&t.length?Hr(e,t):e}var Xo=Qi((function(e,t){var n=null==e?0:e.length,r=ir(e,t);return $r(e,Ot(t,(function(e){return vo(e,n)?+e:e})).sort(Ci)),r}));function Qo(e){return null==e?e:wn.call(e)}var es=Zr((function(e){return ai(mr(e,1,qs,!0))})),ts=Zr((function(e){var t=Ko(e);return qs(t)&&(t=i),ai(mr(e,1,qs,!0),oo(t,2))})),ns=Zr((function(e){var t=Ko(e);return t="function"==typeof t?t:i,ai(mr(e,1,qs,!0),i,t)}));function rs(e){if(!e||!e.length)return[];var t=0;return e=Rt(e,(function(e){if(qs(e))return t=vn(e.length,t),!0})),Zt(t,(function(t){return Ot(e,Ht(t))}))}function is(e,t){if(!e||!e.length)return[];var n=rs(e);return null==t?n:Ot(n,(function(e){return Ct(t,i,e)}))}var os=Zr((function(e,t){return qs(e)?ur(e,t):[]})),ss=Zr((function(e){return di(Rt(e,qs))})),as=Zr((function(e){var t=Ko(e);return qs(t)&&(t=i),di(Rt(e,qs),oo(t,2))})),cs=Zr((function(e){var t=Ko(e);return t="function"==typeof t?t:i,di(Rt(e,qs),i,t)})),us=Zr(rs),ls=Zr((function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,is(e,n)}));function hs(e){var t=Ln(e);return t.__chain__=!0,t}function ds(e,t){return t(e)}var fs=Qi((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return ir(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Wn&&vo(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ds,args:[o],thisArg:i}),new Un(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(i),e}))):this.thru(o)})),ps=Ri((function(e,t,n){De.call(e,n)?++e[n]:rr(e,n,1)})),ms=Bi(Wo),vs=Bi(Ho);function gs(e,t){return(Hs(e)?xt:lr)(e,oo(t,3))}function ys(e,t){return(Hs(e)?Et:hr)(e,oo(t,3))}var _s=Ri((function(e,t,n){De.call(e,n)?e[n].push(t):rr(e,n,[t])})),bs=Zr((function(e,t,n){var i=-1,o="function"==typeof t,s=Gs(e)?r(e.length):[];return lr(e,(function(e){s[++i]=o?Ct(t,e,n):Rr(e,t,n)})),s})),ws=Ri((function(e,t,n){rr(e,n,t)}));function ks(e,t){return(Hs(e)?Ot:zr)(e,oo(t,3))}var Cs=Ri((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),Ss=Zr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&go(e,t[0],t[1])?t=[]:n>2&&go(t[0],t[1],t[2])&&(t=[t[0]]),Ur(e,mr(t,1),[])})),xs=ut||function(){return ht.Date.now()};function Es(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,Vi(e,u,i,i,i,i,t)}function Ts(e,t){var n;if("function"!=typeof t)throw new Te(o);return e=fa(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var Rs=Zr((function(e,t,n){var r=1;if(n.length){var i=an(n,io(Rs));r|=c}return Vi(e,r,t,n,i)})),Ps=Zr((function(e,t,n){var r=3;if(n.length){var i=an(n,io(Ps));r|=c}return Vi(t,r,e,n,i)}));function As(e,t,n){var r,s,a,c,u,l,h=0,d=!1,f=!1,p=!0;if("function"!=typeof e)throw new Te(o);function m(t){var n=r,o=s;return r=s=i,h=t,c=e.apply(o,n)}function v(e){var n=e-l;return l===i||n>=t||n<0||f&&e-h>=a}function g(){var e=xs();if(v(e))return y(e);u=Ro(g,function(e){var n=t-(e-l);return f?gn(n,a-(e-h)):n}(e))}function y(e){return u=i,p&&r?m(e):(r=s=i,c)}function _(){var e=xs(),n=v(e);if(r=arguments,s=this,l=e,n){if(u===i)return function(e){return h=e,u=Ro(g,t),d?m(e):c}(l);if(f)return _i(u),u=Ro(g,t),m(l)}return u===i&&(u=Ro(g,t)),c}return t=ma(t)||0,Qs(n)&&(d=!!n.leading,a=(f="maxWait"in n)?vn(ma(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),_.cancel=function(){u!==i&&_i(u),h=0,r=l=s=u=i},_.flush=function(){return u===i?c:y(xs())},_}var Os=Zr((function(e,t){return cr(e,1,t)})),Is=Zr((function(e,t,n){return cr(e,ma(t)||0,n)}));function Ds(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Te(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Ds.Cache||Gn),n}function js(e){if("function"!=typeof e)throw new Te(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ds.Cache=Gn;var Bs=gi((function(e,t){var n=(t=1==t.length&&Hs(t[0])?Ot(t[0],Kt(oo())):Ot(mr(t,1),Kt(oo()))).length;return Zr((function(r){for(var i=-1,o=gn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return Ct(e,this,r)}))})),zs=Zr((function(e,t){var n=an(t,io(zs));return Vi(e,c,i,t,n)})),Ms=Zr((function(e,t){var n=an(t,io(Ms));return Vi(e,64,i,t,n)})),Ls=Qi((function(e,t){return Vi(e,256,i,i,i,t)}));function Fs(e,t){return e===t||e!=e&&t!=t}var Ns=Hi(Sr),Us=Hi((function(e,t){return e>=t})),Ws=Pr(function(){return arguments}())?Pr:function(e){return ea(e)&&De.call(e,"callee")&&!qe.call(e,"callee")},Hs=r.isArray,$s=gt?Kt(gt):function(e){return ea(e)&&Cr(e)==O};function Gs(e){return null!=e&&Xs(e.length)&&!Js(e)}function qs(e){return ea(e)&&Gs(e)}var Zs=vt||mc,Vs=yt?Kt(yt):function(e){return ea(e)&&Cr(e)==y};function Ks(e){if(!ea(e))return!1;var t=Cr(e);return t==_||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ra(e)}function Js(e){if(!Qs(e))return!1;var t=Cr(e);return t==b||t==w||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ys(e){return"number"==typeof e&&e==fa(e)}function Xs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=h}function Qs(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ea(e){return null!=e&&"object"==typeof e}var ta=_t?Kt(_t):function(e){return ea(e)&&ho(e)==k};function na(e){return"number"==typeof e||ea(e)&&Cr(e)==C}function ra(e){if(!ea(e)||Cr(e)!=S)return!1;var t=$e(e);if(null===t)return!0;var n=De.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ie.call(n)==Me}var ia=bt?Kt(bt):function(e){return ea(e)&&Cr(e)==E},oa=wt?Kt(wt):function(e){return ea(e)&&ho(e)==T};function sa(e){return"string"==typeof e||!Hs(e)&&ea(e)&&Cr(e)==R}function aa(e){return"symbol"==typeof e||ea(e)&&Cr(e)==P}var ca=kt?Kt(kt):function(e){return ea(e)&&Xs(e.length)&&!!it[Cr(e)]},ua=Hi(Br),la=Hi((function(e,t){return e<=t}));function ha(e){if(!e)return[];if(Gs(e))return sa(e)?hn(e):Ei(e);if(Ke&&e[Ke])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Ke]());var t=ho(e);return(t==k?on:t==T?cn:Fa)(e)}function da(e){return e?(e=ma(e))===l||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function fa(e){var t=da(e),n=t%1;return t==t?n?t-n:t:0}function pa(e){return e?or(fa(e),0,f):0}function ma(e){if("number"==typeof e)return e;if(aa(e))return d;if(Qs(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Qs(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Vt(e);var n=pe.test(e);return n||ve.test(e)?ct(e.slice(2),n?2:8):fe.test(e)?d:+e}function va(e){return Ti(e,Oa(e))}function ga(e){return null==e?"":si(e)}var ya=Pi((function(e,t){if(wo(t)||Gs(t))Ti(t,Aa(t),e);else for(var n in t)De.call(t,n)&&Qn(e,n,t[n])})),_a=Pi((function(e,t){Ti(t,Oa(t),e)})),ba=Pi((function(e,t,n,r){Ti(t,Oa(t),e,r)})),wa=Pi((function(e,t,n,r){Ti(t,Aa(t),e,r)})),ka=Qi(ir),Ca=Zr((function(e,t){e=Se(e);var n=-1,r=t.length,o=r>2?t[2]:i;for(o&&go(t[0],t[1],o)&&(r=1);++n<r;)for(var s=t[n],a=Oa(s),c=-1,u=a.length;++c<u;){var l=a[c],h=e[l];(h===i||Fs(h,Ae[l])&&!De.call(e,l))&&(e[l]=s[l])}return e})),Sa=Zr((function(e){return e.push(i,Ji),Ct(Da,i,e)}));function xa(e,t,n){var r=null==e?i:wr(e,t);return r===i?n:r}function Ea(e,t){return null!=e&&fo(e,t,Er)}var Ta=Li((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ze.call(t)),e[t]=n}),Qa(nc)),Ra=Li((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ze.call(t)),De.call(e,t)?e[t].push(n):e[t]=[n]}),oo),Pa=Zr(Rr);function Aa(e){return Gs(e)?Vn(e):jr(e)}function Oa(e){return Gs(e)?Vn(e,!0):function(e){if(!Qs(e))return function(e){var t=[];if(null!=e)for(var n in Se(e))t.push(n);return t}(e);var t=wo(e),n=[];for(var r in e)("constructor"!=r||!t&&De.call(e,r))&&n.push(r);return n}(e)}var Ia=Pi((function(e,t,n){Fr(e,t,n)})),Da=Pi((function(e,t,n,r){Fr(e,t,n,r)})),ja=Qi((function(e,t){var n={};if(null==e)return n;var r=!1;t=Ot(t,(function(t){return t=vi(t,e),r||(r=t.length>1),t})),Ti(e,to(e),n),r&&(n=sr(n,7,Yi));for(var i=t.length;i--;)ci(n,t[i]);return n})),Ba=Qi((function(e,t){return null==e?{}:function(e,t){return Wr(e,t,(function(t,n){return Ea(e,n)}))}(e,t)}));function za(e,t){if(null==e)return{};var n=Ot(to(e),(function(e){return[e]}));return t=oo(t),Wr(e,n,(function(e,n){return t(e,n[0])}))}var Ma=Zi(Aa),La=Zi(Oa);function Fa(e){return null==e?[]:Jt(e,Aa(e))}var Na=Di((function(e,t,n){return t=t.toLowerCase(),e+(n?Ua(t):t)}));function Ua(e){return Ka(ga(e).toLowerCase())}function Wa(e){return(e=ga(e))&&e.replace(ye,en).replace(Ye,"")}var Ha=Di((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),$a=Di((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ga=Ii("toLowerCase"),qa=Di((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Za=Di((function(e,t,n){return e+(n?" ":"")+Ka(t)})),Va=Di((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ka=Ii("toUpperCase");function Ja(e,t,n){return e=ga(e),(t=n?i:t)===i?function(e){return tt.test(e)}(e)?function(e){return e.match(Qe)||[]}(e):function(e){return e.match(ce)||[]}(e):e.match(t)||[]}var Ya=Zr((function(e,t){try{return Ct(e,i,t)}catch(e){return Ks(e)?e:new we(e)}})),Xa=Qi((function(e,t){return xt(t,(function(t){t=zo(t),rr(e,t,Rs(e[t],e))})),e}));function Qa(e){return function(){return e}}var ec=zi(),tc=zi(!0);function nc(e){return e}function rc(e){return Dr("function"==typeof e?e:sr(e,1))}var ic=Zr((function(e,t){return function(n){return Rr(n,e,t)}})),oc=Zr((function(e,t){return function(n){return Rr(e,n,t)}}));function sc(e,t,n){var r=Aa(t),i=br(t,r);null!=n||Qs(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=br(t,Aa(t)));var o=!(Qs(n)&&"chain"in n&&!n.chain),s=Js(e);return xt(i,(function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=Ei(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,It([this.value()],arguments))})})),e}function ac(){}var cc=Ni(Ot),uc=Ni(Tt),lc=Ni(Bt);function hc(e){return yo(e)?Ht(zo(e)):function(e){return function(t){return wr(t,e)}}(e)}var dc=Wi(),fc=Wi(!0);function pc(){return[]}function mc(){return!1}var vc,gc=Fi((function(e,t){return e+t}),0),yc=Gi("ceil"),_c=Fi((function(e,t){return e/t}),1),bc=Gi("floor"),wc=Fi((function(e,t){return e*t}),1),kc=Gi("round"),Cc=Fi((function(e,t){return e-t}),0);return Ln.after=function(e,t){if("function"!=typeof t)throw new Te(o);return e=fa(e),function(){if(--e<1)return t.apply(this,arguments)}},Ln.ary=Es,Ln.assign=ya,Ln.assignIn=_a,Ln.assignInWith=ba,Ln.assignWith=wa,Ln.at=ka,Ln.before=Ts,Ln.bind=Rs,Ln.bindAll=Xa,Ln.bindKey=Ps,Ln.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Hs(e)?e:[e]},Ln.chain=hs,Ln.chunk=function(e,t,n){t=(n?go(e,t,n):t===i)?1:vn(fa(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var s=0,a=0,c=r(dt(o/t));s<o;)c[a++]=ei(e,s,s+=t);return c},Ln.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},Ln.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return It(Hs(n)?Ei(n):[n],mr(t,1))},Ln.cond=function(e){var t=null==e?0:e.length,n=oo();return e=t?Ot(e,(function(e){if("function"!=typeof e[1])throw new Te(o);return[n(e[0]),e[1]]})):[],Zr((function(n){for(var r=-1;++r<t;){var i=e[r];if(Ct(i[0],this,n))return Ct(i[1],this,n)}}))},Ln.conforms=function(e){return function(e){var t=Aa(e);return function(n){return ar(n,e,t)}}(sr(e,1))},Ln.constant=Qa,Ln.countBy=ps,Ln.create=function(e,t){var n=Fn(e);return null==t?n:nr(n,t)},Ln.curry=function e(t,n,r){var o=Vi(t,8,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Ln.curryRight=function e(t,n,r){var o=Vi(t,16,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Ln.debounce=As,Ln.defaults=Ca,Ln.defaultsDeep=Sa,Ln.defer=Os,Ln.delay=Is,Ln.difference=Fo,Ln.differenceBy=No,Ln.differenceWith=Uo,Ln.drop=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,(t=n||t===i?1:fa(t))<0?0:t,r):[]},Ln.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,0,(t=r-(t=n||t===i?1:fa(t)))<0?0:t):[]},Ln.dropRightWhile=function(e,t){return e&&e.length?li(e,oo(t,3),!0,!0):[]},Ln.dropWhile=function(e,t){return e&&e.length?li(e,oo(t,3),!0):[]},Ln.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&go(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=fa(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:fa(r))<0&&(r+=o),r=n>r?0:pa(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Ln.filter=function(e,t){return(Hs(e)?Rt:pr)(e,oo(t,3))},Ln.flatMap=function(e,t){return mr(ks(e,t),1)},Ln.flatMapDeep=function(e,t){return mr(ks(e,t),l)},Ln.flatMapDepth=function(e,t,n){return n=n===i?1:fa(n),mr(ks(e,t),n)},Ln.flatten=$o,Ln.flattenDeep=function(e){return null!=e&&e.length?mr(e,l):[]},Ln.flattenDepth=function(e,t){return null!=e&&e.length?mr(e,t=t===i?1:fa(t)):[]},Ln.flip=function(e){return Vi(e,512)},Ln.flow=ec,Ln.flowRight=tc,Ln.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Ln.functions=function(e){return null==e?[]:br(e,Aa(e))},Ln.functionsIn=function(e){return null==e?[]:br(e,Oa(e))},Ln.groupBy=_s,Ln.initial=function(e){return null!=e&&e.length?ei(e,0,-1):[]},Ln.intersection=qo,Ln.intersectionBy=Zo,Ln.intersectionWith=Vo,Ln.invert=Ta,Ln.invertBy=Ra,Ln.invokeMap=bs,Ln.iteratee=rc,Ln.keyBy=ws,Ln.keys=Aa,Ln.keysIn=Oa,Ln.map=ks,Ln.mapKeys=function(e,t){var n={};return t=oo(t,3),yr(e,(function(e,r,i){rr(n,t(e,r,i),e)})),n},Ln.mapValues=function(e,t){var n={};return t=oo(t,3),yr(e,(function(e,r,i){rr(n,r,t(e,r,i))})),n},Ln.matches=function(e){return Mr(sr(e,1))},Ln.matchesProperty=function(e,t){return Lr(e,sr(t,1))},Ln.memoize=Ds,Ln.merge=Ia,Ln.mergeWith=Da,Ln.method=ic,Ln.methodOf=oc,Ln.mixin=sc,Ln.negate=js,Ln.nthArg=function(e){return e=fa(e),Zr((function(t){return Nr(t,e)}))},Ln.omit=ja,Ln.omitBy=function(e,t){return za(e,js(oo(t)))},Ln.once=function(e){return Ts(2,e)},Ln.orderBy=function(e,t,n,r){return null==e?[]:(Hs(t)||(t=null==t?[]:[t]),Hs(n=r?i:n)||(n=null==n?[]:[n]),Ur(e,t,n))},Ln.over=cc,Ln.overArgs=Bs,Ln.overEvery=uc,Ln.overSome=lc,Ln.partial=zs,Ln.partialRight=Ms,Ln.partition=Cs,Ln.pick=Ba,Ln.pickBy=za,Ln.property=hc,Ln.propertyOf=function(e){return function(t){return null==e?i:wr(e,t)}},Ln.pull=Jo,Ln.pullAll=Yo,Ln.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Hr(e,t,oo(n,2)):e},Ln.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Hr(e,t,i,n):e},Ln.pullAt=Xo,Ln.range=dc,Ln.rangeRight=fc,Ln.rearg=Ls,Ln.reject=function(e,t){return(Hs(e)?Rt:pr)(e,js(oo(t,3)))},Ln.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=oo(t,3);++r<o;){var s=e[r];t(s,r,e)&&(n.push(s),i.push(r))}return $r(e,i),n},Ln.rest=function(e,t){if("function"!=typeof e)throw new Te(o);return Zr(e,t=t===i?t:fa(t))},Ln.reverse=Qo,Ln.sampleSize=function(e,t,n){return t=(n?go(e,t,n):t===i)?1:fa(t),(Hs(e)?Jn:Kr)(e,t)},Ln.set=function(e,t,n){return null==e?e:Jr(e,t,n)},Ln.setWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:Jr(e,t,n,r)},Ln.shuffle=function(e){return(Hs(e)?Yn:Qr)(e)},Ln.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&go(e,t,n)?(t=0,n=r):(t=null==t?0:fa(t),n=n===i?r:fa(n)),ei(e,t,n)):[]},Ln.sortBy=Ss,Ln.sortedUniq=function(e){return e&&e.length?ii(e):[]},Ln.sortedUniqBy=function(e,t){return e&&e.length?ii(e,oo(t,2)):[]},Ln.split=function(e,t,n){return n&&"number"!=typeof n&&go(e,t,n)&&(t=n=i),(n=n===i?f:n>>>0)?(e=ga(e))&&("string"==typeof t||null!=t&&!ia(t))&&!(t=si(t))&&rn(e)?yi(hn(e),0,n):e.split(t,n):[]},Ln.spread=function(e,t){if("function"!=typeof e)throw new Te(o);return t=null==t?0:vn(fa(t),0),Zr((function(n){var r=n[t],i=yi(n,0,t);return r&&It(i,r),Ct(e,this,i)}))},Ln.tail=function(e){var t=null==e?0:e.length;return t?ei(e,1,t):[]},Ln.take=function(e,t,n){return e&&e.length?ei(e,0,(t=n||t===i?1:fa(t))<0?0:t):[]},Ln.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,(t=r-(t=n||t===i?1:fa(t)))<0?0:t,r):[]},Ln.takeRightWhile=function(e,t){return e&&e.length?li(e,oo(t,3),!1,!0):[]},Ln.takeWhile=function(e,t){return e&&e.length?li(e,oo(t,3)):[]},Ln.tap=function(e,t){return t(e),e},Ln.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new Te(o);return Qs(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),As(e,t,{leading:r,maxWait:t,trailing:i})},Ln.thru=ds,Ln.toArray=ha,Ln.toPairs=Ma,Ln.toPairsIn=La,Ln.toPath=function(e){return Hs(e)?Ot(e,zo):aa(e)?[e]:Ei(Bo(ga(e)))},Ln.toPlainObject=va,Ln.transform=function(e,t,n){var r=Hs(e),i=r||Zs(e)||ca(e);if(t=oo(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:Qs(e)&&Js(o)?Fn($e(e)):{}}return(i?xt:yr)(e,(function(e,r,i){return t(n,e,r,i)})),n},Ln.unary=function(e){return Es(e,1)},Ln.union=es,Ln.unionBy=ts,Ln.unionWith=ns,Ln.uniq=function(e){return e&&e.length?ai(e):[]},Ln.uniqBy=function(e,t){return e&&e.length?ai(e,oo(t,2)):[]},Ln.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?ai(e,i,t):[]},Ln.unset=function(e,t){return null==e||ci(e,t)},Ln.unzip=rs,Ln.unzipWith=is,Ln.update=function(e,t,n){return null==e?e:ui(e,t,mi(n))},Ln.updateWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:ui(e,t,mi(n),r)},Ln.values=Fa,Ln.valuesIn=function(e){return null==e?[]:Jt(e,Oa(e))},Ln.without=os,Ln.words=Ja,Ln.wrap=function(e,t){return zs(mi(t),e)},Ln.xor=ss,Ln.xorBy=as,Ln.xorWith=cs,Ln.zip=us,Ln.zipObject=function(e,t){return fi(e||[],t||[],Qn)},Ln.zipObjectDeep=function(e,t){return fi(e||[],t||[],Jr)},Ln.zipWith=ls,Ln.entries=Ma,Ln.entriesIn=La,Ln.extend=_a,Ln.extendWith=ba,sc(Ln,Ln),Ln.add=gc,Ln.attempt=Ya,Ln.camelCase=Na,Ln.capitalize=Ua,Ln.ceil=yc,Ln.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=ma(n))==n?n:0),t!==i&&(t=(t=ma(t))==t?t:0),or(ma(e),t,n)},Ln.clone=function(e){return sr(e,4)},Ln.cloneDeep=function(e){return sr(e,5)},Ln.cloneDeepWith=function(e,t){return sr(e,5,t="function"==typeof t?t:i)},Ln.cloneWith=function(e,t){return sr(e,4,t="function"==typeof t?t:i)},Ln.conformsTo=function(e,t){return null==t||ar(e,t,Aa(t))},Ln.deburr=Wa,Ln.defaultTo=function(e,t){return null==e||e!=e?t:e},Ln.divide=_c,Ln.endsWith=function(e,t,n){e=ga(e),t=si(t);var r=e.length,o=n=n===i?r:or(fa(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},Ln.eq=Fs,Ln.escape=function(e){return(e=ga(e))&&V.test(e)?e.replace(q,tn):e},Ln.escapeRegExp=function(e){return(e=ga(e))&&ne.test(e)?e.replace(te,"\\$&"):e},Ln.every=function(e,t,n){var r=Hs(e)?Tt:dr;return n&&go(e,t,n)&&(t=i),r(e,oo(t,3))},Ln.find=ms,Ln.findIndex=Wo,Ln.findKey=function(e,t){return Mt(e,oo(t,3),yr)},Ln.findLast=vs,Ln.findLastIndex=Ho,Ln.findLastKey=function(e,t){return Mt(e,oo(t,3),_r)},Ln.floor=bc,Ln.forEach=gs,Ln.forEachRight=ys,Ln.forIn=function(e,t){return null==e?e:vr(e,oo(t,3),Oa)},Ln.forInRight=function(e,t){return null==e?e:gr(e,oo(t,3),Oa)},Ln.forOwn=function(e,t){return e&&yr(e,oo(t,3))},Ln.forOwnRight=function(e,t){return e&&_r(e,oo(t,3))},Ln.get=xa,Ln.gt=Ns,Ln.gte=Us,Ln.has=function(e,t){return null!=e&&fo(e,t,xr)},Ln.hasIn=Ea,Ln.head=Go,Ln.identity=nc,Ln.includes=function(e,t,n,r){e=Gs(e)?e:Fa(e),n=n&&!r?fa(n):0;var i=e.length;return n<0&&(n=vn(i+n,0)),sa(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Ft(e,t,n)>-1},Ln.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:fa(n);return i<0&&(i=vn(r+i,0)),Ft(e,t,i)},Ln.inRange=function(e,t,n){return t=da(t),n===i?(n=t,t=0):n=da(n),function(e,t,n){return e>=gn(t,n)&&e<vn(t,n)}(e=ma(e),t,n)},Ln.invoke=Pa,Ln.isArguments=Ws,Ln.isArray=Hs,Ln.isArrayBuffer=$s,Ln.isArrayLike=Gs,Ln.isArrayLikeObject=qs,Ln.isBoolean=function(e){return!0===e||!1===e||ea(e)&&Cr(e)==g},Ln.isBuffer=Zs,Ln.isDate=Vs,Ln.isElement=function(e){return ea(e)&&1===e.nodeType&&!ra(e)},Ln.isEmpty=function(e){if(null==e)return!0;if(Gs(e)&&(Hs(e)||"string"==typeof e||"function"==typeof e.splice||Zs(e)||ca(e)||Ws(e)))return!e.length;var t=ho(e);if(t==k||t==T)return!e.size;if(wo(e))return!jr(e).length;for(var n in e)if(De.call(e,n))return!1;return!0},Ln.isEqual=function(e,t){return Ar(e,t)},Ln.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:i)?n(e,t):i;return r===i?Ar(e,t,i,n):!!r},Ln.isError=Ks,Ln.isFinite=function(e){return"number"==typeof e&&zt(e)},Ln.isFunction=Js,Ln.isInteger=Ys,Ln.isLength=Xs,Ln.isMap=ta,Ln.isMatch=function(e,t){return e===t||Or(e,t,ao(t))},Ln.isMatchWith=function(e,t,n){return n="function"==typeof n?n:i,Or(e,t,ao(t),n)},Ln.isNaN=function(e){return na(e)&&e!=+e},Ln.isNative=function(e){if(bo(e))throw new we("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ir(e)},Ln.isNil=function(e){return null==e},Ln.isNull=function(e){return null===e},Ln.isNumber=na,Ln.isObject=Qs,Ln.isObjectLike=ea,Ln.isPlainObject=ra,Ln.isRegExp=ia,Ln.isSafeInteger=function(e){return Ys(e)&&e>=-9007199254740991&&e<=h},Ln.isSet=oa,Ln.isString=sa,Ln.isSymbol=aa,Ln.isTypedArray=ca,Ln.isUndefined=function(e){return e===i},Ln.isWeakMap=function(e){return ea(e)&&ho(e)==A},Ln.isWeakSet=function(e){return ea(e)&&"[object WeakSet]"==Cr(e)},Ln.join=function(e,t){return null==e?"":$t.call(e,t)},Ln.kebabCase=Ha,Ln.last=Ko,Ln.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=fa(n))<0?vn(r+o,0):gn(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Lt(e,Ut,o,!0)},Ln.lowerCase=$a,Ln.lowerFirst=Ga,Ln.lt=ua,Ln.lte=la,Ln.max=function(e){return e&&e.length?fr(e,nc,Sr):i},Ln.maxBy=function(e,t){return e&&e.length?fr(e,oo(t,2),Sr):i},Ln.mean=function(e){return Wt(e,nc)},Ln.meanBy=function(e,t){return Wt(e,oo(t,2))},Ln.min=function(e){return e&&e.length?fr(e,nc,Br):i},Ln.minBy=function(e,t){return e&&e.length?fr(e,oo(t,2),Br):i},Ln.stubArray=pc,Ln.stubFalse=mc,Ln.stubObject=function(){return{}},Ln.stubString=function(){return""},Ln.stubTrue=function(){return!0},Ln.multiply=wc,Ln.nth=function(e,t){return e&&e.length?Nr(e,fa(t)):i},Ln.noConflict=function(){return ht._===this&&(ht._=Le),this},Ln.noop=ac,Ln.now=xs,Ln.pad=function(e,t,n){e=ga(e);var r=(t=fa(t))?ln(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Ui(ft(i),n)+e+Ui(dt(i),n)},Ln.padEnd=function(e,t,n){e=ga(e);var r=(t=fa(t))?ln(e):0;return t&&r<t?e+Ui(t-r,n):e},Ln.padStart=function(e,t,n){e=ga(e);var r=(t=fa(t))?ln(e):0;return t&&r<t?Ui(t-r,n)+e:e},Ln.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),_n(ga(e).replace(re,""),t||0)},Ln.random=function(e,t,n){if(n&&"boolean"!=typeof n&&go(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=da(e),t===i?(t=e,e=0):t=da(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=bn();return gn(e+o*(t-e+at("1e-"+((o+"").length-1))),t)}return Gr(e,t)},Ln.reduce=function(e,t,n){var r=Hs(e)?Dt:Gt,i=arguments.length<3;return r(e,oo(t,4),n,i,lr)},Ln.reduceRight=function(e,t,n){var r=Hs(e)?jt:Gt,i=arguments.length<3;return r(e,oo(t,4),n,i,hr)},Ln.repeat=function(e,t,n){return t=(n?go(e,t,n):t===i)?1:fa(t),qr(ga(e),t)},Ln.replace=function(){var e=arguments,t=ga(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Ln.result=function(e,t,n){var r=-1,o=(t=vi(t,e)).length;for(o||(o=1,e=i);++r<o;){var s=null==e?i:e[zo(t[r])];s===i&&(r=o,s=n),e=Js(s)?s.call(e):s}return e},Ln.round=kc,Ln.runInContext=e,Ln.sample=function(e){return(Hs(e)?Kn:Vr)(e)},Ln.size=function(e){if(null==e)return 0;if(Gs(e))return sa(e)?ln(e):e.length;var t=ho(e);return t==k||t==T?e.size:jr(e).length},Ln.snakeCase=qa,Ln.some=function(e,t,n){var r=Hs(e)?Bt:ti;return n&&go(e,t,n)&&(t=i),r(e,oo(t,3))},Ln.sortedIndex=function(e,t){return ni(e,t)},Ln.sortedIndexBy=function(e,t,n){return ri(e,t,oo(n,2))},Ln.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=ni(e,t);if(r<n&&Fs(e[r],t))return r}return-1},Ln.sortedLastIndex=function(e,t){return ni(e,t,!0)},Ln.sortedLastIndexBy=function(e,t,n){return ri(e,t,oo(n,2),!0)},Ln.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=ni(e,t,!0)-1;if(Fs(e[n],t))return n}return-1},Ln.startCase=Za,Ln.startsWith=function(e,t,n){return e=ga(e),n=null==n?0:or(fa(n),0,e.length),t=si(t),e.slice(n,n+t.length)==t},Ln.subtract=Cc,Ln.sum=function(e){return e&&e.length?qt(e,nc):0},Ln.sumBy=function(e,t){return e&&e.length?qt(e,oo(t,2)):0},Ln.template=function(e,t,n){var r=Ln.templateSettings;n&&go(e,t,n)&&(t=i),e=ga(e),t=ba({},t,r,Ki);var o,s,a=ba({},t.imports,r.imports,Ki),c=Aa(a),u=Jt(a,c),l=0,h=t.interpolate||_e,d="__p += '",f=xe((t.escape||_e).source+"|"+h.source+"|"+(h===Y?he:_e).source+"|"+(t.evaluate||_e).source+"|$","g"),p="//# sourceURL="+(De.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++rt+"]")+"\n";e.replace(f,(function(t,n,r,i,a,c){return r||(r=i),d+=e.slice(l,c).replace(be,nn),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),a&&(s=!0,d+="';\n"+a+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=c+t.length,t})),d+="';\n";var m=De.call(t,"variable")&&t.variable;if(m){if(ue.test(m))throw new we("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(s?d.replace(W,""):d).replace(H,"$1").replace($,"$1;"),d="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var v=Ya((function(){return ke(c,p+"return "+d).apply(i,u)}));if(v.source=d,Ks(v))throw v;return v},Ln.times=function(e,t){if((e=fa(e))<1||e>h)return[];var n=f,r=gn(e,f);t=oo(t),e-=f;for(var i=Zt(r,t);++n<e;)t(n);return i},Ln.toFinite=da,Ln.toInteger=fa,Ln.toLength=pa,Ln.toLower=function(e){return ga(e).toLowerCase()},Ln.toNumber=ma,Ln.toSafeInteger=function(e){return e?or(fa(e),-9007199254740991,h):0===e?e:0},Ln.toString=ga,Ln.toUpper=function(e){return ga(e).toUpperCase()},Ln.trim=function(e,t,n){if((e=ga(e))&&(n||t===i))return Vt(e);if(!e||!(t=si(t)))return e;var r=hn(e),o=hn(t);return yi(r,Xt(r,o),Qt(r,o)+1).join("")},Ln.trimEnd=function(e,t,n){if((e=ga(e))&&(n||t===i))return e.slice(0,dn(e)+1);if(!e||!(t=si(t)))return e;var r=hn(e);return yi(r,0,Qt(r,hn(t))+1).join("")},Ln.trimStart=function(e,t,n){if((e=ga(e))&&(n||t===i))return e.replace(re,"");if(!e||!(t=si(t)))return e;var r=hn(e);return yi(r,Xt(r,hn(t))).join("")},Ln.truncate=function(e,t){var n=30,r="...";if(Qs(t)){var o="separator"in t?t.separator:o;n="length"in t?fa(t.length):n,r="omission"in t?si(t.omission):r}var s=(e=ga(e)).length;if(rn(e)){var a=hn(e);s=a.length}if(n>=s)return e;var c=n-ln(r);if(c<1)return r;var u=a?yi(a,0,c).join(""):e.slice(0,c);if(o===i)return u+r;if(a&&(c+=u.length-c),ia(o)){if(e.slice(c).search(o)){var l,h=u;for(o.global||(o=xe(o.source,ga(de.exec(o))+"g")),o.lastIndex=0;l=o.exec(h);)var d=l.index;u=u.slice(0,d===i?c:d)}}else if(e.indexOf(si(o),c)!=c){var f=u.lastIndexOf(o);f>-1&&(u=u.slice(0,f))}return u+r},Ln.unescape=function(e){return(e=ga(e))&&Z.test(e)?e.replace(G,fn):e},Ln.uniqueId=function(e){var t=++je;return ga(e)+t},Ln.upperCase=Va,Ln.upperFirst=Ka,Ln.each=gs,Ln.eachRight=ys,Ln.first=Go,sc(Ln,(vc={},yr(Ln,(function(e,t){De.call(Ln.prototype,t)||(vc[t]=e)})),vc),{chain:!1}),Ln.VERSION="4.17.21",xt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Ln[e].placeholder=Ln})),xt(["drop","take"],(function(e,t){Wn.prototype[e]=function(n){n=n===i?1:vn(fa(n),0);var r=this.__filtered__&&!t?new Wn(this):this.clone();return r.__filtered__?r.__takeCount__=gn(n,r.__takeCount__):r.__views__.push({size:gn(n,f),type:e+(r.__dir__<0?"Right":"")}),r},Wn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),xt(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Wn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:oo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),xt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Wn.prototype[e]=function(){return this[n](1).value()[0]}})),xt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Wn.prototype[e]=function(){return this.__filtered__?new Wn(this):this[n](1)}})),Wn.prototype.compact=function(){return this.filter(nc)},Wn.prototype.find=function(e){return this.filter(e).head()},Wn.prototype.findLast=function(e){return this.reverse().find(e)},Wn.prototype.invokeMap=Zr((function(e,t){return"function"==typeof e?new Wn(this):this.map((function(n){return Rr(n,e,t)}))})),Wn.prototype.reject=function(e){return this.filter(js(oo(e)))},Wn.prototype.slice=function(e,t){e=fa(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Wn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=fa(t))<0?n.dropRight(-t):n.take(t-e)),n)},Wn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Wn.prototype.toArray=function(){return this.take(f)},yr(Wn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Ln[r?"take"+("last"==t?"Right":""):t],s=r||/^find/.test(t);o&&(Ln.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,c=t instanceof Wn,u=a[0],l=c||Hs(t),h=function(e){var t=o.apply(Ln,It([e],a));return r&&d?t[0]:t};l&&n&&"function"==typeof u&&1!=u.length&&(c=l=!1);var d=this.__chain__,f=!!this.__actions__.length,p=s&&!d,m=c&&!f;if(!s&&l){t=m?t:new Wn(this);var v=e.apply(t,a);return v.__actions__.push({func:ds,args:[h],thisArg:i}),new Un(v,d)}return p&&m?e.apply(this,a):(v=this.thru(h),p?r?v.value()[0]:v.value():v)})})),xt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Re[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Ln.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Hs(i)?i:[],e)}return this[n]((function(n){return t.apply(Hs(n)?n:[],e)}))}})),yr(Wn.prototype,(function(e,t){var n=Ln[t];if(n){var r=n.name+"";De.call(Pn,r)||(Pn[r]=[]),Pn[r].push({name:t,func:n})}})),Pn[Mi(i,2).name]=[{name:"wrapper",func:i}],Wn.prototype.clone=function(){var e=new Wn(this.__wrapped__);return e.__actions__=Ei(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ei(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ei(this.__views__),e},Wn.prototype.reverse=function(){if(this.__filtered__){var e=new Wn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Wn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Hs(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=gn(t,e+s);break;case"takeRight":e=vn(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,c=a-s,u=r?a:s-1,l=this.__iteratees__,h=l.length,d=0,f=gn(c,this.__takeCount__);if(!n||!r&&i==c&&f==c)return hi(e,this.__actions__);var p=[];e:for(;c--&&d<f;){for(var m=-1,v=e[u+=t];++m<h;){var g=l[m],y=g.iteratee,_=g.type,b=y(v);if(2==_)v=b;else if(!b){if(1==_)continue e;break e}}p[d++]=v}return p},Ln.prototype.at=fs,Ln.prototype.chain=function(){return hs(this)},Ln.prototype.commit=function(){return new Un(this.value(),this.__chain__)},Ln.prototype.next=function(){this.__values__===i&&(this.__values__=ha(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},Ln.prototype.plant=function(e){for(var t,n=this;n instanceof Nn;){var r=Lo(n);r.__index__=0,r.__values__=i,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},Ln.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Wn){var t=e;return this.__actions__.length&&(t=new Wn(this)),(t=t.reverse()).__actions__.push({func:ds,args:[Qo],thisArg:i}),new Un(t,this.__chain__)}return this.thru(Qo)},Ln.prototype.toJSON=Ln.prototype.valueOf=Ln.prototype.value=function(){return hi(this.__wrapped__,this.__actions__)},Ln.prototype.first=Ln.prototype.head,Ke&&(Ln.prototype[Ke]=function(){return this}),Ln}();ht._=pn,(r=function(){return pn}.call(t,n,t,e))===i||(e.exports=r)}.call(this)},942:function(e,t,n){"use strict";const r=n(9727),{hasOwnProperty:i}=Object.prototype,{propertyIsEnumerable:o}=Object,s=(e,t,n)=>Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0}),a=this,c={concatArrays:!1,ignoreUndefined:!1},u=e=>{const t=[];for(const n in e)i.call(e,n)&&t.push(n);if(Object.getOwnPropertySymbols){const n=Object.getOwnPropertySymbols(e);for(const r of n)o.call(e,r)&&t.push(r)}return t};function l(e){return Array.isArray(e)?function(e){const t=e.slice(0,0);return u(e).forEach((n=>{s(t,n,l(e[n]))})),t}(e):r(e)?function(e){const t=null===Object.getPrototypeOf(e)?Object.create(null):{};return u(e).forEach((n=>{s(t,n,l(e[n]))})),t}(e):e}const h=(e,t,n,r)=>(n.forEach((n=>{void 0===t[n]&&r.ignoreUndefined||(n in e&&e[n]!==Object.getPrototypeOf(e)?s(e,n,f(e[n],t[n],r)):s(e,n,l(t[n])))})),e),d=(e,t,n)=>{let r=e.slice(0,0),o=0;return[e,t].forEach((t=>{const a=[];for(let n=0;n<t.length;n++)i.call(t,n)&&(a.push(String(n)),s(r,o++,t===e?t[n]:l(t[n])));r=h(r,t,u(t).filter((e=>!a.includes(e))),n)})),r};function f(e,t,n){return n.concatArrays&&Array.isArray(e)&&Array.isArray(t)?d(e,t,n):r(t)&&r(e)?h(e,t,u(t),n):l(t)}e.exports=function(...e){const t=f(l(c),this!==a&&this||{},c);let n={_:{}};for(const i of e)if(void 0!==i){if(!r(i))throw new TypeError("`"+i+"` is not an Option Object");n=f(n,{_:i},t)}return n._}},9727:e=>{"use strict";e.exports=e=>{if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}},6:(e,t,n)=>{var r=n(1220).MY,i=n(1220).cx,o={unpack:function(e){return new s(e).unpack()},pack:function(e){var t=new a;return t.pack(e),t.getBuffer()}};function s(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function a(){this.bufferBuilder=new r}function c(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}e.exports=o,s.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:case 212:case 213:case 214:case 215:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},s.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},s.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},s.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},s.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},s.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},s.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},s.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},s.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},s.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},s.prototype.unpack_string=function(e){for(var t,n,r=this.read(e),i=0,o="";i<e;)(t=r[i])<128?(o+=String.fromCharCode(t),i++):(192^t)<32?(n=(192^t)<<6|63&r[i+1],o+=String.fromCharCode(n),i+=2):(n=(15&t)<<12|(63&r[i+1])<<6|63&r[i+2],o+=String.fromCharCode(n),i+=3);return this.index+=e,o},s.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},s.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var r=this.unpack(),i=this.unpack();t[r]=i}return t},s.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},s.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},s.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},a.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},a.prototype.pack=function(e){var t=typeof e;if("string"===t)this.pack_string(e);else if("number"===t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"===t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"===t)this.bufferBuilder.append(192);else{if("object"!==t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(n==ArrayBuffer)i.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)i.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(n==Object||n.toString().startsWith("class"))this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},a.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,c).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},a.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(255&e);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},a.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,n)-1,i=Math.floor(r*Math.pow(2,52)),o=Math.pow(2,32),s=t<<31|n+1023<<20|i/o&1048575,a=i%o;this.bufferBuilder.append(203),this.pack_int32(s),this.pack_int32(a)},a.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},a.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},a.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},a.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},a.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},a.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},1220:e=>{var t={};t.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),t.useArrayBufferView=!t.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),e.exports.cx=t;var n=e.exports.xE;function r(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(n=e.exports.xE=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),r.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},r.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);t.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},r.prototype.getBuffer=function(){if(this.flush(),t.useBlobBuilder){for(var e=new n,r=0,i=this._parts.length;r<i;r++)e.append(this._parts[r]);return e.getBlob()}return new Blob(this._parts)},e.exports.MY=r},2539:(e,t,n)=>{"use strict";var r=n(7539);function i(e,t,n,i,o){var s=r.writeRtpDescription(e.kind,t);if(s+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),s+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?s+="a=sendrecv\r\n":e.rtpSender?s+="a=sendonly\r\n":e.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var c="msid:"+(i?i.id:"-")+" "+a+"\r\n";s+="a="+c,s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,s+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),s}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),s=r(t.parameters.apt,i);return o&&s&&o.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var s=t.codecs[o];if(r.name.toLowerCase()===s.name.toLowerCase()&&r.clockRate===s.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&s.parameters.apt&&!i(r,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(r.numChannels,s.numChannels),n.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function s(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function a(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}e.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function u(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var l=function(n){var i=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var s=n.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},l.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},l.prototype._gather=function(t,n){var i=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var s=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:n};var a=e.candidate,c=!a||0===Object.keys(a).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),a.component=1,a.ufrag=o.getLocalParameters().usernameFragment;var u=r.writeCandidate(a);s.candidate=Object.assign(s.candidate,r.parseCandidate(u)),s.candidate.candidate=u,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var l=r.getMediaSections(i._localDescription.sdp);l[s.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+l.join("");var h=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",s),h&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){s.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,i){var s=o(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(s.encodings=e.sendEncodingParameters,s.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(s.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(s)),i&&e.rtpReceiver&&s.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?s.encodings=e.recvEncodingParameters:s.encodings=[{}],s.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(s.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(s.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(s))},l.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!s("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var a=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var s=i.transceivers[t],c=s.iceGatherer,u=s.iceTransport,l=s.dtlsTransport,h=s.localCapabilities,d=s.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length||s.rejected)){var f=r.getIceParameters(e,n),p=r.getDtlsParameters(e,n);a&&(p.role="server"),i.usingBundle&&0!==t||(i._gather(s.mid,t),"new"===u.state&&u.start(c,f,a?"controlling":"controlled"),"new"===l.state&&l.start(p));var m=o(h,d);i._transceive(s,m.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(i){var l=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!s("setRemoteDescription",i.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+l.signalingState));var h={};l.remoteStreams.forEach((function(e){h[e.id]=e}));var d=[],f=r.splitSections(i.sdp),p=f.shift(),m=r.matchPrefix(p,"a=ice-lite").length>0,v=r.matchPrefix(p,"a=group:BUNDLE ").length>0;l.usingBundle=v;var g=r.matchPrefix(p,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,f.forEach((function(s,c){var u=r.splitLines(s),f=r.getKind(s),g=r.isRejected(s)&&0===r.matchPrefix(s,"a=bundle-only").length,y=u[0].substr(2).split(" ")[2],_=r.getDirection(s,p),b=r.parseMsid(s),w=r.getMid(s)||r.generateIdentifier();if(g||"application"===f&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y))l.transceivers[c]={mid:w,kind:f,protocol:y,rejected:!0};else{var k,C,S,x,E,T,R,P,A;!g&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(f,!0));var O,I,D=r.parseRtpParameters(s);g||(O=r.getIceParameters(s,p),(I=r.getDtlsParameters(s,p)).role="client"),R=r.parseRtpEncodingParameters(s);var j=r.parseRtcpParameters(s),B=r.matchPrefix(s,"a=end-of-candidates",p).length>0,z=r.matchPrefix(s,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!g&&v&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==i.type||g)"answer"!==i.type||g||(C=(k=l.transceivers[c]).iceGatherer,S=k.iceTransport,x=k.dtlsTransport,E=k.rtpReceiver,T=k.sendEncodingParameters,P=k.localCapabilities,l.transceivers[c].recvEncodingParameters=R,l.transceivers[c].remoteCapabilities=D,l.transceivers[c].rtcpParameters=j,z.length&&"new"===S.state&&(!m&&!B||v&&0!==c?z.forEach((function(e){a(k.iceTransport,e)})):S.setRemoteCandidates(z)),v&&0!==c||("new"===S.state&&S.start(C,O,"controlling"),"new"===x.state&&x.start(I)),!o(k.localCapabilities,k.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&k.sendEncodingParameters[0].rtx&&delete k.sendEncodingParameters[0].rtx,l._transceive(k,"sendrecv"===_||"recvonly"===_,"sendrecv"===_||"sendonly"===_),!E||"sendrecv"!==_&&"sendonly"!==_?delete k.rtpReceiver:(A=E.track,b?(h[b.stream]||(h[b.stream]=new e.MediaStream),n(A,h[b.stream]),d.push([A,E,h[b.stream]])):(h.default||(h.default=new e.MediaStream),n(A,h.default),d.push([A,E,h.default]))));else{(k=l.transceivers[c]||l._createTransceiver(f)).mid=w,k.iceGatherer||(k.iceGatherer=l._createIceGatherer(c,v)),z.length&&"new"===k.iceTransport.state&&(!B||v&&0!==c?z.forEach((function(e){a(k.iceTransport,e)})):k.iceTransport.setRemoteCandidates(z)),P=e.RTCRtpReceiver.getCapabilities(f),t<15019&&(P.codecs=P.codecs.filter((function(e){return"rtx"!==e.name}))),T=k.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var M,L=!1;"sendrecv"===_||"sendonly"===_?(L=!k.rtpReceiver,E=k.rtpReceiver||new e.RTCRtpReceiver(k.dtlsTransport,f),L&&(A=E.track,b&&"-"===b.stream||(b?(h[b.stream]||(h[b.stream]=new e.MediaStream,Object.defineProperty(h[b.stream],"id",{get:function(){return b.stream}})),Object.defineProperty(A,"id",{get:function(){return b.track}}),M=h[b.stream]):(h.default||(h.default=new e.MediaStream),M=h.default)),M&&(n(A,M),k.associatedRemoteMediaStreams.push(M)),d.push([A,E,M]))):k.rtpReceiver&&k.rtpReceiver.track&&(k.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===k.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),k.associatedRemoteMediaStreams=[]),k.localCapabilities=P,k.remoteCapabilities=D,k.rtpReceiver=E,k.rtcpParameters=j,k.sendEncodingParameters=T,k.recvEncodingParameters=R,l._transceive(l.transceivers[c],!1,L)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===i.type?"active":"passive"),l._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(h).forEach((function(t){var n=h[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout((function(){l._dispatchEvent("addstream",r)}))}d.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&u(l,t,r,[n])}))}})),d.forEach((function(e){e[2]||u(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=n.transceivers.filter((function(e){return"audio"===e.kind})).length,s=n.transceivers.filter((function(e){return"video"===e.kind})).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(o=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(s=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--s<0&&(e.wantReceive=!1)}));o>0||s>0;)o>0&&(n._createTransceiver("audio"),o--),s>0&&(n._createTransceiver("video"),s--);var u=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(i,o){var s=i.track,a=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(o,n.usingBundle));var u=e.RTCRtpSender.getCapabilities(a);t<15019&&(u.codecs=u.codecs.filter((function(e){return"rtx"!==e.name}))),u.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),u.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=i.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];s&&t>=15019&&"video"===a&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,a)),i.localCapabilities=u,i.sendEncodingParameters=l})),"max-compat"!==n._config.bundlePolicy&&(u+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),u+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){u+=i(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),u+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,u+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(u+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:u});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var s=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(s+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var a=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,r){if(!(r+1>a)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var u=o(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=i(e,u,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var u=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(u)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,o){if(!n._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var s=e.sdpMLineIndex;if(e.sdpMid)for(var u=0;u<n.transceivers.length;u++)if(n.transceivers[u].mid===e.sdpMid){s=u;break}var l=n.transceivers[s];if(!l)return o(c("OperationError","Can not add ICE candidate"));if(l.rejected)return i();var h=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===h.protocol&&(0===h.port||9===h.port))return i();if(h.component&&1!==h.component)return i();if((0===s||s>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!a(l.iceTransport,h))return o(c("OperationError","Can not add ICE candidate"));var d=e.candidate.trim();0===d.indexOf("a=")&&(d=d.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[s]+="a="+(h.type?d:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var f=0;f<n.transceivers.length&&(n.transceivers[f].rejected||(n.transceivers[f].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[f]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));f++);i()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var r;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=e[n]).type]||r.type,t.set(n,e[n])})),t}))}}}));var h=["createOffer","createAnswer"];return h.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(h=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},7539:e=>{"use strict";var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((function(e){return 0===e.indexOf(n)}))},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){var r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],i=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&i?{usernameFragment:r.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var o=r[i],s=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var a=t.parseRtpMap(s),c=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=c.length?t.parseFmtp(c[0]):{},a.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),n.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(a.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){n.headerExtensions.push(t.parseExtmap(e))})),n},t.writeRtpDescription=function(e,n){var r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=n.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((function(e){r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));var i=0;return n.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),r+="a=rtcp-mux\r\n",n.headerExtensions&&n.headerExtensions.forEach((function(e){r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){var n,r=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,u=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(n=u[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&n&&(t.rtx={ssrc:n}),r.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},r.push(t))}})),0===r.length&&c&&r.push({ssrc:c});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=l}))),r},t.parseRtcpParameters=function(e){var n={},r=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.parseMsid=function(e){var n,r=t.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(n=r[0].substr(7).split(" "))[0],track:n[1]};var i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(n=i[0].value.split(" "))[0],track:n[1]}:void 0},t.parseSctpDescription=function(e){var n,r=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");i.length>0&&(n=parseInt(i[0].substr(19),10)),isNaN(n)&&(n=65536);var o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:r.fmt,maxMessageSize:n};if(t.matchPrefix(e,"a=sctpmap:").length>0){var s=t.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,r){var i=void 0!==n?n:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,n,r,i){var o=t.writeRtpDescription(e.kind,n);if(o+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),o},t.getDirection=function(e,n){for(var r=t.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var n=t.splitLines(e),r=0;r<n.length;r++)if(n[r].length<2||"="!==n[r].charAt(1))return!1;return!0},e.exports=t},2480:()=>{}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&!e;)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{fixNegotiationNeeded:()=>it,shimAddTrackRemoveTrack:()=>nt,shimAddTrackRemoveTrackWithNative:()=>tt,shimGetDisplayMedia:()=>Ke,shimGetSendersWithDtmf:()=>Xe,shimGetStats:()=>Qe,shimGetUserMedia:()=>Ve,shimMediaStream:()=>Je,shimOnTrack:()=>Ye,shimPeerConnection:()=>rt,shimSenderReceiverGetStats:()=>et});var t={};n.r(t),n.d(t,{shimGetDisplayMedia:()=>ct,shimGetUserMedia:()=>at,shimPeerConnection:()=>ut,shimReplaceTrack:()=>lt});var r={};n.r(r),n.d(r,{shimAddTransceiver:()=>_t,shimCreateAnswer:()=>kt,shimCreateOffer:()=>wt,shimGetDisplayMedia:()=>dt,shimGetParameters:()=>bt,shimGetUserMedia:()=>ht,shimOnTrack:()=>ft,shimPeerConnection:()=>pt,shimRTCDataChannel:()=>yt,shimReceiverGetStats:()=>vt,shimRemoveStream:()=>gt,shimSenderGetStats:()=>mt});var i={};n.r(i),n.d(i,{shimAudioContext:()=>Ot,shimCallbacksAPI:()=>xt,shimConstraints:()=>Tt,shimCreateOfferLegacy:()=>At,shimGetUserMedia:()=>Et,shimLocalStreamsAPI:()=>Ct,shimRTCIceServerUrls:()=>Rt,shimRemoteStreamsAPI:()=>St,shimTrackEventTransceiver:()=>Pt});var o={};n.r(o),n.d(o,{removeExtmapAllowMixed:()=>Lt,shimAddIceCandidateNullOrEmpty:()=>Ft,shimConnectionState:()=>Mt,shimMaxMessageSize:()=>Bt,shimRTCIceCandidate:()=>jt,shimSendThrowTypeError:()=>zt});const s=n(942);class a{constructor(){this.waiting=!0,this.resolved=!1,this.rejected=!1,this.promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}resolve(e){this.waiting=!1,this.resolved=!0,this._resolve(e)}reject(e){this.waiting=!1,this.rejected=!0,this._reject(e)}timeout(e,t){setTimeout((()=>{this.waiting&&this.reject(new c(null!=t?t:"Timeout"))}),e)}}class c extends Error{}class u extends a{}class l{constructor(){this.queue=[],this.currentTask=void 0,this.current=void 0}push(e){const t=new u;return t.start=()=>{e().then((e=>t.resolve(e))).catch((e=>t.reject(e)))},this.queue.push(t),this.current||(this.current=this.start()),t.promise}start(){return e=this,t=void 0,r=function*(){for(;this.queue.length;){const e=this.queue.shift();this.currentTask=e,e.start(),yield e.promise.catch((()=>{}))}this.currentTask=void 0,this.current=void 0},new((n=void 0)||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}));var e,t,n,r}interupt(){for(;this.queue.length;)this.queue.shift().reject();this.currentTask&&this.currentTask.reject(),this.currentTask=void 0,this.current=void 0}wait(){return this.current||Promise.resolve()}}function h(e){return null==e}function d(e,t){return n=this,r=void 0,o=function*(){return h(e)?null:t(yield e)},new((i=void 0)||(i=Promise))((function(e,t){function s(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(s,a)}c((o=o.apply(n,r||[])).next())}));var n,r,i,o}const f="abcdefghijklmnopqrstuvwxyz",p=f+"ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_";function m(e,t){const n=document.createElement(e);if(h(t.text)||n.appendChild(document.createTextNode(t.text)),t.classList&&n.classList.add(...t.classList),t.id&&(n.id=t.id),t.children)for(const e of t.children)n.appendChild(e);if(t.attributes)for(const[e,r]of Object.entries(t.attributes))n.setAttribute(e,r);return t.onclick&&(n.onclick=t.onclick),t.disabled&&(n.setAttribute("disabled","true"),n.ariaDisabled="true"),n}var v=n(6486);function g(e){return"object"==typeof e?void 0===e?"undefined":null===e?"null":Array.isArray(e)?"["+e.map(g).join(", ")+"]":["{",Object.entries(e).map((([e,t])=>`"${e}": ${g(t)}`)).join(", "),"}"].join(""):typeof e}class y{constructor(){this.expected=new Map,this.got=new Map}writer(e,t){return this.got.set(e,t),new _(this,e)}write(e,t){var n;const r=null!==(n=this.expected.get(e))&&void 0!==n?n:[];r.push(...t),this.expected.set(e,r)}error(){return Array.from(this.expected).map((([e,t])=>{const n=g(this.got.get(e));return`${e}: expected: [${t.join(", ")}] got ${n}`})).join("\n")}}class _{constructor(e,t){this.tracker=e,this.localization=t}expected(...e){this.tracker.write(this.localization,e)}enter(e,t){return this.tracker.writer(this.localization+"."+e,t)}}class b extends Error{}class w{constructor(e,t,n){this.name=e,this.is=t,this.validate=n}cast(e){const t=new y;if(this.validate(e,t.writer("",e)))return e;throw new b(t.error())}assert(e){const t=new y;if(!this.validate(e,t.writer("",e)))throw new b(t.error())}}class k extends w{constructor(e,t){super(e,t,((e,t)=>!!this.is(e)||(this.complain(t),!1)))}complain(e){e.expected(this.name)}}class C extends w{constructor(e,t){super(e,(e=>{const t=new y;return this.validate(e,t.writer("",e))}),t)}}const S=e=>Object.entries(e);function x(e){return new k(e,(t=>typeof t===e))}var E;!function(e){function t(e){return new k(JSON.stringify(e),(t=>t===e))}function n(...e){return new k(e.map((e=>e.name)).join("|"),(t=>e.some((e=>e.is(t)))))}function r(...e){return new k(e.map((e=>e.name)).join("&"),(t=>e.every((e=>e.is(t)))))}function i(e,t){return new k(`Tuple<${e.name}, ${t}>`,(n=>Array.isArray(n)&&n.length===t&&n.every((t=>e.is(t)))))}e.unknown=new k("unknown",(e=>!0)),e.string=x("string"),e.number=x("number"),e.boolean=x("boolean"),e.literal=t,e.union=n,e.or=n,e.oneof=function(...e){return this.or(...e.map((e=>t(e))))},e.merge=r,e.and=r,e.array=function(e){return new k(`Array<${e.name}>`,(t=>Array.isArray(t)&&t.every((t=>e.is(t)))))},e.tuple=function(...e){return new k(`[${e.map((e=>e.name)).join(", ")}]`,(t=>!!Array.isArray(t)&&t.length===e.length&&v.zip(e,t).every((([e,t])=>e.is(t)))))},e.record=function(e,t){return new k(`Record<${e.name}, ${t.name}>`,(n=>"object"==typeof n&&null!==n&&Object.entries(n).every((([n,r])=>e.is(n)&&t.is(r)))))},e.object=function(e){const t=S(e).map((([e,t])=>function(e,t){return new k(`"${String(e)}": ${t.name}`,(n=>t.is(n[e])))}(e,t)));return new C("{"+t.map((e=>e.name)).join(", ")+"}",((t,n)=>{if("object"!=typeof t)return n.expected("object"),!1;if(null===t)return n.expected("object"),!1;for(const[r,i]of Object.entries(e)){const e=t[r];if(!i.validate(e,n.enter(r,e)))return!1}return!0}))},e.vector=i,e.matrix=function(e,...t){return t.reduce(((e,t)=>i(e,t)),e)},e.pairings=function(e,t){return P.array(P.tuple(e,t))}}(E||(E={}));const T=x("undefined"),R=E.literal(null),P=Object.assign(Object.assign({},E),{undefined:T,null:R,nullish:E.or(T,R),nullable:e=>P.or(e,R,T),optional:e=>P.or(e,T)}),A=new class extends w{constructor(e){super(e,void 0,void 0)}morph(e){this.is=e.is,this.validate=e.validate}}("ElementDescriptor");var O;function I(e){return P.string.is(e)?{text:e}:O.elementDescriptor.is(e)?e:I(String(e))}function D(e){return{text:e}}!function(e){e.style=P.object({styles:P.array(P.string)}),e.textElement=P.object({text:P.string,styles:P.optional(P.array(P.string))}),e.textElementDivider=P.object({text:P.literal("%=="),styles:P.optional(P.array(P.string))}),e.inline=P.object({display:P.literal("inline"),children:P.array(A),styles:P.optional(P.array(P.string))}),e.block=P.object({display:P.literal("block"),children:P.array(A),styles:P.optional(P.array(P.string))}),e.elementDescriptor=P.or(e.textElement,e.inline,e.block),A.morph(e.elementDescriptor)}(O||(O={}));const j=()=>D("%==");function B(...e){return{display:"block",children:e.map(I)}}function z(...e){return B(...e.map((e=>B(e))))}function M(...e){return{display:"inline",children:e.map(I)}}function L(e){if(O.textElement.is(e))return e.text;if(O.inline.is(e))return e.children.map(L).join("");if(O.block.is(e))return e.children.map(L).join("")+"\n";throw new Error("never")}function F(e,t=[]){return function(e,t){return O.style.is(e)?Object.assign(Object.assign({},e),{styles:[...e.styles,...t]}):Object.assign(Object.assign({},e),{styles:[...t]})}(I(e),t)}function N(e){return L(I(e))}function U(e){var t;const n=function(e){var t,n,r,i;if(O.textElementDivider.is(e))return m("hr",{classList:null!==(t=e.styles)&&void 0!==t?t:[]});if(O.textElement.is(e))return m("span",{text:e.text,classList:null!==(n=e.styles)&&void 0!==n?n:[]});if(O.inline.is(e))return m("span",{children:e.children.map(U),classList:null!==(r=e.styles)&&void 0!==r?r:[]});if(O.block.is(e))return m("div",{children:e.children.map(U),classList:null!==(i=e.styles)&&void 0!==i?i:[]});throw new Error(`unexpected ${JSON.stringify(e)}`)}(e);if(null===(t=e.styles)||void 0===t?void 0:t.includes("text-glitch")){const e=n.innerText.split(" "),t=setInterval((()=>{(function(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)})(n)&&(n.innerText=e.map((e=>e.split("").sort((function(){return.5-Math.random()})).join(""))).join(" ")),n.parentElement||clearInterval(t)}),100);setTimeout((()=>clearInterval(t)),3e5)}return n}function W(e,t){void 0===t?(e.style.removeProperty("height"),e.style.removeProperty("min-height"),e.style.removeProperty("max-height")):(e.style.setProperty("height",t),e.style.setProperty("min-height",t),e.style.setProperty("max-height",t))}class H{constructor(e){this.keybinds=new Map,this.keys=Array.from("1234567890qwertyuiopasdfghjklzxcvbnm"),this.items=[],this.buttons={},this.title=e.title;for(const t of e.items)this.push(t)}push(e){const t=Object.assign({},e);this.assignMenuKey(t),this.items.push(t)}searchForKeybind(e){const t=["the","a","an"],n=e.toLowerCase().split(" ").map((e=>e.trim())).filter((e=>e&&e.length&&!t.includes(e))).join("");for(const e of n)if(!this.keybinds.has(e))return e;for(;;){const e=this.keys.shift();if(!e)break;if(!this.keybinds.has(e))return e}}assignMenuKey(e){let t=e.keybind,n=e.keyicon||t;t&&!this.keybinds.has(t)||(t=this.searchForKeybind(e.text),n=t),e.keybind=t,e.keyicon=n,this.keybinds.set(t,e.value)}renderMenuElement(e,t){const n=m("button",{text:e.keyicon.toUpperCase(),classList:["btn","btn-secondary","btn-sm","keyicon","me-2"]});this.buttons[e.keybind]=n;const r=m("div",{classList:["text-nowrap","m-2","menu-item"],children:[n,m("span",{text:e.text})]});return r.onclick=()=>t(e.value),r}display(e){const t=new a,n=new a;function r(e){n.resolve(e),t.resolve(void 0)}const i=m("div",{children:[m("h5",{text:this.title}),m("div",{classList:["d-flex","flex-row","justify-content-start","align-items-start","flex-wrap"],children:this.items.map((e=>this.renderMenuElement(e,r)))})]}),o=e=>{if(this.keybinds.has(e.key)){try{this.buttons[e.key].classList.add("btn-click")}catch(e){console.error(e)}setTimeout((()=>r(this.keybinds.get(e.key))),100)}};return e.presentInput(i,t.promise,(()=>{window.addEventListener("keydown",o)}),(()=>{window.removeEventListener("keydown",o)})).catch((()=>n.resolve(null))),n.promise}}class ${constructor(e){this.placeholder="",this.cancelable=!0,this.cancelButtonText="Back",this.cancelButtonKeybind="Escape",this.autofocus=!0,this.password=!1,Object.assign(this,e)}createInputElement(e){const t=m("input",{classList:["form-control"],attributes:{placeholder:this.placeholder,type:this.password?"password":"text",autofocus:this.autofocus?"true":void 0}});return t.onkeydown=n=>{"Enter"===n.key&&e(t.value)},t}createLabelElement(){return m("span",{text:this.label,classList:["input-group-text"]})}createButtonElement(){return m("button",{text:this.cancelButtonText,classList:["btn","btn-outline-secondary"]})}createTitleElement(){return m("h5",{text:this.title})}display(e){const t=new a,n=new a;function r(e){n.resolve(e),t.resolve(void 0)}const i=this.createTitleElement(),o=this.createInputElement(r),s=this.createLabelElement(),c=this.cancelable?this.createButtonElement():void 0,u=m("div",{children:[i,m("div",{classList:["input-group"],children:[s,o,c].filter((e=>!!e))})]}),l=e=>{this.cancelable&&e.key===this.cancelButtonKeybind&&r(null)};return e.presentInput(u,t.promise,(()=>{this.autofocus&&setTimeout((()=>o.focus()),100),this.cancelable&&window.addEventListener("keydown",l)}),(()=>{this.cancelable&&window.removeEventListener("keydown",l)})),n.promise}}var G;class q{constructor(e){this.inputLock=new l;const t=m("div",{classList:["container-xl"]}),n=m("pre",{classList:["console-output","m-0","p-0"],children:[t]}),r=m("div",{classList:["container-xl"]}),i=m("div",{classList:["console-input","p-4"],children:[r]});e.appendChild(n),e.appendChild(i),this.container=e,this.outputContainer=n,this.inputContainer=i,this.output=t,this.input=r,this.hideInput()}menu(e,...t){const n=new H({title:e,items:[]});for(const e of t)"string"==typeof e?n.push({text:e,value:e}):n.push(e);return n.display(this)}simpleMenu(e,t){return this.menu(e,...Object.entries(t).map((([e,t])=>({text:e,value:t}))))}ask(e,t,n){return new $({title:e,label:t,placeholder:n}).display(this)}setInputSize(e){this.inputContainer.style.removeProperty("display"),void 0===e?(W(this.inputContainer,void 0),W(this.outputContainer,"100%")):(W(this.inputContainer,`${e}px`),W(this.outputContainer,`calc(100% - ${e}px)`))}resizeInput(){const e=this.isScrolledToBottom();this.setInputSize(),this.setInputSize(Math.max(this.inputContainer.getBoundingClientRect().height,128)),e&&this.scrollToBottom()}hideInput(){this.input.replaceChildren(),this.inputContainer.style.setProperty("display","none"),W(this.inputContainer,"0"),W(this.outputContainer,"100%")}disableInput(){this.input.style.setProperty("opacity","50%"),this.input.setAttribute("disabled","true")}enableInput(){this.input.style.removeProperty("opacity"),this.input.removeAttribute("disabled")}presentInput(e,t,n,r){const i=()=>{r(),this.disableInput()},o=this.inputLock.push((()=>{return r=this,i=void 0,s=function*(){this.input.replaceChildren(e),this.enableInput(),this.resizeInput(),n(),yield t},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{c(s.next(e))}catch(e){t(e)}}function a(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,a)}c((s=s.apply(r,i||[])).next())}));var r,i,o,s}));return o.then(i).catch(i),o}interuptInput(){this.inputLock.interupt()}injectSpaces(e){return e.map((e=>[e,document.createTextNode(" ")])).flat().slice(0,-1)}write(...e){const t=this.isScrolledToBottom(),n=this.injectSpaces(e.map((e=>U(F(e)))));(this.lastOutput instanceof HTMLHRElement||void 0===this.lastOutput)&&n[0]instanceof HTMLHRElement&&n.shift(),0!==n.length&&(this.lastOutput=n[n.length-1],this.output.appendChild(m("div",{children:n,classList:["w-100"]})),t&&this.scrollToBottom(),setTimeout((()=>{t&&this.scrollToBottom()})))}clear(){this.output.replaceChildren()}isScrolledToBottom(){const e=this.outputContainer;return e.scrollHeight-e.clientHeight<=e.scrollTop+1}scrollToBottom(){const e=this.outputContainer;e.scrollTop=e.scrollHeight}header(e,t){return M(F("["),F(e,t),F("]:"))}error(...e){this.write(this.header("error",["text-danger"]),...e)}warn(...e){this.write(this.header("warning",["text-warning"]),...e)}info(...e){this.write(this.header("info",["text-info"]),...e)}log(...e){this.write(...e)}debug(...e){this.write(this.header("debug",["text-subtle"]),...e)}}!function(e){e.bold=["bold"],e.italic=["italic"],e.text=["text"],e.embed=["embed"],e.invisable=["invisable"],e.spacer=[...e.invisable,"my-2"],e.lead=["lead","bold"],e.title=["fs-2",...e.lead],e.subtle=["text-subtle"],e.glitch=["text-glitch"],e.proper_noun=["proper-noun"],e.first_person=[...e.proper_noun,"first-person"],e.player=[...e.proper_noun,"player"],e.room=[...e.proper_noun,"room"],e.backpack=[...e.proper_noun,"backpack"],e.chest=[...e.proper_noun,"chest"],e.item=[...e.proper_noun,"item"],e.prop=[...e.proper_noun,"prop"],e.npc=[...e.proper_noun,"npc"],e.chapter=t=>F(B(F(M(j()),["w-100","px-4"]),F(t,[...e.title,"chapter-title"]),F(M(j()),["w-100","px-4"])),["d-flex","flex-row","w-100","justify-content-center","align-items-center","my-1","mt-4"]),e.center=e=>F(B(e),["d-flex","flex-row","w-100","justify-content-center","align-items-center"]),e.subtitle=t=>e.center(F(t,["fs-6",...e.italic]))}(G||(G={}));const Z=O.elementDescriptor,V={text:"Back",value:null,keybind:"Escape",keyicon:"ESC"};class K{constructor(e){this.listeners=new Set,this.errorHandler=e=>{throw e}}on(e){this.listeners.add(e)}off(e){this.listeners.delete(e)}once(e){const t=(...n)=>{this.off(t),e(...n)};this.on(t)}emit(...e){for(const t of this.listeners.values())try{t(...e)}catch(e){this.errorHandler(e)}}}class J{constructor(){this.events=new Map,this.broadcast=new K(((e,t)=>{})),this.errorHandler=e=>{throw e},this.error=this.channel("error",((...e)=>{}),!0),this.warn=this.channel("warning",((...e)=>{}),!0),this.info=this.channel("info",((...e)=>{}),!0),this.log=this.channel("log",((...e)=>{}),!0),this.debug=this.channel("debug",((...e)=>{}),!0)}channel(e,t,n=!1){const r=new K(t);r.errorHandler=e=>{this.errorHandler(e)},this.events.set(e,r),n||r.on(((...t)=>this.broadcast.emit(e,t)));const i=(...e)=>r.emit(...e);return i.channel=r,i.on=e=>(r.on(e),i),i.off=e=>(r.off(e),i),i.once=e=>(r.once(e),i),i}logErrorsToBuiltinConsole(){this.error.channel.on(((...e)=>console.error(e.map((e=>N(e))).join(" "))))}logToBuiltinConsole(){this.warn.channel.on(((...e)=>console.warn(e.map((e=>N(e))).join(" ")))),this.info.channel.on(((...e)=>console.info(e.map((e=>N(e))).join(" ")))),this.log.channel.on(((...e)=>console.log(e.map((e=>N(e))).join(" ")))),this.debug.channel.on(((...e)=>console.debug(e.map((e=>N(e))).join(" "))))}}class Y{constructor(e,t){this.indicies=e,this.table=t,this.indicies=e,this.table=t}export(){return{indicies:this.indicies,table:this.table}}toJSON(){return JSON.stringify(this.export())}forEach(e){for(const[t,n]of this.table)for(const[r,i]of n)e(i,t,r)}}class X{constructor(e){this.index=new Map,this.value=new Map,this.i=0}add(e){const t=this.i++;return this.set(e,t),t}has(e){return this.index.has(e)}of(e){return this.has(e)?this.index.get(e):this.add(e)}get(e){return this.value.get(e)}set(e,t){this.index.set(e,t),this.value.set(t,e)}serialize(){return Array.from(this.value.entries())}deserialize(e){for(const[t,n]of e)this.set(n,t)}object(){return Object.fromEntries(this.value)}*[Symbol.iterator](){for(const[e,t]of this.index)yield[e,t]}}class Q{constructor(e){if(this.cols=new Set,this.rows=new Map,e)for(const[t,n]of e)for(const[e,r]of n)this.set(t,e,r)}row(e){return new ee(this,e)}col(e){return new te(this,e)}cell(e,t){return new ne(this,e,t)}get(e,t){return this._row(e).get(t)}set(e,t,n){return this.createColumn(t),this._row(e).set(t,n),this}has(e,t){return!!this.rows.has(e)&&this.rows.get(e).has(t)}delete(e,t){return this._row(e).delete(t)}deleteRow(e){this.rows.delete(e)}clear(){this.rows.clear(),this.cols.clear()}rowKeys(){return this.rows.keys()}colKeys(){return this.cols.keys()}hasRow(e){return this.rows.has(e)}entries(){return Array.from(this.rows.entries()).map((([e,t])=>[e,Array.from(t.entries())]))}toObject(){const e={};return this.forEach(((t,n,r)=>{var i;const o=String(n),s=String(r);(e[o]=null!==(i=e[o])&&void 0!==i?i:{})[s]=t})),e}forEach(e){for(const[t,n]of this.rows)for(const n of this.cols)this.has(t,n)&&e(this.get(t,n),t,n)}serialize(){return new re(this).serialize()}clone(){return new Q(this)}*filter(e){for(const[t,n]of this[Symbol.iterator]())e(t)&&(yield[t,n])}*[Symbol.iterator](){for(const[e,t]of this.rows)yield[e,t.entries()]}createColumn(e){this.cols.add(e)}createRow(e){this.rows.has(e)||this.rows.set(e,new Map)}_row(e){return this.createRow(e),this.rows.get(e)}}class ee{constructor(e,t){this.table=e,this.r=t,this.table=e,this.r=t}col(e){return this.table.cell(this.r,e)}forEach(e){const t=this.r;for(const n of this.table.colKeys())e(this.table.get(t,n),t,n)}}class te{constructor(e,t){this.table=e,this.c=t,this.table=e,this.c=t}row(e){return this.table.cell(e,this.c)}forEach(e){const t=this.c;for(const n of this.table.rowKeys())e(this.table.get(n,t),n,t)}}class ne{constructor(e,t,n){this.table=e,this.r=t,this.c=n,this.table=e,this.r=t,this.c=n}value(){return this.table.get(this.r,this.c)}set(e){return this.table.set(this.r,this.c,e),this}has(){return this.table.has(this.r,this.c)}}class re{constructor(e){this.indicies=[new X,new X],this.store=new Q,e&&this.copy(e)}copy(e){e instanceof Q?e.forEach(((e,t,n)=>this.set(t,n,e))):e instanceof Y&&this.copySerialized(e)}copySerialized(e){this.indicies[0].deserialize(e.indicies[0]),this.indicies[1].deserialize(e.indicies[1]),e.forEach(((e,t,n)=>this.store.set(t,n,e)))}write(e){for(const[t,n]of this.indicies[0])for(const[r,i]of this.indicies[1])this.store.has(n,i)&&e.set(t,r,this.store.get(n,i))}set(e,t,n){const r=this.indicies[0].of(e),i=this.indicies[1].of(t);this.store.set(r,i,n)}get(e,t){const n=this.indicies[0].of(e),r=this.indicies[1].of(t);return this.store.get(n,r)}toObject(){return this.store.toObject()}rows(){return this.indicies[0].object()}cols(){return this.indicies[1].object()}serialize(){return new Y([this.indicies[0].serialize(),this.indicies[1].serialize()],this.store.entries())}}function ie(e){return P.array(P.tuple(P.number,e))}var oe=n(1354);function se(e){return(0,oe.MD5)(e).toString(oe.enc.Base64url)}function ae(e){const t=new Uint8Array(e);return window.crypto.getRandomValues(t),t}function ce(e=""){return e+se(new window.TextDecoder("utf-8").decode(ae(256)))}function ue(e,t){const n=t.length;return e.map((e=>{var r;return null!==(r=t[Math.abs(e%n)])&&void 0!==r?r:"_"})).join("")}function le(e=32){return function(e=32,t){return ue(Array.from(ae(e)),t)}(e,"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890")}class he{constructor(e,t){this.store=e,this.component=t,this.store=e,this.component=t}getSafe(e){return this.component.t.cast(this.get(e))}setSafe(e,t){return this.component.t.assert(t),this.set(e,t),this}get(e){if(!h(e))return this.store.get(e,this.component.hash)}set(e,t){return h(e)||this.store.set(e,this.component.hash,t),this}has(e){return!h(e)&&this.store.has(e,this.component.hash)}delete(e){return this.store.delete(e,this.component.hash)}ensure(e,t){return this.has(e)||this.set(e,t),this.get(e)}test(e){return!h(e)&&this.has(e)}get name(){return this.component.name}}class de extends he{enable(e){this.set(e,!0)}disable(e){this.delete(e)}is(e){return this.has(e)&&!0===this.get(e)}test(e){return this.is(e)}}class fe{constructor(e,t,n){this.name=e,this.hash=se(n||e),this.t=P.nullable(t)}is(e){return this.t===e}}fe.unknown=e=>new fe(e,P.unknown),fe.string=e=>new fe(e,P.string),fe.number=e=>new fe(e,P.number),fe.boolean=e=>new fe(e,P.boolean),fe.flag=e=>new fe(e,P.literal(!0)),fe.array=(e,t)=>new fe(t,P.array(e)),fe.record=(e,t,n)=>new fe(n,P.record(e,t)),fe.digest=(e,t)=>new fe(e,P.literal(!0),t);class pe{constructor(e,t){this.defaults=new Map,this.inheritsFrom=[],this.gamestate=e,this.name=t}flag(e){return this.defaults.set(e,!0),this}prop(e,t){return this.defaults.set(e,t),this}add(e,t){return e instanceof de?this.flag(e):this.prop(e,t)}digest(e){return fe.digest(this.name,e.map((e=>e.component.hash)).join())}extends(e){for(const[t,n]of e.defaults)this.defaults.set(t,n);return this.defaults.set(e.flag,!0),this.inheritsFrom.push(e,...e.inheritsFrom),this}compile(){const e=Array.from(this.defaults.keys()).filter((e=>e instanceof de)),t=Array.from(this.defaults.keys()).filter((e=>!(e instanceof de))),n=Object.fromEntries(t.map((e=>[e.component.name,e]))),r=new ve(this.gamestate,this.name,this.gamestate.bindFlag(this.digest([...e,...t])),n,new Set(e),new Set(t),this.defaults,this.inheritsFrom);return this.gamestate.addArchetype(r),r}}class me extends Error{}class ve{constructor(e,t,n,r,i,o,s,a){this.gamestate=e,this.name=t,this.flag=n,this.accessors=r,this.flags=i,this.props=o,this.defaults=s,this.defaults.set(n,!0),this.inheritsFrom=a}get(e){return this.accessors[e]}missing(e){return[this.flag,...Array.from(this.flags).filter((t=>!t.is(e))),...Array.from(this.props).filter((t=>!t.has(e)))].map((e=>e.component.name))}isDeep(e){for(const t of this.flags)if(!t.is(e))return!1;for(const t of this.props)if(!t.has(e))return!1;return!0}is(e){return!h(e)&&this.flag.is(e)}test(e){return this.is(e)}wrap(e){const t=this.gamestate.about(e),n={};for(const[t,r]of Object.entries(this.accessors))Object.defineProperty(n,t,{get:()=>r.get(e),set(t){r.set(e,t)}});return Object.defineProperty(n,"_id",{get:()=>e}),Object.assign(n,{valueOf:()=>e,toString:()=>t}),n}validate(e){if(this.flag.is(e)){const t=this.missing(e);if(t.length)throw new Error(`${e} is not ${this.name} (missing components: ${t.join(", ")})`)}}cast(e,t){if(!this.flag.is(e))throw new me(`failed to cast ${t} to ${this.name||this.gamestate.about(e)} (missing components: ${this.missing(e).join(", ")})`);return this.wrap(e)}construct(e){for(const[t,n]of this.defaults.entries())t.set(e,(0,v.cloneDeep)(n));return this.cast(e,`[new ${this.name}]`)}create(){const e=this.gamestate.entity();return this.construct(e)}components(){return Object.values(this.accessors)}}class ge extends Error{constructor(e,t,n){super(`invalid data for [${t},${n.name}]: ${e}`),this.entity=t,this.component=n}}class ye{constructor(){this.components=new Set,this._accessors=new Map,this._archetypes=new Map,this.store=new Q,this.name=this.bind(ye.Component.string("name"))}get accessors(){return this._accessors.values()}get archetypes(){return this._archetypes.values()}entity(){const e=ce(ye.entityPrefix);return new Set(this.store.rowKeys()).has(e)?this.entity():e}has(e){return this.store.hasRow(e)}delete(e){this.store.deleteRow(e)}bindFlag(e){this.components.add(e);const t=new de(this.store,e);return this._accessors.set(e.hash,t),t}bind(e){this.components.add(e);const t=new he(this.store,e);return this._accessors.set(e.hash,t),t}archetype(e){return new pe(this,e)}addArchetype(e){this._archetypes.set(e.flag.component.hash,e)}save(){return this.store.serialize().toJSON()}saveSubset(e){return this.filterTable(e).serialize().toJSON()}load(e){const t=ye.loader.load(e),n=new Q;t.write(n),ye.validate(n,this.components),t.write(this.store)}validate(){return ye.validate(this.store,this.components)}static validate(e,t){const n={entity:void 0,component:void 0},r=Array.from(t),i=new y;let o=!0;for(const t of r)for(const r of e.rowKeys())if(n.entity=r,n.component=t,e.has(r,t.hash)){const n=e.get(r,t.hash),s=i.writer(`${r}/${t.name}`,n);o=o&&t.t.validate(n,s)}if(!o)throw new Error(i.error())}entities(){return this.store.rowKeys()}flagComponents(){return Array.from(this.accessors).map((e=>e instanceof de?e:void 0)).filter((e=>e))}propertyComponents(){return Array.from(this.accessors).map((e=>e instanceof de?void 0:e)).filter((e=>e))}filter(e){return Array.from(this.entities()).filter(e)}inspect(e){const t={};for(const n of this.components)this.store.has(e,n.hash)&&(t[n.name]=this.store.get(e,n.hash));return t}reset(){this.store.clear()}about(e){return this.name.get(e)||e}filterTable(e){return new Q(this.store.filter(e))}}ye.loader=new class{constructor(e,t,n){this.t=P.object({indicies:P.tuple(ie(e),ie(t)),table:ie(ie(n))})}parse(e){const t=this.t.cast(e);return new Y(t.indicies,t.table)}load(e){if("string"==typeof e)return this.load(JSON.parse(e));const t=this.parse(e);return new re(t)}}(P.string,P.string,P.unknown),ye.Component=fe,ye.Archetype=ve,ye.entityPrefix="@";const _e=Symbol("NAME");class be{constructor(e){this[_e]=e}toString(){return String(this[_e])}}be.NAME=_e;class we{constructor(e,t){this.cache=new Map,this._get=e,this._validate=t}get(e){if(this.cache.has(e)){const t=this.cache.get(e);if(this._validate(e,t))return t}const t=this._get(e);if(this._validate(e,t)&&!h(t))return this.cache.set(e,t),t}clear(){this.cache.clear()}}const ke=(e,t,n=2,r=!1)=>{if(void 0===e||void 0===t)return 0;if(e===t)return 1;if(r||(e=e.toLowerCase(),t=t.toLowerCase()),e.length<n||t.length<n)return 0;const i=new Map;for(let t=0;t<e.length-(n-1);t++){const r=e.substr(t,n);i.set(r,i.has(r)?i.get(r)+1:1)}let o=0;for(let e=0;e<t.length-(n-1);e++){const r=t.substr(e,n),s=i.has(r)?i.get(r):0;s>0&&(i.set(r,s-1),o++)}return 2*o/(e.length+t.length-2*(n-1))};class Ce{constructor(e){this.options=Ce.defaultOptions(),this.events=new J,this.state=new ye,this.name=this.state.bind(ye.Component.string("name")),this.description=this.state.bind(ye.Component.string("description")),this.children=this.state.bind(ye.Component.array(P.string,"children")),this.parent=this.state.bind(ye.Component.string("parent")),this.reference=this.state.bind(ye.Component.string("reference")),this.token=this.state.bind(ye.Component.string("token")),this.direction=this.state.bind(ye.Component.string("direction")),this.locked=this.state.bind(ye.Component.boolean("locked")),this.tag=this.state.bind(ye.Component.string("tag")),this.encoded=this.state.bind(ye.Component.string("encoded")),this.decoder=this.state.bind(ye.Component.string("decoder")),this.mutation=this.state.bind(ye.Component.record(P.string,P.string,"mutation")),this.void=this.state.bindFlag(ye.Component.flag("void")),this.container=this.state.archetype("container").add(this.children,[]).compile(),this.child=this.state.archetype("child").add(this.parent,null).compile(),this.node=this.state.archetype("node").extends(this.container).extends(this.child).compile(),this.carryable=this.state.archetype("carryable").compile(),this.placeable=this.state.archetype("placeable").extends(this.container).compile(),this.player=this.state.archetype("player").extends(this.node).add(this.name).add(this.token).compile(),this.npc=this.state.archetype("npc").extends(this.node).add(this.name).compile(),this.room=this.state.archetype("room").extends(this.container).extends(this.placeable).add(this.name).add(this.description).compile(),this.door=this.state.archetype("door").extends(this.node).add(this.direction).add(this.locked).add(this.reference).compile(),this.object=this.state.archetype("object").extends(this.child).add(this.name).add(this.description).compile(),this.prop=this.state.archetype("prop").extends(this.object).compile(),this.item=this.state.archetype("item").extends(this.object).extends(this.carryable).compile(),this.chest=this.state.archetype("chest").extends(this.object).extends(this.placeable).compile(),this.backpack=this.state.archetype("backpack").extends(this.object).extends(this.placeable).extends(this.carryable).compile(),this.dynamic=[this.player],this.playerMove=this.events.channel("player-move",((e,t,n)=>{}),!0),this.playerTeleport=this.events.channel("player-teleport",((e,t,n)=>{}),!0),this.objectTeleported=this.events.channel("object-teleported",((e,t,n)=>{}),!0),this.objectDropped=this.events.channel("object-dropped",((e,t,n)=>{}),!0),this.objectTaken=this.events.channel("object-taken",((e,t,n)=>{}),!0),this.objectGiven=this.events.channel("object-given",((e,t,n)=>{}),!0),this.objectPut=this.events.channel("object-put",((e,t,n)=>{}),!0),this.objectTakenFrom=this.events.channel("object-taken-from",((e,t,n)=>{}),!0),this.eventEntityMove=this.events.channel("entity-move",((e,t,n)=>{})).on(((e,t,n)=>{if(this.player.is(e)||this.npc.is(e))if(h(t)||h(n))this.playerTeleport(e,t,n);else{const r=this.room.is(t),i=this.room.is(n);r&&i&&this.areRoomsConnectedAndUnlocked(t,n)?this.playerMove(e,t,n):this.playerTeleport(e,t,n)}else if(this.object.is(e)){const r=this.player.is(t),i=this.room.is(t),o=this.object.is(t),s=this.player.is(n),a=this.room.is(n),c=this.object.is(t);r?a?this.objectDropped(e,t,n):s?this.objectGiven(e,t,n):c&&this.objectPut(e,t,n):i?s?this.objectTaken(e,t,n):a&&this.objectTeleported(e,t,n):o?s&&this.objectTakenFrom(e,t,n):a&&this.objectTeleported(e,t,n)}})),this.eventRoomsLinked=this.events.channel("rooms-linked",((e,t,n,r)=>{})),this.eventDoorUnlock=this.events.channel("door-unlocked",((e,t,n)=>{})),this.eventDoorLock=this.events.channel("door-locked",((e,t,n)=>{})),this.send=this.events.channel("send",((e,t)=>{}),!0),this.interupt=this.events.channel("interupt",(e=>{}),!0),this.sessionStart=this.events.channel("session-start",(e=>{})),this.sessionEnd=this.events.channel("session-end",(e=>{})),this.whisper=this.events.channel("whisper",((e,t,n)=>{})),this.say=this.events.channel("say",((e,t,n)=>{})),this.change=this.events.channel("change",(()=>{}),!0),this.entityNameCache=new we((e=>{for(const t of this.state.entities())if(this.name.get(t)===e)return t}),((e,t)=>this.name.get(t)===e)),this.entityTagCache=new we((e=>{for(const t of this.state.entities())if(this.tag.get(t)===e)return t}),((e,t)=>this.tag.get(t)===e)),this.sessions=new we((e=>{for(const t of this.state.entities())if(this.token.get(t)===e)return t}),((e,t)=>this.token.get(t)===e)),this.error=this.events.error,this.warn=this.events.warn,this.info=this.events.info,this.log=this.events.log,this.debug=this.events.debug,e&&(this.options=s(this.options,e)),this.options.logEvents&&this.logEvents(),this.events.errorHandler=e=>{if(e instanceof Te)return this.error(e);throw e}}reset(){this.state.reset()}destroyEntity(e){if(void 0!==e){if(this.room.is(e))for(const t of this.doors(e))this.disconnectRooms(e,this.reference.get(t));void 0!==e&&(this.parent.has(e)&&this.unlinkFromParent(e),this.children.has(e)&&this.unlinkFromChildren(e),this.state.delete(e),this.logCommand("destroy",[e],void 0),this.touch())}}scrubEntity(e){if(this.children.has(e)&&this.children.set(e,this.children.get(e).filter((e=>!h(e)&&this.state.has(e)))),this.parent.has(e)){const t=this.parent.get(e);h(t)||this.state.has(t)||this.parent.set(e,void 0)}if(this.door.is(e)&&(this.state.has(this.parent.get(e))&&this.state.has(this.reference.get(e))||this.destroyEntity(e)),this.room.is(e))for(const t of this.doors(e))this.scrubEntity(t)}scrub(){for(const e of this.state.entities())this.scrubEntity(e)}createPlayer(e){const t=this.state.entity();return this.player.construct(t).name=e,this.logCommand("create-player",[e],t),this.moveToVoid(t),t}createNPC(e){const t=this.state.entity();return this.npc.construct(t).name=e,this.logCommand("create-npc",[e],t),this.moveToVoid(t),t}createProp(e,t){const n=this.state.entity(),r=this.prop.construct(n);return r.name=e,r.description=t,this.logCommand("create-prop",[e,t],n),this.moveToVoid(n),n}createItem(e,t){const n=this.state.entity(),r=this.item.construct(n);return r.name=e,r.description=t,this.logCommand("create-item",[e,t],n),this.moveToVoid(n),n}createChest(e,t){const n=this.state.entity(),r=this.chest.construct(n);return r.name=e,r.description=t,this.logCommand("create-chest",[e,t],n),this.moveToVoid(n),n}createBackpack(e,t){const n=this.state.entity(),r=this.backpack.construct(n);return r.name=e,r.description=t,this.logCommand("create-backpack",[e,t],n),this.moveToVoid(n),n}createRoom(e,t){const n=this.state.entity(),r=this.room.construct(n);return r.name=e,r.description=t,this.logCommand("create-room",[e,t],n),n}_constructDoor(e,t,n,r=!1){const i=this.state.entity(),o=this.door.construct(i);return this.move(i,e),o.direction=t,o.locked=r,o.reference=n,i}removeChild(e,t){const n=new Set(this.children.get(e));n.delete(t),this.children.set(e,Array.from(n))}unlinkFromParent(e){this.assert("target",e,[this.parent]);const t=this.parent.get(e);void 0!==t&&this.removeChild(t,e),this.parent.set(e,void 0)}unlinkFromChildren(e){this.assert("target",e,[this.children]);for(const t of this.children.get(e))this.parent.has(t)&&this.parent.set(t,void 0);this.children.set(e,[])}move(e,t){if(e===t)throw new Te(`Entity ${this.about(e)} cannot contain itself.`);this.assert("child",e,[this.parent]),this.assert("container",t,[this.children]);const n=this.parent.get(e);this.unlinkFromParent(e),this.parent.set(e,t),this.children.get(t).push(e),n!==t&&(this.eventEntityMove(e,n,t),this.touch())}mergeContainers(e,t){this.assert("target",e,[this.children]),this.assert("node",t,[this.children]);for(const n of this.children.get(t))this.move(n,e)}areNeighbors(e,t){return this.parent.get(e)===this.parent.get(t)}roomOf(e){return this.room.is(e)?e:this.parent.has(e)?this.roomOf(this.parent.get(e)):void 0}playerOf(e){return this.player.is(e)?e:this.parent.has(e)?this.playerOf(this.parent.get(e)):void 0}childrenOf(e){return this.children.get(e)||[]}parentOf(e){return this.parent.get(e)||void 0}sameRoom(e,t){return this.roomOf(e)===this.roomOf(t)}neighbors(e){this.assert("target",e,[this.parent]);const t=this.parent.get(e);return this.assert("target:parent",e,[this.children]),this.children.get(t).filter((t=>t!==e))}setDoor(e,t,n,r=!1){const i=this.getDoor(e,t)||this._constructDoor(e,t,n,r);return this.reference.set(i,n),this.locked.set(i,r),i}editDoor(e,t,n,r=!1){const i=this.setDoor(e,t,n,r);return this.logCommand("edit-door",[e,t,n,r],i),i}connectRooms(e,t,n,r=!1){const i=[void 0,void 0];return t.forward&&(i[0]=this.setDoor(e,t.forward,n,r)),t.backward&&(i[1]=this.setDoor(n,t.backward,e,r)),this.logCommand("connect-rooms",[e,t,n,r],i),i}disconnectRooms(e,t){this.doors(e).filter((e=>this.reference.get(e)===t)).forEach((e=>this.destroyEntity(e))),this.doors(t).filter((t=>this.reference.get(t)===e)).forEach((e=>this.destroyEntity(e))),this.logCommand("disconnect-rooms",[e,t],void 0)}doors(e){return this.room.cast(e).children.filter((e=>this.door.is(e)))}areRoomsConnectedAndUnlocked(e,t){const n=this.doors(e).find((e=>this.reference.get(e)===t));if(h(n))return!1;const r=this.doors(t).find((t=>this.reference.get(t)===e));return!h(n)&&!this.locked.get(n)&&!this.locked.get(r)}getDoor(e,t){return t=t.toLowerCase(),this.doors(e).find((e=>this.direction.get(e).toLowerCase()===t))}getAdjacentRoom(e,t){return this.reference.get(this.getDoor(e,t))}isAdjacentRoomLocked(e,t){return this.locked.get(this.getDoor(e,t))}take(e,t){this.assert("obj",e,[this.carryable]),this.assert("player",t,[this.player]),this.move(e,t)}isHolding(e,t){return this.children.get(t).includes(e)}drop(e,t){if(this.assert("obj",e,[this.carryable]),this.assert("player",t,[this.player]),!this.isHolding(e,t))throw new Te(`${this.about(t)} must be holding ${this.about(e)} to drop it.`);this.move(e,this.roomOf(t))}movePlayerDirection(e,t){this.assert("player",e,[this.player,this.parent]);const n=this.getDoor(this.parent.get(e),t),r=this.reference.get(n),i=this.locked.get(n);if(void 0===r)throw new Te(`${this.about(e)}: no target for ${t}`);if(!1!==i)throw new Te;this.move(e,r)}authenticate(e,t){const n=this.find(e);if(!n)return!1;const r=this.token.get(n);return r?r===t:(this.token.set(n,t),!0)}session(e){if(!h(e))return this.sessions.get(e)}canRead(e,t){if(!this.encoded.has(e))return!0;const n=this.encoded.get(e);return this.findIn(t,(e=>this.decoder.get(e)===n))}inVision(e,t){if(e===t)return!0;const n=this.playerOf(e);return this.roomOf(e)===this.roomOf(t)&&(!n||n===t)}readableChildObjects(e,t){var n,r;return null!==(r=null===(n=this.children.get(e))||void 0===n?void 0:n.filter((e=>this.object.is(e)&&this.canRead(e,t))))&&void 0!==r?r:[]}find(e){return this.entityNameCache.get(e)}findIn(e,t){var n;return null===(n=this.children.get(e))||void 0===n?void 0:n.find((n=>t(n)||!!this.children.has(n)&&this.findIn(e,t)))}get(e){return this.entityTagCache.get(e)}setTag(e,t){if(this.get(t))throw new Te(`tag "${t}" already in use`);this.tag.set(e,t)}filter(...e){return this.state.filter((t=>e.every((e=>e.test(t)))))}roots(...e){return this.state.filter((e=>h(this.parentOf(e))))}search(e,t=[]){return this.filter(this.name,...t).map((t=>({value:t,score:ke(this.name.get(t),e)}))).filter((e=>e.score>.25)).sort(((e,t)=>e.score-t.score)).map((e=>e.value))}flags(e){return this.state.flagComponents().filter((t=>t.is(e)))}properties(e){return this.state.propertyComponents().filter((t=>t.has(e)))}getArchetype(e){const t=[];for(const n of this.state.archetypes)n.is(e)&&t.push(n);return t.sort(((e,t)=>e.inheritsFrom.includes(t)?1:t.inheritsFrom.includes(e)?-1:0)),t[t.length-1]}getOwnProperties(e){const t=this.getArchetype(e);return this.properties(e).filter((e=>!t.props.has(e)))}getTypeString(e){const t=this.getArchetype(e),n=this.getOwnProperties(e);return n.length?`${t.name}{${n.map((e=>e.name)).join(", ")}}`:(null==t?void 0:t.name)||"fragment"}binEntities(e,t){const n=new Map(t.map((e=>[e,[]])));for(const r of e)for(const e of t)if(e.test(r)){n.get(e).push(r);break}return Array.from(n.values()).flat()}theVoid(){const e=this.filter(this.void,this.room),t=e.shift()||(()=>{const e=this.createRoom("The Void","");return this.void.enable(e),e})();for(;e.length;){const n=e.shift();this.mergeContainers(t,n),this.destroyEntity(n)}return t}moveToVoid(e){this.move(e,this.theVoid())}foreachPlayer(e){this.filter(this.player).forEach(e)}foreachPlayerIn(e,t){h(e)||(this.assert("container",e,[this.container]),this.children.get(e).filter((e=>this.player.is(e))).forEach(t))}command(e,...t){try{return e.call(this,...t)}catch(e){if(e instanceof Te||e instanceof me)return void this.error(e);throw e}}about(e){var t;return null!==(t=this.name.get(e))&&void 0!==t?t:e}print(e){var t;return F(null!==(t=this.name.get(e))&&void 0!==t?t:e,["fw-bold"])}has(e,t){return t.filter((t=>!t.test(e))).map((e=>e.name))}assert(e,t,n){if(null==t)throw new Re(e);const r=this.has(t,n);if(r.length)throw new Pe(e,this.about(t),r)}logCommand(e,t,n){const r=e=>this.resolveArg(e),i=D(", "),o=t.map(r).map((e=>[e,i])).flat().slice(0,-1);this.log(F(M(e,"(",...o,")",F("  ",["text-subtle"]),F(r(n),["text-subtle"])),["fst-italic"]))}logEvent(e,t){const n=D(", "),r=t.map((e=>this.resolveArg(e))).map((e=>[e,n])).flat().slice(0,-1);this.log(F(M(e,"<",...r,">"),["fst-italic"]))}logEvents(){this.events.broadcast.on(((e,t)=>{this.logEvent(e,t)}))}resolveArg(e){if(Array.isArray(e)){const t=D(", ");return M("[",...e.map((e=>this.resolveArg(e))).map((e=>[e,t])).flat().slice(0,-1),"]")}if("function"==typeof e||e instanceof Function)return D("[native]");if(void 0===e||void 0===e)return D("[undefined]");if(null===e)return D("[null]");if(e instanceof be)return M(D("["),F(D(e.toString()),["debug-object"]),D("]"));if("string"==typeof e){if(e.length>this.options.eventArgumentLength)return D("[...]");if(e.startsWith("@")){if(this.state.has(e)){if(this.name.has(e))return M("<",F(this.about(e),["debug-entity"]),">");const t=this.getArchetype(e);return M("<[",F((null==t?void 0:t.name)||"fragment",["debug-entity"]),D("]>"))}return M("<[",F("fragment",["text-danger"]),D("]>"))}return D(`"${e}"`)}return this.resolveArg(String(e))}touch(e=250){clearTimeout(this.broadcastChanges),this.broadcastChanges=setTimeout((()=>this.change()),e)}}var Se;Ce.defaultOptions=()=>({eventArgumentLength:100,logEvents:!0}),function(e){e.North="North",e.South="South",e.East="East",e.West="West",e.Up="Up",e.Down="Down"}(Se||(Se={}));class xe extends be{constructor(e,t,n){super(n=n||xe.getName(t,e)),this.backward=e,this.forward=t,this.name=n,this.name=n,this.forward=t.toLowerCase(),this.backward=e.toLowerCase()}static getName(e,t){return e&&t?`${t}_of`:`[${t}, ${e}]`}}const Ee={northof:new xe(Se.North,Se.South),southof:new xe(Se.South,Se.North),eastof:new xe(Se.East,Se.West),westof:new xe(Se.West,Se.East),above:new xe(Se.Up,Se.Down,"above"),below:new xe(Se.Down,Se.Up,"below")};class Te extends Error{}class Re extends Te{constructor(e){super(`target for "${e}" is undefined`),this.argName=e,this.argName=e}}class Pe extends Te{constructor(e,t,n){super(`target for "${e}" (${t}) is missing the fallowing components: [${n.join(", ")}]`),this.argName=e,this.targetName=t,this.missing=n,this.argName=e,this.targetName=t,this.missing=n}}function Ae(e){const t=new a,n={},r=S(e);return function e(i){return o=this,s=void 0,c=function*(){if(i>=r.length)return t.resolve(n);if(i<0)return t.resolve(null);const[o,s]=r[i],a=yield s(n);if(h(a))return e(i-1);n[o]=a,e(i+1)},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(n,r)}i((c=c.apply(o,s||[])).next())}));var o,s,a,c}(0),t.promise}class Oe{constructor(){this.name=Object.getPrototypeOf(this).constructor.name}}var Ie=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class De extends Oe{constructor(){super(...arguments),this.name="Console",this.file=()=>Ie(this,void 0,void 0,(function*(){return yield this.submenu("File",{text:"Export",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.server.downloadLevel("level")}))},{text:"New",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.confirm("Delete Everything?",(()=>this.server.load()))}))})})),this.rooms=()=>Ie(this,void 0,void 0,(function*(){return this.submenu("Edit Rooms",{text:"Create",value:()=>Ie(this,void 0,void 0,(function*(){return d(yield Ae({name:()=>this.getEntityName("Create Room","Name","name"),description:()=>this.ask("Create Room","Description","description")}),(e=>this.game.createRoom(e.name,e.description)))}))},{text:"Link",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.link()}))},{text:"Unlink",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.unlink()}))},{text:"Show List",value:()=>Ie(this,void 0,void 0,(function*(){this.server.divider(),this.listArchetype("Rooms:",this.game.room),this.server.divider()}))})})),this.objects=()=>Ie(this,void 0,void 0,(function*(){return yield this.submenu("Objects",{text:"Create",value:()=>Ie(this,void 0,void 0,(function*(){return d(yield Ae({type:()=>this.pick("Object Type",{text:"Prop",value:"prop"},{text:"Item",value:"item"},{text:"Chest",value:"chest"},{text:"Backpack",value:"backpack"},V),name:()=>this.getEntityName("Create Object","Name","name"),description:()=>this.ask("Create Object","Description","description")}),(e=>{switch(e.type){case"prop":this.game.command(this.game.createProp,e.name,e.description);break;case"item":this.game.command(this.game.createItem,e.name,e.description);break;case"chest":this.game.command(this.game.createChest,e.name,e.description);break;case"backpack":this.game.command(this.game.createBackpack,e.name,e.description)}}))}))},{text:"Move",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.move()}))},{text:"Mutation",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.mutation()}))},{text:"Show List",value:()=>Ie(this,void 0,void 0,(function*(){this.server.divider(),this.listArchetype("Props:",this.game.prop),this.listArchetype("Items:",this.game.item),this.listArchetype("Chest:",this.game.chest),this.listArchetype("Backpack:",this.game.backpack),this.server.divider()}))})})),this.npc=()=>Ie(this,void 0,void 0,(function*(){return this.submenu("NPC",{text:"Create",value:()=>Ie(this,void 0,void 0,(function*(){return d(yield Ae({name:()=>this.getEntityName("Create NPC","Name","name")}),(e=>this.game.createNPC(e.name)))}))})})),this.edit=()=>Ie(this,void 0,void 0,(function*(){return this.submenu("Edit",{text:"Rooms",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.rooms()}))},{text:"Objects",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.objects()}))},{text:"NPCs",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.npc()}))},{text:"Move",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.move()}))},{text:"Tags",value:()=>Ie(this,void 0,void 0,(function*(){return yield d(yield Ae({entity:()=>this.search("Set Tag","entity","name"),value:()=>this.ask("Set Tag","tag","tag value")}),(e=>{this.game.command(this.game.setTag,e.entity,e.value)}))}))},{text:"Rename",value:()=>Ie(this,void 0,void 0,(function*(){return yield d(yield Ae({target:()=>this.search("Rename","Target","target",[this.game.name]),name:()=>this.getEntityName("Rename","New Name","...")}),(e=>this.game.name.set(e.target,e.name)))}))},{text:"Delete",value:()=>Ie(this,void 0,void 0,(function*(){return yield d(yield Ae({target:()=>this.search("Delete","Target","target")}),(e=>this.game.destroyEntity(e.target)))}))},{text:"Encoding",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.encoding()}))})})),this.view=()=>Ie(this,void 0,void 0,(function*(){return this.submenu("View",{text:"Inspect",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.inspect(yield this.search())}))},{text:"List",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.listArchetype("Entities:")}))})}))}get game(){return this.server.game}load(e){this.console=e.console,this.server=e,e.loaded.once((()=>Ie(this,void 0,void 0,(function*(){for(this.server.divider(),this.server.log(F("MiniMUD server",G.title)),this.server.log(F('Press "C" to copy the link to this lobby. Share this link to invite your friends.')),this.server.log(F('Press "J" to join in a new tab.')),this.server.log(F('Press "S" to download a save.')),this.server.log(F('Press "L" to load a save.')),this.server.divider();;)yield this.mainMenu()}))))}mainMenu(){return Ie(this,void 0,void 0,(function*(){yield this.menu("Commands",{text:"Join",value:()=>Ie(this,void 0,void 0,(function*(){return window.open(this.server.url(),"_blank","noopener=true")}))},{text:"Copy Link",value:()=>Ie(this,void 0,void 0,(function*(){const e=this.server.url();this.server.log("Copied:",F(this.server.url(),["fst-italic"]),"to clipboard"),navigator.clipboard.writeText(e)})),keybind:"c"},{text:"Save",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.server.downloadSave("save")}))},{text:"Editor",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.submenu("Editor",{text:"File",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.file()}))},{text:"Edit",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.edit()}))},{text:"View",value:()=>Ie(this,void 0,void 0,(function*(){return yield this.view()}))})}))})}))}search(e="Search",t="Entity Name:",n="name",r=[]){return Ie(this,void 0,void 0,(function*(){const i=t=>this.pick(e,...t.map((e=>({text:this.game.name.get(e),value:e}))),V);let o=this.game.filter(this.game.name,...r);if(o.length<10)return i(o);const s=yield this.ask(e,t,n);if(h(s))return null;const a=this.game.find(s);if(a)return a;const c=i(this.game.search(s,r));return null===c?yield this.search():c}))}move(){return Ie(this,void 0,void 0,(function*(){return yield d(yield Ae({target:()=>this.search("Move","Target","target",[this.game.parent]),container:()=>this.search("Move","Container","container",[this.game.children])}),(e=>this.game.command(this.game.move,e.target,e.container)))}))}getEntityName(e,t,n){return Ie(this,void 0,void 0,(function*(){let r=yield this.ask(e,t,n);if(h(r))return null;for(;void 0!==this.game.find(r);)if(this.server.warn(`name ${r} is already in use`),r=yield this.ask(e,t,n),null===r)return null;return r}))}inspect(e){return Ie(this,void 0,void 0,(function*(){if(h(e))return;let t=this.game.getTypeString(e);this.server.divider(),this.server.log(F(M(`${t}: `,F(this.game.name.get(e),["fw-bold","fst-italic"])),["fs-5"]));for(const[t,n]of Object.entries(this.game.state.inspect(e)))void 0!==n&&("mutation"===t?this.server.log(` - ${t}: ${JSON.stringify(n)}`):this.server.log(` - ${t}:`,this.game.resolveArg(n)));if(this.game.room.is(e)){this.server.log(" - neighbors:");for(const t of this.game.doors(e))this.server.log(`   - ${this.game.direction.get(t)}:`,this.game.resolveArg(this.game.reference.get(t))," ",this.game.locked.get(t)?"(locked)":"(unlocked)")}this.server.divider()}))}encoding(){return Ie(this,void 0,void 0,(function*(){yield this.submenu("Encoding",{text:"Encode Entity",value:()=>Ie(this,void 0,void 0,(function*(){return yield d(yield Ae({entity:()=>this.search("Encode Entity","entity","name"),value:()=>this.ask("Encode Entity","key","same-as-decoder (leave blank to remove)")}),(e=>{h(e.value)||""===e.value?this.game.encoded.delete(e.entity):this.game.encoded.set(e.entity,e.value)}))}))},{text:"Make Decoder",value:()=>Ie(this,void 0,void 0,(function*(){return yield d(yield Ae({entity:()=>this.search("Make Decoder","entity","name"),value:()=>this.ask("Make Decoder","key","same-as-encoded (leave blank to remove)")}),(e=>{h(e.value)||""===e.value?this.game.decoder.delete(e.entity):this.game.decoder.set(e.entity,e.value)}))})),keybind:"d"})}))}mutation(){return Ie(this,void 0,void 0,(function*(){yield d(yield Ae({entity:()=>this.search("Mutation","Entity","name",[this.game.object]),key:()=>this.ask("Mutation","key","key"),value:()=>this.ask("Mutation","value","value")}),(e=>{e.key.includes(" ")?this.server.error("key cannot contain spaces"):this.game.mutation.ensure(e.entity,{})[e.key]=e.value}))}))}directions(e,t){return[{text:`${e} north of ${t}`,value:Ee.northof,keybind:"n"},{text:`${e} south of ${t}`,value:Ee.southof,keybind:"s"},{text:`${e} east of ${t}`,value:Ee.eastof,keybind:"e"},{text:`${e} west of ${t}`,value:Ee.westof,keybind:"w"},{text:`${e} above ${t}`,value:Ee.above,keybind:"a"},{text:`${e} below ${t}`,value:Ee.below,keybind:"b"}]}link(){return Ie(this,void 0,void 0,(function*(){yield d(yield Ae({left:()=>this.search("Link - First","First","target",[this.server.game.room]),right:()=>this.search("Link - Second","Second","target",[this.server.game.room]),relation:e=>this.pick("Relation",...this.directions(this.game.name.get(e.left),this.game.name.get(e.right)),V),locked:()=>this.pick("Locked",{text:"Yes",value:!0},{text:"No",value:!1},V)}),(e=>this.game.command(this.game.connectRooms,e.left,e.relation,e.right,e.locked)))}))}unlink(){return Ie(this,void 0,void 0,(function*(){yield d(yield Ae({left:()=>this.search("Unlink - First","First","target",[this.server.game.room]),right:()=>this.search("Unink - Second","Second","target",[this.server.game.room])}),(e=>this.game.command(this.game.disconnectRooms,e.left,e.right)))}))}ask(e,t,n){return Ie(this,void 0,void 0,(function*(){const r=yield this.console.ask(e,t,n);return h(r)?null:r}))}pick(e,...t){return this.console.menu(e,...t)}menu(e,...t){return Ie(this,void 0,void 0,(function*(){const n=yield this.console.menu(e,...t);h(n)||(yield n())}))}submenu(e,...t){return Ie(this,void 0,void 0,(function*(){let n=!1;for(;!n;)yield this.menu(e,...t,{text:"Back",value:()=>Ie(this,void 0,void 0,(function*(){n=!0})),keybind:"Escape",keyicon:"ESC"})}))}confirm(e,t){return Ie(this,void 0,void 0,(function*(){return yield d(yield Ae({confirm:()=>this.pick(e,{text:"Yes",value:!0},{text:"No",value:!1})}),(e=>{e.confirm&&t()}))}))}listArchetype(e,...t){this.server.log(e),this.game.filter(...t).forEach((e=>this.server.log(` - ${this.game.about(e)}`,F(this.game.getTypeString(e),["fst-italic","text-subtle"]))))}}var je=n(6);let Be=!0,ze=!0;function Me(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function Le(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);const o=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,o),i.apply(this,[e,o])};const o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function Fe(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Be=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Ne(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(ze=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Ue(){if("object"==typeof window){if(Be)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function We(e,t){ze&&console.warn(e+" is deprecated, please use "+t+" instead.")}function He(e){return"[object Object]"===Object.prototype.toString.call(e)}function $e(e){return He(e)?Object.keys(e).reduce((function(t,n){const r=He(e[n]),i=r?$e(e[n]):e[n],o=r&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[n]:i})}),{}):e}function Ge(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((r=>{r.endsWith("Id")?Ge(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((t=>{Ge(e,e.get(t),n)}))})))}function qe(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((n=>{n.type===r&&n.trackId===t.id&&Ge(e,n,i)}))})),i}const Ze=Ue;function Ve(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"==typeof r.ideal?(e[i("min",n)]=r.ideal,t.optional.push(e),e={},e[i("max",n)]=r.ideal,t.optional.push(e)):(e[i("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach((e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const s=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let s=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!s&&n.length&&t.includes("back")&&(s=n[n.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=r(e.video),Ze("chrome: "+JSON.stringify(e)),i(e)}))}e.video=r(e.video)}return Ze("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{r&&r(o(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return i(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(o(e))))))}}}function Ke(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function Je(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Ye(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const i=new Event("track");i.track=n.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)})),t.stream.getTracks().forEach((n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Le(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function Xe(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Qe(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,r]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const i=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const r=function(e){n(o(i(e)))};return t.apply(this,[r,e])}return new Promise(((e,n)=>{t.apply(this,[function(t){e(o(i(t)))},n])})).then(n,r)}}function et(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>qe(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Le(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>qe(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach((n=>{n.track===e&&(t?r=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?r=!0:n=t),t.track===e))),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function tt(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{const t=this.getSenders().find((t=>t.track===e));if(t)throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),i.apply(this,arguments)}}function nt(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return tt(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{const t=this.getSenders().find((t=>t.track===e));if(t)throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const i=this.getSenders().find((e=>e.track===t));if(i)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>o(this,e)))}};e.RTCPeerConnection.prototype[t]=r[t]}));const s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),s.apply(this,arguments)):s.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=a.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function rt(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}))}function it(e,t){Le(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var ot=n(2539),st=n.n(ot);function at(e){const t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((e=>Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e))))}}function ct(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function ut(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const n=new Event("enabled");n.enabled=e,this.dispatchEvent(n)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const n=st()(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){let n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((e=>{if(e&&(e.urls||e.url)){let t=e.urls||e.url;e.url&&!e.urls&&We("RTCIceServer.url","RTCIceServer.urls");const r="string"==typeof t;return r&&(t=[t]),t=t.filter((e=>{if(0===e.indexOf("stun:"))return!1;const t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=r?t[0]:t,!!t.length}}))}(e.iceServers,t.version),Ue("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype}function lt(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}function ht(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){We("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function dt(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function ft(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function pt(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,o]=arguments;return r.apply(this,[e||null]).then((e=>{if(t.version<53&&!i)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(i,o)}}function mt(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function vt(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Le(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function gt(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){We("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function yt(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function _t(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return r})}function bt(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function wt(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function kt(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function Ct(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e,...n){return n&&n.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function St(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function xt(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};let a=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=a,a=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=a,a=function(e,t,n){const r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=a}function Et(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(Tt(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function Tt(e){return e&&void 0!==e.video?Object.assign({},e,{video:$e(e.video)}):e}function Rt(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(We("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function Pt(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function At(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}function Ot(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var It=n(7539),Dt=n.n(It);function jt(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),r=Dt().parseCandidate(e.candidate),i=Object.assign(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Le(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function Bt(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=Dt().splitSections(e.sdp);return t.shift(),t.some((e=>{const t=Dt().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),r=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const i=Dt().matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r}(arguments[0],e);let i;i=0===n&&0===r?Number.POSITIVE_INFINITY:0===n||0===r?Math.max(n,r):Math.min(n,r);const o={};Object.defineProperty(o,"maxMessageSize",{get:()=>i}),this._sctp=o}return n.apply(this,arguments)}}function zt(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},Le(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function Mt(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function Lt(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function Ft(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}const Nt=function({window:n}={},s={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const a=Ue,c=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=Me(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=Me(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=Me(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=Me(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(n),u={browserDetails:c,commonShim:o,extractVersion:Me,disableLog:Fe,disableWarnings:Ne};switch(c.browser){case"chrome":if(!e||!rt||!s.shimChrome)return a("Chrome shim is not included in this adapter release."),u;if(null===c.version)return a("Chrome shim can not determine version, not shimming."),u;a("adapter.js shimming chrome."),u.browserShim=e,Ft(n,c),Ve(n,c),Je(n),rt(n,c),Ye(n),nt(n,c),Xe(n),Qe(n),et(n),it(n,c),jt(n),Mt(n),Bt(n,c),zt(n),Lt(n,c);break;case"firefox":if(!r||!pt||!s.shimFirefox)return a("Firefox shim is not included in this adapter release."),u;a("adapter.js shimming firefox."),u.browserShim=r,Ft(n,c),ht(n,c),pt(n,c),ft(n),gt(n),mt(n),vt(n),yt(n),_t(n),bt(n),wt(n),kt(n),jt(n),Mt(n),Bt(n,c),zt(n);break;case"edge":if(!t||!ut||!s.shimEdge)return a("MS edge shim is not included in this adapter release."),u;a("adapter.js shimming edge."),u.browserShim=t,at(n),ct(n),ut(n,c),lt(n),Bt(n,c),zt(n);break;case"safari":if(!i||!s.shimSafari)return a("Safari shim is not included in this adapter release."),u;a("adapter.js shimming safari."),u.browserShim=i,Ft(n,c),Rt(n),At(n),xt(n),Ct(n),St(n),Pt(n),Et(n),Ot(n),jt(n),Bt(n,c),zt(n),Lt(n,c);break;default:a("Unsupported browser!")}return u}({window:"undefined"==typeof window?void 0:window}),Ut=Nt;function Wt(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var Ht=Ut.default||Ut,$t=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},e.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},e.prototype.getBrowser=function(){return Ht.browserDetails.browser},e.prototype.getVersion=function(){return Ht.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var e,t=this.getBrowser(),n=Ht.browserDetails.version||0;if("chrome"===t&&n<this.minChromeVersion)return!1;if("firefox"===t&&n>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var r=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),r=!0}catch(e){}finally{e&&e.close()}return r},e.prototype.toString=function(){return"Supports:\n    browser:".concat(this.getBrowser(),"\n    version:").concat(this.getVersion(),"\n    isIOS:").concat(this.isIOS,"\n    isWebRTCSupported:").concat(this.isWebRTCSupported(),"\n    isBrowserSupported:").concat(this.isBrowserSupported(),"\n    isUnifiedPlanSupported:").concat(this.isUnifiedPlanSupported())},e}()),Gt={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"},qt=new(function(){function e(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=Gt,this.browser=$t.getBrowser(),this.browserVersion=$t.getVersion(),this.supports=function(){var e,t={browser:$t.isBrowserSupported(),webRTC:$t.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{e=new RTCPeerConnection(Gt),t.audioVideo=!0;var n=void 0;try{n=e.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!$t.isIOS}catch(e){}}catch(e){}finally{n&&n.close()}}catch(e){}finally{e&&e.close()}return t}(),this.pack=je.pack,this.unpack=je.unpack,this._dataCount=1}return e.prototype.noop=function(){},e.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},e.prototype.chunk=function(e){for(var t=[],n=e.size,r=Math.ceil(n/qt.chunkedMTU),i=0,o=0;o<n;){var s=Math.min(n,o+qt.chunkedMTU),a=e.slice(o,s),c={__peerData:this._dataCount,n:i,data:a,total:r};t.push(c),o=s,i++}return this._dataCount++,t},e.prototype.blobToArrayBuffer=function(e,t){var n=new FileReader;return n.onload=function(e){e.target&&t(e.target.result)},n.readAsArrayBuffer(e),n},e.prototype.binaryStringToArrayBuffer=function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},e.prototype.randomToken=function(){return Math.random().toString(36).slice(2)},e.prototype.isSecure=function(){return"https:"===location.protocol},e}());Wt({},"Peer",(()=>Hn),(e=>Hn=e));var Zt,Vt=Object.prototype.hasOwnProperty,Kt="~";function Jt(){}function Yt(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function Xt(e,t,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new Yt(n,r||e,i),s=Kt?Kt+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],o]:e._events[s].push(o):(e._events[s]=o,e._eventsCount++),e}function Qt(e,t){0==--e._eventsCount?e._events=new Jt:delete e._events[t]}function en(){this._events=new Jt,this._eventsCount=0}Object.create&&(Jt.prototype=Object.create(null),(new Jt).__proto__||(Kt=!1)),en.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)Vt.call(e,t)&&n.push(Kt?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},en.prototype.listeners=function(e){var t=Kt?Kt+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,o=new Array(i);r<i;r++)o[r]=n[r].fn;return o},en.prototype.listenerCount=function(e){var t=Kt?Kt+e:e,n=this._events[t];return n?n.fn?1:n.length:0},en.prototype.emit=function(e,t,n,r,i,o){var s=Kt?Kt+e:e;if(!this._events[s])return!1;var a,c,u=this._events[s],l=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,r),!0;case 5:return u.fn.call(u.context,t,n,r,i),!0;case 6:return u.fn.call(u.context,t,n,r,i,o),!0}for(c=1,a=new Array(l-1);c<l;c++)a[c-1]=arguments[c];u.fn.apply(u.context,a)}else{var h,d=u.length;for(c=0;c<d;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),l){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;case 4:u[c].fn.call(u[c].context,t,n,r);break;default:if(!a)for(h=1,a=new Array(l-1);h<l;h++)a[h-1]=arguments[h];u[c].fn.apply(u[c].context,a)}}return!0},en.prototype.on=function(e,t,n){return Xt(this,e,t,n,!1)},en.prototype.once=function(e,t,n){return Xt(this,e,t,n,!0)},en.prototype.removeListener=function(e,t,n,r){var i=Kt?Kt+e:e;if(!this._events[i])return this;if(!t)return Qt(this,i),this;var o=this._events[i];if(o.fn)o.fn!==t||r&&!o.once||n&&o.context!==n||Qt(this,i);else{for(var s=0,a=[],c=o.length;s<c;s++)(o[s].fn!==t||r&&!o[s].once||n&&o[s].context!==n)&&a.push(o[s]);a.length?this._events[i]=1===a.length?a[0]:a:Qt(this,i)}return this},en.prototype.removeAllListeners=function(e){var t;return e?(t=Kt?Kt+e:e,this._events[t]&&Qt(this,t)):(this._events=new Jt,this._eventsCount=0),this},en.prototype.off=en.prototype.removeListener,en.prototype.addListener=en.prototype.on,en.prefixed=Kt,en.EventEmitter=en,Zt=en;var tn={};Wt(tn,"LogLevel",(()=>nn),(e=>nn=e)),Wt(tn,"default",(()=>dn),(e=>dn=e));var nn,rn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},on=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};!function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"}(nn||(nn={}));var sn,an,cn,un,ln,hn,dn=new(function(){function e(){this._logLevel=nn.Disabled}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=nn.All&&this._print.apply(this,on([nn.All],rn(e),!1))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=nn.Warnings&&this._print.apply(this,on([nn.Warnings],rn(e),!1))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=nn.Errors&&this._print.apply(this,on([nn.Errors],rn(e),!1))},e.prototype.setLogFunction=function(e){this._print=e},e.prototype._print=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=on(["PeerJS: "],rn(t),!1);for(var i in r)r[i]instanceof Error&&(r[i]="("+r[i].name+") "+r[i].message);e>=nn.All?console.log.apply(console,on([],rn(r),!1)):e>=nn.Warnings?console.warn.apply(console,on(["WARNING"],rn(r),!1)):e>=nn.Errors&&console.error.apply(console,on(["ERROR"],rn(r),!1))},e}()),fn={};Wt(fn,"Socket",(()=>vn),(e=>vn=e)),function(e){e.Data="data",e.Media="media"}(sn||(sn={})),function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"}(an||(an={})),function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"}(cn||(cn={})),function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"}(un||(un={})),function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"}(ln||(ln={})),hn=JSON.parse('{"name":"peerjs","version":"1.4.7","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz Stckler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","Soren Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","types":"dist/types.d.ts","engines":{"node":">= 10"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"cover 99%, not dead"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"cover 99%, not dead"},"source":"lib/global.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"mocha -r ts-node/register -r jsdom-global/register test/**/*.ts","format":"prettier --write .","semantic-release":"semantic-release"},"devDependencies":{"@parcel/config-default":"^2.5.0","@parcel/packager-ts":"^2.5.0","@parcel/transformer-typescript-tsc":"^2.5.0","@parcel/transformer-typescript-types":"^2.5.0","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@types/chai":"^4.3.0","@types/mocha":"^9.1.0","@types/node":"^17.0.18","chai":"^4.3.6","git-authors-cli":"^1.0.40","jsdom":"^19.0.0","jsdom-global":"^3.0.2","mocha":"^9.2.0","mock-socket":"8.0.5","parcel":"^2.5.0","parcel-transformer-tsc-sourcemaps":"^1.0.2","prettier":"^2.6.2","semantic-release":"^19.0.2","standard":"^16.0.4","ts-node":"^10.5.0","typescript":"^4.5.5"},"dependencies":{"@swc/helpers":"^0.3.13","eventemitter3":"^4.0.7","peerjs-js-binarypack":"1.0.1","webrtc-adapter":"^7.7.1"}}');var pn,mn=(pn=function(e,t){return(pn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}pn(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),vn=function(e){function t(t,n,r,i,o,s){void 0===s&&(s=5e3);var a=e.call(this)||this;a.pingInterval=s,a._disconnected=!0,a._messagesQueue=[];var c=t?"wss://":"ws://";return a._baseUrl=c+n+":"+r+i+"peerjs?key="+o,a}return mn(t,e),t.prototype.start=function(e,t){var n=this;this._id=e;var r="".concat(this._baseUrl,"&id=").concat(e,"&token=").concat(t);!this._socket&&this._disconnected&&(this._socket=new WebSocket(r+"&version="+hn.version),this._disconnected=!1,this._socket.onmessage=function(e){var t;try{t=JSON.parse(e.data),tn.default.log("Server message received:",t)}catch(t){return void tn.default.log("Invalid server message",e.data)}n.emit(un.Message,t)},this._socket.onclose=function(e){n._disconnected||(tn.default.log("Socket closed.",e),n._cleanup(),n._disconnected=!0,n.emit(un.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),tn.default.log("Socket open"),n._scheduleHeartbeat())})},t.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout((function(){e._sendHeartbeat()}),this.pingInterval)},t.prototype._sendHeartbeat=function(){if(this._wsOpen()){var e=JSON.stringify({type:ln.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}else tn.default.log("Cannot send heartbeat, because socket closed")},t.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},t.prototype._sendQueuedMessages=function(){var e,t,n=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}([],function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}(this._messagesQueue),!1);this._messagesQueue=[];try{for(var r=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),i=r.next();!i.done;i=r.next()){var o=i.value;this.send(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.send=function(e){if(!this._disconnected)if(this._id)if(e.type){if(this._wsOpen()){var t=JSON.stringify(e);this._socket.send(t)}}else this.emit(un.Error,"Invalid message");else this._messagesQueue.push(e)},t.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},t.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},t}(Zt.EventEmitter),gn={};Wt(gn,"MediaConnection",(()=>Rn),(e=>Rn=e));var yn={};Wt(yn,"Negotiator",(()=>kn),(e=>kn=e));var _n=function(){return _n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},_n.apply(this,arguments)},bn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},wn=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},kn=function(){function e(e){this.connection=e}return e.prototype.startConnection=function(e){var t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===sn.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){if(this.connection.type===sn.Data){var n=this.connection,r={ordered:!!e.reliable},i=t.createDataChannel(n.label,r);n.initialize(i)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},e.prototype._startPeerConnection=function(){tn.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},e.prototype._setupListeners=function(e){var t=this,n=this.connection.peer,r=this.connection.connectionId,i=this.connection.type,o=this.connection.provider;tn.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(tn.default.log("Received ICE candidates for ".concat(n,":"),e.candidate),o.socket.send({type:ln.Candidate,payload:{candidate:e.candidate,type:i,connectionId:r},dst:n}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":tn.default.log("iceConnectionState is failed, closing connections to "+n),t.connection.emit("error",new Error("Negotiation of connection to "+n+" failed.")),t.connection.close();break;case"closed":tn.default.log("iceConnectionState is closed, closing connections to "+n),t.connection.emit("error",new Error("Connection to "+n+" closed.")),t.connection.close();break;case"disconnected":tn.default.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=qt.noop}t.connection.emit("iceStateChanged",e.iceConnectionState)},tn.default.log("Listening for data channel"),e.ondatachannel=function(e){tn.default.log("Received data channel");var t=e.channel;o.getConnection(n,r).initialize(t)},tn.default.log("Listening for remote stream"),e.ontrack=function(e){tn.default.log("Received remote stream");var i=e.streams[0],s=o.getConnection(n,r);if(s.type===sn.Media){var a=s;t._addStreamToMediaConnection(i,a)}}},e.prototype.cleanup=function(){tn.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var t="closed"!==e.signalingState,n=!1;if(this.connection.type===sn.Data){var r=this.connection.dataChannel;r&&(n=!!r.readyState&&"closed"!==r.readyState)}(t||n)&&e.close()}},e.prototype._makeOffer=function(){return bn(this,void 0,Promise,(function(){var e,t,n,r,i,o,s;return wn(this,(function(a){switch(a.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,a.label=1;case 1:return a.trys.push([1,7,,8]),[4,e.createOffer(this.connection.options.constraints)];case 2:n=a.sent(),tn.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),a.label=3;case 3:return a.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return a.sent(),tn.default.log("Set localDescription:",n,"for:".concat(this.connection.peer)),r={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:qt.browser},this.connection.type===sn.Data&&(i=this.connection,r=_n(_n({},r),{label:i.label,reliable:i.reliable,serialization:i.serialization})),t.socket.send({type:ln.Offer,payload:r,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(o=a.sent())&&(t.emitError(an.WebRTC,o),tn.default.log("Failed to setLocalDescription, ",o)),[3,6];case 6:return[3,8];case 7:return s=a.sent(),t.emitError(an.WebRTC,s),tn.default.log("Failed to createOffer, ",s),[3,8];case 8:return[2]}}))}))},e.prototype._makeAnswer=function(){return bn(this,void 0,Promise,(function(){var e,t,n,r,i;return wn(this,(function(o){switch(o.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:n=o.sent(),tn.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return o.sent(),tn.default.log("Set localDescription:",n,"for:".concat(this.connection.peer)),t.socket.send({type:ln.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,browser:qt.browser},dst:this.connection.peer}),[3,6];case 5:return r=o.sent(),t.emitError(an.WebRTC,r),tn.default.log("Failed to setLocalDescription, ",r),[3,6];case 6:return[3,8];case 7:return i=o.sent(),t.emitError(an.WebRTC,i),tn.default.log("Failed to create answer, ",i),[3,8];case 8:return[2]}}))}))},e.prototype.handleSDP=function(e,t){return bn(this,void 0,Promise,(function(){var n,r,i,o;return wn(this,(function(s){switch(s.label){case 0:t=new RTCSessionDescription(t),n=this.connection.peerConnection,r=this.connection.provider,tn.default.log("Setting remote description",t),i=this,s.label=1;case 1:return s.trys.push([1,5,,6]),[4,n.setRemoteDescription(t)];case 2:return s.sent(),tn.default.log("Set remoteDescription:".concat(e," for:").concat(this.connection.peer)),"OFFER"!==e?[3,4]:[4,i._makeAnswer()];case 3:s.sent(),s.label=4;case 4:return[3,6];case 5:return o=s.sent(),r.emitError(an.WebRTC,o),tn.default.log("Failed to setRemoteDescription, ",o),[3,6];case 6:return[2]}}))}))},e.prototype.handleCandidate=function(e){return bn(this,void 0,Promise,(function(){var t,n,r,i,o,s;return wn(this,(function(a){switch(a.label){case 0:tn.default.log("handleCandidate:",e),t=e.candidate,n=e.sdpMLineIndex,r=e.sdpMid,i=this.connection.peerConnection,o=this.connection.provider,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,i.addIceCandidate(new RTCIceCandidate({sdpMid:r,sdpMLineIndex:n,candidate:t}))];case 2:return a.sent(),tn.default.log("Added ICE candidate for:".concat(this.connection.peer)),[3,4];case 3:return s=a.sent(),o.emitError(an.WebRTC,s),tn.default.log("Failed to handleCandidate, ",s),[3,4];case 4:return[2]}}))}))},e.prototype._addTracksToConnection=function(e,t){if(tn.default.log("add tracks from stream ".concat(e.id," to peer connection")),!t.addTrack)return tn.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach((function(n){t.addTrack(n,e)}))},e.prototype._addStreamToMediaConnection=function(e,t){tn.default.log("add stream ".concat(e.id," to media connection ").concat(t.connectionId)),t.addStream(e)},e}(),Cn={};Wt(Cn,"BaseConnection",(()=>xn),(e=>xn=e));var Sn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xn=function(e){function t(t,n,r){var i=e.call(this)||this;return i.peer=t,i.provider=n,i.options=r,i._open=!1,i.metadata=r.metadata,i}return Sn(t,e),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),t}(Zt.EventEmitter),En=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tn=function(){return Tn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Tn.apply(this,arguments)},Rn=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o._localStream=o.options._stream,o.connectionId=o.options.connectionId||t.ID_PREFIX+qt.randomToken(),o._negotiator=new yn.Negotiator(o),o._localStream&&o._negotiator.startConnection({_stream:o._localStream,originator:!0}),o}return En(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return sn.Media},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localStream",{get:function(){return this._localStream},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!1,configurable:!0}),t.prototype.addStream=function(t){tn.default.log("Receiving stream",t),this._remoteStream=t,e.prototype.emit.call(this,"stream",t)},t.prototype.handleMessage=function(e){var t=e.type,n=e.payload;switch(e.type){case ln.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case ln.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:tn.default.warn("Unrecognized message type:".concat(t," from peer:").concat(this.peer))}},t.prototype.answer=function(e,t){var n,r;if(void 0===t&&(t={}),this._localStream)tn.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(Tn(Tn({},this.options._payload),{_stream:e}));var i=this.provider._getMessages(this.connectionId);try{for(var o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),s=o.next();!s.done;s=o.next()){var a=s.value;this.handleMessage(a)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}this._open=!0}},t.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,e.prototype.emit.call(this,"close"))},t.ID_PREFIX="mc_",t}(Cn.BaseConnection),Pn={};Wt(Pn,"DataConnection",(()=>jn),(e=>jn=e));var An={};Wt(An,"EncodingQueue",(()=>In),(e=>In=e));var On=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),In=function(e){function t(){var t=e.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(e){t._processing=!1,e.target&&t.emit("done",e.target.result),t.doNextTask()},t.fileReader.onerror=function(e){tn.default.error("EncodingQueue error:",e),t._processing=!1,t.destroy(),t.emit("error",e)},t}return On(t,e),Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.queue.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return this._processing},enumerable:!1,configurable:!0}),t.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},t.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},t.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},t}(Zt.EventEmitter),Dn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jn=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o.stringify=JSON.stringify,o.parse=JSON.parse,o._buffer=[],o._bufferSize=0,o._buffering=!1,o._chunkedData={},o._encodingQueue=new An.EncodingQueue,o.connectionId=o.options.connectionId||t.ID_PREFIX+qt.randomToken(),o.label=o.options.label||o.connectionId,o.serialization=o.options.serialization||cn.Binary,o.reliable=!!o.options.reliable,o._encodingQueue.on("done",(function(e){o._bufferedSend(e)})),o._encodingQueue.on("error",(function(){tn.default.error("DC#".concat(o.connectionId,": Error occured in encoding from blob to arraybuffer, close DC")),o.close()})),o._negotiator=new yn.Negotiator(o),o._negotiator.startConnection(o.options._payload||{originator:!0}),o}return Dn(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return sn.Data},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},t.prototype._configureDataChannel=function(){var e=this;qt.supports.binaryBlob&&!qt.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){tn.default.log("DC#".concat(e.connectionId," dc connection success")),e._open=!0,e.emit("open")},this.dataChannel.onmessage=function(t){tn.default.log("DC#".concat(e.connectionId," dc onmessage:"),t.data),e._handleDataMessage(t)},this.dataChannel.onclose=function(){tn.default.log("DC#".concat(e.connectionId," dc closed for:"),e.peer),e.close()}},t.prototype._handleDataMessage=function(t){var n=this,r=t.data,i=r.constructor,o=r;if(this.serialization===cn.Binary||this.serialization===cn.BinaryUTF8){if(i===Blob)return void qt.blobToArrayBuffer(r,(function(e){var t=qt.unpack(e);n.emit("data",t)}));if(i===ArrayBuffer)o=qt.unpack(r);else if(i===String){var s=qt.binaryStringToArrayBuffer(r);o=qt.unpack(s)}}else this.serialization===cn.JSON&&(o=this.parse(r));o.__peerData?this._handleChunk(o):e.prototype.emit.call(this,"data",o)},t.prototype._handleChunk=function(e){var t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=e.data,n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];var r=new Blob(n.data);this._handleDataMessage({data:r})}},t.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,e.prototype.emit.call(this,"close"))},t.prototype.send=function(t,n){if(this.open)if(this.serialization===cn.JSON)this._bufferedSend(this.stringify(t));else if(this.serialization===cn.Binary||this.serialization===cn.BinaryUTF8){var r=qt.pack(t);if(!n&&r.size>qt.chunkedMTU)return void this._sendChunks(r);qt.supports.binaryBlob?this._bufferedSend(r):this._encodingQueue.enque(r)}else this._bufferedSend(t);else e.prototype.emit.call(this,"error",new Error("Connection is not open. You should listen for the `open` event before sending messages."))},t.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},t.prototype._trySend=function(e){var n=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>t.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((function(){n._buffering=!1,n._tryBuffer()}),50),!1;try{this.dataChannel.send(e)}catch(e){return tn.default.error("DC#:".concat(this.connectionId," Error when sending:"),e),this._buffering=!0,this.close(),!1}return!0},t.prototype._tryBuffer=function(){if(this.open&&0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},t.prototype._sendChunks=function(e){var t,n,r=qt.chunk(e);tn.default.log("DC#".concat(this.connectionId," Try to send ").concat(r.length," chunks..."));try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(r),o=i.next();!o.done;o=i.next()){var s=o.value;this.send(s,!0)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case ln.Answer:this._negotiator.handleSDP(e.type,t.sdp);break;case ln.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:tn.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},t.ID_PREFIX="dc_",t.MAX_BUFFERED_AMOUNT=8388608,t}(Cn.BaseConnection),Bn={};Wt(Bn,"API",(()=>Ln),(e=>Ln=e));var zn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Mn=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Ln=function(){function e(e){this._options=e}return e.prototype._buildRequest=function(e){var t=this._options.secure?"https":"http",n=this._options,r=n.host,i=n.port,o=n.path,s=n.key,a=new URL("".concat(t,"://").concat(r,":").concat(i).concat(o).concat(s,"/").concat(e));return a.searchParams.set("ts","".concat(Date.now()).concat(Math.random())),a.searchParams.set("version",hn.version),fetch(a.href,{referrerPolicy:this._options.referrerPolicy})},e.prototype.retrieveId=function(){return zn(this,void 0,Promise,(function(){var e,t,n;return Mn(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this._buildRequest("id")];case 1:if(200!==(e=r.sent()).status)throw new Error("Error. Status:".concat(e.status));return[2,e.text()];case 2:throw t=r.sent(),tn.default.error("Error retrieving ID",t),n="","/"===this._options.path&&this._options.host!==qt.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+n);case 3:return[2]}}))}))},e.prototype.listAllPeers=function(){return zn(this,void 0,Promise,(function(){var e,t,n;return Mn(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this._buildRequest("peers")];case 1:if(200!==(e=r.sent()).status){if(401===e.status)throw"",t=this._options.host===qt.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+t);throw new Error("Error. Status:".concat(e.status))}return[2,e.json()];case 2:throw n=r.sent(),tn.default.error("Error retrieving list peers",n),new Error("Could not get list peers from the server."+n);case 3:return[2]}}))}))},e}(),Fn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nn=function(){return Nn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Nn.apply(this,arguments)},Un=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Wn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},Hn=function(e){function t(n,r){var i,o=e.call(this)||this;return o._id=null,o._lastServerId=null,o._destroyed=!1,o._disconnected=!1,o._open=!1,o._connections=new Map,o._lostMessages=new Map,n&&n.constructor==Object?r=n:n&&(i=n.toString()),r=Nn({debug:0,host:qt.CLOUD_HOST,port:qt.CLOUD_PORT,path:"/",key:t.DEFAULT_KEY,token:qt.randomToken(),config:qt.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin"},r),o._options=r,"/"===o._options.host&&(o._options.host=window.location.hostname),o._options.path&&("/"!==o._options.path[0]&&(o._options.path="/"+o._options.path),"/"!==o._options.path[o._options.path.length-1]&&(o._options.path+="/")),void 0===o._options.secure&&o._options.host!==qt.CLOUD_HOST?o._options.secure=qt.isSecure():o._options.host==qt.CLOUD_HOST&&(o._options.secure=!0),o._options.logFunction&&tn.default.setLogFunction(o._options.logFunction),tn.default.logLevel=o._options.debug||0,o._api=new Bn.API(r),o._socket=o._createServerConnection(),qt.supports.audioVideo||qt.supports.data?i&&!qt.validateId(i)?(o._delayedAbort(an.InvalidID,'ID "'.concat(i,'" is invalid')),o):(i?o._initialize(i):o._api.retrieveId().then((function(e){return o._initialize(e)})).catch((function(e){return o._abort(an.ServerError,e)})),o):(o._delayedAbort(an.BrowserIncompatible,"The current browser does not support WebRTC"),o)}return Fn(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"socket",{get:function(){return this._socket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connections",{get:function(){var e,t,n=Object.create(null);try{for(var r=Un(this._connections),i=r.next();!i.done;i=r.next()){var o=Wn(i.value,2),s=o[0],a=o[1];n[s]=a}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!1,configurable:!0}),t.prototype._createServerConnection=function(){var e=this,t=new fn.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t.on(un.Message,(function(t){e._handleMessage(t)})),t.on(un.Error,(function(t){e._abort(an.SocketError,t)})),t.on(un.Disconnected,(function(){e.disconnected||(e.emitError(an.Network,"Lost connection to server."),e.disconnect())})),t.on(un.Close,(function(){e.disconnected||e._abort(an.SocketClosed,"Underlying socket is already closed.")})),t},t.prototype._initialize=function(e){this._id=e,this.socket.start(e,this._options.token)},t.prototype._handleMessage=function(e){var t,n,r=e.type,i=e.payload,o=e.src;switch(r){case ln.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case ln.Error:this._abort(an.ServerError,i.msg);break;case ln.IdTaken:this._abort(an.UnavailableID,'ID "'.concat(this.id,'" is taken'));break;case ln.InvalidKey:this._abort(an.InvalidKey,'API KEY "'.concat(this._options.key,'" is invalid'));break;case ln.Leave:tn.default.log("Received leave message from ".concat(o)),this._cleanupPeer(o),this._connections.delete(o);break;case ln.Expire:this.emitError(an.PeerUnavailable,"Could not connect to peer ".concat(o));break;case ln.Offer:var s=i.connectionId;if((f=this.getConnection(o,s))&&(f.close(),tn.default.warn("Offer received for existing Connection ID:".concat(s))),i.type===sn.Media){var a=new gn.MediaConnection(o,this,{connectionId:s,_payload:i,metadata:i.metadata});f=a,this._addConnection(o,f),this.emit("call",a)}else{if(i.type!==sn.Data)return void tn.default.warn("Received malformed connection type:".concat(i.type));var c=new Pn.DataConnection(o,this,{connectionId:s,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable});f=c,this._addConnection(o,f),this.emit("connection",c)}var u=this._getMessages(s);try{for(var l=Un(u),h=l.next();!h.done;h=l.next()){var d=h.value;f.handleMessage(d)}}catch(e){t={error:e}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}break;default:if(!i)return void tn.default.warn("You received a malformed message from ".concat(o," of type ").concat(r));var f;s=i.connectionId,(f=this.getConnection(o,s))&&f.peerConnection?f.handleMessage(e):s?this._storeMessage(s,e):tn.default.warn("You received an unrecognized message:",e)}},t.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},t.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},t.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return tn.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(an.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var n=new Pn.DataConnection(e,this,t);return this._addConnection(e,n),n},t.prototype.call=function(e,t,n){if(void 0===n&&(n={}),this.disconnected)return tn.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(an.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t){var r=new gn.MediaConnection(e,this,Nn(Nn({},n),{_stream:t}));return this._addConnection(e,r),r}tn.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},t.prototype._addConnection=function(e,t){tn.default.log("add connection ".concat(t.type,":").concat(t.connectionId," to peerId:").concat(e)),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},t.prototype._removeConnection=function(e){var t=this._connections.get(e.peer);if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)},t.prototype.getConnection=function(e,t){var n,r,i=this._connections.get(e);if(!i)return null;try{for(var o=Un(i),s=o.next();!s.done;s=o.next()){var a=s.value;if(a.connectionId===t)return a}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return null},t.prototype._delayedAbort=function(e,t){var n=this;setTimeout((function(){n._abort(e,t)}),0)},t.prototype._abort=function(e,t){tn.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},t.prototype.emitError=function(e,t){var n;tn.default.error("Error:",t),(n="string"==typeof t?new Error(t):t).type=e,this.emit("error",n)},t.prototype.destroy=function(){this.destroyed||(tn.default.log("Destroy peer with ID:".concat(this.id)),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))},t.prototype._cleanup=function(){var e,t;try{for(var n=Un(this._connections.keys()),r=n.next();!r.done;r=n.next()){var i=r.value;this._cleanupPeer(i),this._connections.delete(i)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.socket.removeAllListeners()},t.prototype._cleanupPeer=function(e){var t,n,r=this._connections.get(e);if(r)try{for(var i=Un(r),o=i.next();!o.done;o=i.next())o.value.close()}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t.prototype.disconnect=function(){if(!this.disconnected){var e=this.id;tn.default.log("Disconnect peer with ID:".concat(e)),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}},t.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)tn.default.log("Attempting reconnection to server with ID ".concat(this._lastServerId)),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer ".concat(this.id," cannot reconnect because it is not disconnected from the server!"));tn.default.error("In a hurry? We're still trying to make the initial connection!")}},t.prototype.listAllPeers=function(e){var t=this;void 0===e&&(e=function(e){}),this._api.listAllPeers().then((function(t){return e(t)})).catch((function(e){return t._abort(an.ServerError,e)}))},t.DEFAULT_KEY="peerjs",t}(Zt.EventEmitter);const $n=P.object({title:P.string,label:P.string,placeholder:P.nullable(P.string),token:P.nullable(P.boolean)}),Gn=P.object({text:P.string,value:P.nullable(P.string),keybind:P.nullable(P.string),keyicon:P.nullable(P.string)}),qn=P.object({title:P.string,items:P.array(Gn)}),Zn=P.or(qn,$n,P.string),Vn=P.array(Z),Kn="text",Jn=qn,Yn="redirect-menu",Xn=P.record(P.string,Zn),Qn="form",er=P.record(P.string,P.nullable(P.string)),tr="form-data",nr=P.array(P.string),rr="sequence-data",ir="content-type";var or=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class sr{constructor(e){this.handled=!1,this.errors=[],this.header=e.header,this.content=e.content}get content_type(){return this.header[ir]}readContent(e,t,n){return or(this,void 0,void 0,(function*(){return this.header[ir]===e&&(t.is(this.content)?(yield n(this.content),this.handled=!0,!0):void this.errors.push(new Error(e)))}))}textContent(e){return this.readContent(Kn,Vn,e)}redirectMenu(e){return this.readContent(Yn,Jn,e)}formContent(e){return this.readContent(Qn,Xn,e)}formDataContent(e){return this.readContent(tr,er,e)}sequence(e){return this.readContent(rr,nr,(t=>or(this,void 0,void 0,(function*(){for(const n of t)yield e(n)}))))}catch(e){return or(this,void 0,void 0,(function*(){if(!h(this.header[ir]))return this.handled?void(this.handled=!0):yield e(this.errors)}))}}class ar extends sr{redirect(){return"REDIRECT"===this.header.status&&this.header.path}get status(){return this.header.status}}class cr extends sr{get path(){return this.header.path}}class ur{constructor(e,t={}){this.content=null,this.header=Object.assign(Object.assign({},t),{method:e})}textContent(...e){this.header[ir]=Kn,this.content=e.map((e=>"string"==typeof e?D(e):e))}redirectMenu(e,t){this.header[ir]=Yn,this.content={title:e,items:t}}formContent(e,t){this.header["form-submit"]=e,this.header[ir]=Qn,this.content=t}formDataContent(e){this.header[ir]=tr,this.content=e}sequence(...e){this.header[ir]=rr,this.content=e}build(){return{header:this.header,content:this.content}}}class lr extends ur{constructor(e){super("RESPONSE"),this.header.for=e.header.id}get status(){return this.header.status}set status(e){this.header.status=e}redirect(e){this.status="REDIRECT",this.header.path=e}badRequest(e){this.status="BAD_REQUEST",e&&this.textContent(e)}}class hr extends ur{constructor(e,t){super(e,t),this.header.id=ce()}get path(){return this.header.path}set path(e){this.header.path=e}}hr.mimic=e=>{var t;const n=new hr(e.header.method,e.header);return n.content=null!==(t=e.content)&&void 0!==t?t:n.content,n};const dr=e=>P.object({header:P.and(P.object({method:e}),P.record(P.string,P.string)),content:P.unknown}),fr=(dr(P.literal("GET")),dr(P.literal("POST")),dr(P.oneof("GET","POST"))),pr=dr(P.literal("RESPONSE")),mr=dr(P.oneof("GET","POST","RESPONSE"));class vr{constructor(){this.timeout_ms=1e4,this.awaiting=new Map}request(e){const t=new a,n=e.header.id||ce();return e.header.id=n,this.awaiting.set(n,t),t.timeout(this.timeout_ms,`${e.header.method} ${e.header.path} timeout`),t.promise}write(e){if(pr.is(e)){const t=e.header.for;if(h(t))return;this.awaiting.has(t)&&(this.awaiting.get(t).resolve(e),this.awaiting.delete(t))}}}class gr{constructor(){this.root=new _r,this.notFound=gr.notFound,this.badRequest=gr.badRequest,this.serverError=gr.serverError}define(e){return this.root.define(gr.parse(e))}get(e,t){this.define(e).gets=t}post(e,t){this.define(e).posts=t}route(e,t){const n=e.header.path,r=e.header.method,i={req:new cr(e),res:new lr(e),connection:t,options:{}},o=this.root.route(gr.parse(n),i.options);try{h(n)?this.badRequest(i):o&&"GET"===r&&o.gets?(i.res.status="OK",o.gets(i)):o&&"POST"===r&&o.posts?(i.res.status="OK",o.posts(i)):this.notFound(i)}catch(t){console.warn(`Error in response handler for ${e.header.path}`),console.error(t),this.serverError(i)}return i.res.build()}incoming(e,t){if(fr.is(e))return this.route(e,t)}debug(){return this.root.debug().join("\n")}static parse(e){return e.split("/").map((e=>e.trim())).filter((e=>""!==e&&void 0!==e))}static format(e){return gr.parse(e).join("/")}}gr.notFound=e=>{e.res.status="NOT_FOUND",e.res.textContent("Not Found: "+e.req.path)},gr.badRequest=e=>{e.res.status="BAD_REQUEST",e.res.textContent("Bad Request")},gr.serverError=e=>{e.res.status="SERVER_ERROR",e.res.textContent("Server Error")};class yr{constructor(e){this.firstClass=!1,this.first=[],this.second=[],this.part=e}push(e){e instanceof br?this.first.push(e):this.second.push(e)}*routes(){for(const e of this.first)yield e;for(const e of this.second)yield e}route(e,t){const n=e.shift();if(!n||""===n)return this;for(const r of this.routes()){const i={};if(r.apply(n,i))return Object.assign(t,i),r.route(e,t)}}define(e){const t=e.shift();if(!t||""===t)return this;for(const n of this.routes())if(n.part===t)return n.define(e);const n=yr.from(t);return this.push(n),n.define(e)}debug(e){e=void 0===e?this.part:e+"/"+this.part;const t=[];this.gets&&t.push(`GET:  ${e}`),this.posts&&t.push(`POST: ${e}`);for(const n of this.routes())t.push(...n.debug(e));return t}static from(e){return":"===e[0]?new wr(e):new br(e)}}class _r extends yr{constructor(){super("<root>")}}class br extends yr{constructor(e){super(e),this.apply=t=>t===e,this.firstClass=!0}}class wr extends yr{constructor(e){super(e);const t=e.slice(1);this.apply=(e,n)=>(n[t]=e,!0),this.firstClass=!1}}class kr{constructor(){this.router=new gr}listen(e){e.data.on((t=>{const n=this.router.incoming(t,e);h(n)||e.send(n)}))}reset(){this.router=new gr}get(e,t){return this.router.get(e,t)}post(e,t){return this.router.post(e,t)}form(e,t,n){this.get(e,(({res:e})=>{e.formContent(t,n)}))}submit(e,t){this.post(e,(e=>{return n=this,r=void 0,o=function*(){yield e.req.formDataContent((n=>t(e,n))),yield e.req.catch((t=>{console.warn(`expected ${tr} got ${e.req.content_type}`);for(const e of t)console.error(e)}))},new((i=void 0)||(i=Promise))((function(e,t){function s(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(s,a)}c((o=o.apply(n,r||[])).next())}));var n,r,i,o}))}static(e,...t){this.get(e,(({res:e})=>{e.textContent(...t)}))}sequence(e,...t){this.get(e,(({res:e})=>{e.sequence(...t)}))}redirect(e,t){this.get(e,(({res:e})=>{e.redirect(t)}))}}class Cr{constructor(){this.dispatcher=new vr,this.close=new K((()=>{})),this.error=new K((e=>{})),this.data=new K((e=>{})),this.data.on((e=>{this.dispatcher.write(e)}))}write(e){this.data.emit(e)}request(e){if(!fr.is(e))throw console.warn(e),new Error(`invalid request: ${JSON.stringify(e)}`);return new Promise(((t,n)=>{this.dispatcher.request(e).then((n=>{return r=this,i=void 0,s=function*(){const r=new ar(n),i=r.redirect();if(i){const n=hr.mimic(e);n.path=i,t(yield this.request(n.build()))}else t(r)},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{c(s.next(e))}catch(e){t(e)}}function a(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,a)}c((s=s.apply(r,i||[])).next())}));var r,i,o,s})).catch((e=>n(e))),this.send(e)}))}get(e,t){const n=new hr("GET",Object.assign(Object.assign({},t),{path:e}));return this.request(n.build())}post(e,t,n){const r=new hr("POST",Object.assign(Object.assign({},n),{path:e}));return r.content=t,this.request(r.build())}}class Sr extends Cr{constructor(e){super(),this.connection=e,e.on("close",(()=>{this.close.emit()})),e.on("data",(e=>{"string"==typeof e&&(e=JSON.parse(e)),this.write(e)})),e.on("error",(e=>{this.error.emit(e)}))}send(e){this.connection.send(e)}end(){this.connection.close()}}class xr{constructor(e){var t;this.api=new kr,this.accept=!1,this.connection=new K((e=>{})),this.ready=new K((()=>{})),this.discoveryID=e||(null!==(t=window.sessionStorage.getItem("discovery_id"))&&void 0!==t?t:xr.GetID()),window.sessionStorage.setItem("discovery_id",this.discoveryID),this.peerID=this.expand(this.discoveryID)}expand(e){return"WJSF9a8594h32_"+e}setup(){this.peer=new Hn(this.peerID),this.peer.on("connection",(e=>this.incoming(e))),this.peer.on("open",(e=>{this._id=e,this.ready.emit()})),this.peer.on("error",console.error),this.peer.on("close",console.error)}incoming(e){if(!this.accept)return e.close();this.connection.emit(this.listen(e))}listen(e){const t=new Sr(e);return this.api.listen(t),t}start(){this.peer||this.setup(),this.accept=!0}stop(){this.accept=!1}get id(){if(this._id)return this.discoveryID}url(e,t){return`${window.location.origin}/${e}?${t}=${this.discoveryID}`}connect(e){return new Promise(((t,n)=>{const r=this.peer.connect(this.expand(e)),i=e=>n(e);r.on("open",(()=>{r.off("error",i),t(this.listen(r))})),r.on("error",i)}))}static GetID(){return le(16)}}class Er extends Oe{constructor(){super(...arguments),this.name="API v1",this.sessions=new Map}load(e){this.connections=new xr(e.options.id),this.public=this.connections.api,this.server=e,this.public.reset(),e.options.logConnections&&this.startLogging();const t=this.public;t.sequence("/","/clear","/motd","/login"),t.get("/clear",(({res:e})=>{e.header["clear-console"]="true"})),t.static("/motd",G.chapter(e.options.motd)),t.redirect("/login","/login/username"),t.form("/login/username","/login/password",{username:{title:"By what name do you wish to be known?",label:"username",placeholder:"username"}}),t.static("/login/invalid_username","Invalid Username"),t.submit("/login/password",(({req:t,res:n},r)=>{const i=r.username;if(i.length<3)return void n.sequence("/login/invalid_username","/login");if(i.length>20)return void n.sequence("/login/invalid_username","/login");if(o=i,s=p,!Array.from(o).every((e=>s.includes(e))))return void n.sequence("/login/invalid_username","/login");var o,s;const a=e.game.find(i);!a||e.game.player.is(a)?(n.header["server-id"]=this.server.id,n.header.username=i,a?n.formContent("/login/submit",{username:i,token:{title:"What is your password?",label:"password",placeholder:"password",token:!0}}):n.formContent("/login/submit",{username:i,token:{title:"Choose a password",label:"password",placeholder:"password",token:!0}})):n.sequence("/login/invalid_username","/login")})),t.submit("/login/submit",(({req:t,res:n,connection:r},i)=>{const o=i.username,s=i.token;if(e.game.find(o)){if(!e.game.player.is(e.game.find(o)))return void n.sequence(`/login/incorrect_password/${o}`,"/login")}else e.game.command(e.game.createPlayer,o);e.game.command(e.game.authenticate,o,s)?(n.header["clear-console"]="true",n.header.token=s,this.startSession(s,r),setTimeout((()=>{const e=new hr("POST",{path:"/session_start"});e.header.token=s,e.header.home="/commands",r.request(e)}))):n.sequence(`/login/incorrect_password/${o}`,"/login")})),t.get("/login/incorrect_password/:username",(({req:e,res:t,options:n})=>{t.textContent(`Incorrect password for ${n.username}`)}))}gaurdSession(e,t){const n=e.req.header.token,r=this.server.game.session(n);r?t(Object.assign(Object.assign({},e),{player:r})):(e.res.status="FORBIDDEN",e.res.textContent("Invalid token"))}command(e,t){this.public.get(e,(e=>{this.gaurdSession(e,t)}))}submit(e,t){this.public.submit(e,((e,n)=>{this.gaurdSession(e,(e=>t(Object.assign(Object.assign({},e),{data:n}))))}))}isConnected(e){return this.sessions.has(e)}endSession(e){const t=this.server.game.session(e);this.isConnected(e)&&this.sessions.get(e).end(),this.server.game.sessionEnd(t)}startSession(e,t){const n=this.server.game.session(e);this.isConnected(e)&&this.endSession(e),this.sessions.set(e,t),t.close.on((()=>{this.sessions.get(e)===t&&(this.sessions.delete(e),this.server.game.sessionEnd(n))})),this.server.game.sessionStart(n)}request(e,t){const n=this.sessions.get(e);if(void 0===n)throw new Error("Unable to find session");return n.request(t)}get(e,t){const n=this.sessions.get(e);if(void 0===n)throw new Error("Unable to find session");return n.get(t)}start(){this.connections.start()}stop(){this.connections.stop()}startLogging(){this.connections.connection.on((e=>{this.server.debug("incoming connection"),e.data.on((e=>{var t;if(mr.is(e)){if(e.header.path){const n=e.header.path.split(/(\/|\\)/).map((e=>this.server.game.about(e))).join(""),r=this.server.game.about(null!==(t=this.server.game.session(e.header.token))&&void 0!==t?t:"?");this.server.debug(`${r}: ${e.header.method} ${n}`)}}else this.server.debug(JSON.stringify(e))}))})),this.server.game.send.on(((e,t)=>{this.server.debug(`-> ${this.server.game.about(e)}: ${L(t).split("\n").join(" ").slice(0,20)}`)})),this.server.game.interupt.on((e=>{this.server.debug(`!INT ${this.server.game.about(e)}`)}))}get id(){return this.connections.id}}class Tr extends Oe{constructor(){super(...arguments),this.name="Commands"}load(e){const t=e.api;function n(e){return F(e.split(" ").map((e=>ue(function(e){const t=(0,oe.MD5)(e).words,n=new ArrayBuffer(128);return new Int32Array(n).set(t),Array.from(new Uint8Array(n))}(e).slice(0,e.length),f))).join(" "),G.glitch)}function r(t,r){const i=e.game.name.get(t);return i?e.game.canRead(t,r)?F(i):n(i):F("unknown",G.subtle)}function i(t,n,i="You"){return n&&t===n?F(i,G.first_person):function(t,n){return n||(n=F(e.game.name.get(t))),e.game.room.is(t)?F(n,G.room):e.game.npc.is(t)?F(n,G.npc):e.game.player.is(t)?F(n,G.player):e.game.backpack.is(t)?F(n,G.backpack):e.game.chest.is(t)?F(n,G.chest):e.game.item.is(t)?F(n,G.item):e.game.prop.is(t)?F(n,G.prop):e.game.name.has(t)?F(n,G.proper_noun):n}(t,r(t,n))}function o(e){e.push(F(j(),G.spacer))}function s(t,o,s){var a,c;const u=e.game,l=o===s?"Inventory":e.game.room.is(o)?r(o,s):i(o,s),h=u.description.get(o);if(t.push(F(l,G.lead)),h&&h.length&&t.push(F(e.game.canRead(o,s)?h:n(h),G.italic)),u.children.has(o)){if(u.room.is(o)){const e=[];for(const t of u.doors(o))e.push(M(i(u.reference.get(t),s),F(M(" (",u.direction.get(t),") "),G.subtle)));t.push(M(F("Exits: ",G.subtle),...e))}const n=e.game.binEntities(null!==(c=null===(a=u.children.get(o))||void 0===a?void 0:a.filter((e=>e!==s&&u.inVision(e,s))))&&void 0!==c?c:[],[u.player,u.npc,u.prop,u.item,u.chest,u.backpack,u.object]);if(n.length){t.push(F("You see:",G.subtle));for(const e of n)t.push(M("  ",i(e,s)))}}}function a(e,t){const n=[];return o(n),n.push(function(...e){return F(M(...e),G.subtle)}(e)),function(e,t){const n=[];t(n),e.push(F(z(...n),G.embed))}(n,(e=>{t(e)})),o(n),n}function c(e,t,n){return a(e,(e=>s(e,t,n)))}function u(e,t,n,r){!function(e,t,i){e.textContent(...a(t,(e=>s(e,n,r))))}(e,t)}t.command("/describe/room",(({req:t,res:n,options:r,player:i})=>{u(n,"look",e.game.roomOf(i),i)})),t.command("/describe/:target",(({req:t,res:n,options:r,player:i})=>{e.game.inVision(r.target,i)?u(n,`look ${e.game.name.get(r.target)}`,r.target,i):n.textContent("You cannot see that.")}));const l=({req:t,res:n,options:r,player:i})=>{const o=[];e.game.room.is(r.context)&&(o.push({text:"Move",value:"/commands/list_move"}),e.game.children.get(i).length&&o.push({text:"Inventory",value:`/commands/look/${i}`})),e.game.children.has(r.context)&&e.game.readableChildObjects(r.context,i).some((t=>e.game.object.is(t)))&&o.push({text:"Look",value:`/commands/list_look/${r.context}`}),e.game.children.has(r.context)&&!e.game.player.is(r.context)&&e.game.readableChildObjects(r.context,i).some((t=>e.game.carryable.is(t)))&&o.push({text:"Take",value:`/commands/list_take/${r.context}`}),e.game.player.is(r.context)&&e.game.children.get(i).length&&o.push({text:"Drop",value:"/commands/list_drop/"}),e.game.room.is(r.context)&&(o.push({text:"Say",value:"/commands/say"}),o.push({text:"Whisper",value:"/commands/whisper"})),o.length&&(e.game.room.is(r.context)?o.push({text:"Refresh",value:"/commands/look/room"}):o.push(V),n.redirectMenu("Commands",o))};t.command("/commands",(t=>{t.options.context=e.game.roomOf(t.player),l(t)})),t.command("/list_commands/:context",l),t.command("/commands/list_look/:target",(({req:t,res:n,options:r,player:i})=>{const o=e.game.readableChildObjects(r.target,i);n.redirectMenu("Look",[...e.game.binEntities(o,[e.game.prop,e.game.item,e.game.chest,e.game.backpack]).map((t=>({text:e.game.name.get(t),value:`/commands/look/${t}`}))),V])})),t.command("/commands/look/room",(({req:e,res:t,options:n,player:r})=>{t.sequence("/describe/room","/commands")})),t.command("/commands/look/:target",(({req:e,res:t,options:n,player:r})=>{t.sequence(`/describe/${n.target}`,`/list_commands/${n.target}`)})),t.command("/commands/list_move",(({req:t,res:n,options:r,player:i})=>{const o=e.game.doors(e.game.parent.get(i));n.redirectMenu("Move",[...o.map((t=>({text:e.game.canRead(e.game.reference.get(t),i)?e.game.name.get(e.game.reference.get(t)):e.game.direction.get(t),value:`/commands/move/${e.game.direction.get(t)}`}))),V])})),t.command("/commands/move/:direction",(({res:t,req:n,options:r,player:i})=>{const o=e.game.getDoor(e.game.roomOf(i),r.direction);e.game.locked.get(o)?t.textContent(`${e.game.about(e.game.reference.get(o))} is locked.`):(e.game.movePlayerDirection(i,r.direction),u(t,`move ${r.direction}`,e.game.roomOf(i),i))})),t.command("/commands/list_take/:context",(({req:t,res:n,options:r,player:i})=>{const o=e.game.readableChildObjects(r.context,i);n.redirectMenu("Take",[...e.game.binEntities(o,[e.game.carryable,e.game.item,e.game.backpack]).map((t=>({text:e.game.name.get(t),value:`/commands/take/${t}`}))),V])})),t.command("/commands/take/:target",(({req:t,res:n,options:r,player:i})=>{e.game.inVision(r.target,i)&&e.game.placeable.is(e.game.parent.get(r.target))?e.game.command(e.game.take,r.target,i):n.textContent("You cannot take that.")})),t.command("/commands/list_drop/",(({req:t,res:n,options:r,player:i})=>{const o=e.game.readableChildObjects(i,i);n.redirectMenu("Drop",[...e.game.binEntities(o,[e.game.carryable,e.game.item,e.game.backpack]).map((t=>({text:e.game.name.get(t),value:`/commands/drop/${t}`}))),V])})),t.command("/commands/drop/:target",(({req:t,res:n,options:r,player:i})=>{e.game.isHolding(r.target,i)?e.game.command(e.game.drop,r.target,i):n.textContent("You cannot drop that which you do not have.")})),t.public.form("/commands/say/","/commands/say",{message:{title:"Message:",label:" > ",placeholder:"..."}}),t.submit("/commands/say",(({req:t,res:n,options:r,player:i,data:o})=>{e.game.say(e.game.parent.get(i),i,o.message)})),t.command("/commands/whisper",(({req:t,res:n,options:r,player:i,data:o})=>{n.formContent("/commands/whisper",{target:{title:"Whisper",items:[...e.game.filter(e.game.player).filter((e=>e!==i)).map((t=>({text:e.game.name.get(t),value:t}))),V]},message:{title:"Message:",label:" > ",placeholder:"..."}})})),t.submit("/commands/whisper",(({req:t,res:n,options:r,player:i,data:o})=>{e.game.whisper(o.target,i,o.message)})),e.attach((n=>{n.send.on(((n,r)=>{try{const i=e.game.token.get(n);if(t.isConnected(i)){const e=new hr("POST",{path:"/write"});e.textContent(r),t.request(i,e)}}catch(e){console.error(e)}})),n.interupt.on((n=>{try{const r=e.game.token.get(n);if(t.isConnected(r)){const e=new hr("POST",{path:"/interrupt",token:r});t.request(r,e)}}catch(e){console.error(e)}})),n.sessionStart.on((e=>{n.foreachPlayer((t=>{e!==t&&n.send(t,M(i(e,t)," joined the game"))})),setTimeout((()=>{n.send(e,z(...c("look",n.roomOf(e),e)))}),1)})),n.sessionEnd.on((e=>{n.foreachPlayer((t=>{e!==t&&n.send(t,M(i(e,t)," left the game"))}))})),n.playerMove.on(((e,t,r)=>{n.player.is(e)&&n.interupt(e),n.foreachPlayerIn(t,(t=>{n.send(t,M(i(e,t)," left the room"))})),n.foreachPlayerIn(r,(t=>{e!==t&&n.send(t,M(i(e,t)," entered the room"))}))})),n.playerTeleport.on(((e,t,r)=>{n.player.is(e)&&(n.interupt(e),n.send(e,z(...c("look",n.roomOf(e),e)))),n.foreachPlayerIn(t,(t=>{e!==t&&n.send(t,M(i(e,t)," vanished"))})),n.foreachPlayerIn(r,(t=>{e!==t&&n.send(t,M(i(e,t)," appeared"))}))})),n.objectDropped.on(((e,t,r)=>{n.foreachPlayerIn(r,(r=>{n.send(r,M(i(t,r)," dropped ",i(e,r)))}))})),n.objectTaken.on(((e,t,r)=>{n.foreachPlayerIn(t,(t=>{n.send(t,M(i(r,t)," took ",i(e,t)))}))})),n.objectTakenFrom.on(((e,t,r)=>{n.foreachPlayerIn(n.parent.get(t),(o=>{n.send(o,M(i(r,o)," took ",i(e,o)," from ",i(t,o)))}))})),n.objectPut.on(((e,t,r)=>{n.foreachPlayerIn(n.parent.get(t),(o=>{n.send(o,M(i(t,o)," put ",i(e,o)," into ",i(r,o)))}))})),n.objectGiven.on(((e,t,r)=>{for(const o in[t,r])n.send(o,M(i(t,o)," gave ",i(e,o)," to ",i(r,o)))})),n.objectTeleported.on(((e,t,r)=>{n.foreachPlayerIn(t,(t=>{n.send(t,M(i(e,t)," vanished"))})),n.foreachPlayerIn(r,(t=>{n.send(t,M(i(e,t)," appeared"))}))})),n.whisper.on(((e,t,r)=>{n.send(e,M(F("[",G.subtle),i(t,e)," tells ",i(e,e),F("]: ",G.subtle),r)),n.send(t,M(F("[",G.subtle),i(t,t)," tell ",i(e,t),F("]: ",G.subtle),r))})),n.say.on(((e,t,r)=>{n.foreachPlayerIn(e,(e=>{n.send(e,M(F("[",G.subtle),i(t,e),F("]: ",G.subtle),r))}))}))}))}}class Rr extends Error{}class Pr{constructor(){this.triggers=new Map}touch(e){this.triggers.has(e)||this.triggers.set(e,new K(((...e)=>{})))}on(e,t){this.touch(e),this.triggers.get(e).on(t)}emit(e,t){this.triggers.has(e)&&setTimeout((()=>{this.triggers.get(e).emit(...t)}))}}class Ar{get game(){return this.server.game}constructor(e){this.events={player:{enter:new Pr,exit:new Pr},npc:{greet:new Pr}},this.player={enter:(e,t)=>this.events.player.enter.on(e._id,t),exit:(e,t)=>this.events.player.exit.on(e._id,t)},this.npc={greet:(e,t)=>this.events.npc.greet.on(e._id,t)},this.server=e;const t=this.game.state.bind(ye.Component.array(P.string,"npc-greeter-playerlist"));e.game.eventEntityMove.on(((e,n,r)=>{var i;if(this.game.player.is(e)){const o=this.game.player.cast(e);n&&this.events.player.exit.emit(n,[o]),r&&this.events.player.enter.emit(r,[o]);for(const n of this.game.neighbors(e))if(this.game.npc.is(n)){const r=null!==(i=t.get(n))&&void 0!==i?i:[];if(r.includes(e))return;r.push(e),t.set(n,r),this.events.npc.greet.emit(n,[o])}}}))}}class Or{constructor(e){this.util={wait:e=>new Promise((t=>setTimeout(t,1e3*e))),playerMovesInTheNextNSeconds:(e,t)=>new Promise((n=>{let r=!1;const i=t=>{t===e._id&&(r=!0)};this.game.playerMove.on(i),setTimeout((()=>{this.game.playerMove.off(i),n(r)}),1e3*t)})),sequence:(e,t)=>{return n=this,r=void 0,o=function*(){for(const[n,r,i]of t){if(i){if(yield this.util.playerMovesInTheNextNSeconds(e,n))return}else yield this.util.wait(n);yield r()}},new((i=void 0)||(i=Promise))((function(e,t){function s(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(s,a)}c((o=o.apply(n,r||[])).next())}));var n,r,i,o},readTagArray:e=>e.split(",").map((e=>this.game.get(e.trim()))).filter((e=>!!e))},this.server=e,this.on=new Ar(e),this.flags={tag:this.game.tag,mutation:this.game.mutation}}get game(){return this.server.game}cast(e,t){try{return e.cast(t._id)}catch(e){throw e instanceof me?new Rr(e.message):e}}find(e){const t=this.game.get(e)||this.game.find(e);if(h(t))throw new Rr(`Could not find an entity by the name of ${e}`);return{_id:t}}get(e,t){const n=this.game.get(t)||this.game.find(t);if(h(n))throw new Rr(`Could not find an entity by the name of ${t}`);return this.cast(e,{_id:n})}npc(e){const t=this.cast(this.game.npc,this.find(e));return t.say=e=>{this.game.say(this.game.roomOf(t._id),t._id,e)},t.whisper=(e,n)=>{this.game.whisper(e._id,t._id,n)},t}room(e){return this.get(this.game.room,e)}object(e){return this.get(this.game.object,e)}prop(e){return this.get(this.game.prop,e)}item(e){return this.get(this.game.item,e)}chest(e){return this.get(this.game.chest,e)}backpack(e){return this.get(this.game.backpack,e)}move(e,t){this.game.move(e._id,t._id)}mutation(e){return this.game.mutation.ensure(e._id,{})}tell(e,t){if(this.game.player.is(e._id))this.game.send(e._id,F(t,G.italic));else if(this.game.room.is(e._id))for(const n of e.children)this.game.send(n,F(t,G.italic))}send(e,t){this.game.send(e._id,F(t))}chapter(e,t,n){this.send(e,z(G.chapter(t),G.subtitle(n)))}roomOf(e){return this.cast(this.game.room,{_id:this.game.roomOf(e._id)})}equal(e,t){return e._id===t._id}sameRoom(e,t){return this.game.sameRoom(e._id,t._id)}*entities(...e){for(const t of this.game.filter(...e))yield{_id:t}}players(){return Array.from(this.entities(this.game.player)).map((e=>this.game.player.cast(e._id)))}forEachPlayer(e){for(const t of this.players())e(t)}}var Ir=n(5733),Dr=n.n(Ir),jr=n(3162),Br=n.n(jr),zr=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const Mr=P.record(P.string,P.nullable(P.string)),Lr="header.json";class Fr{constructor(){this.zip=new(Dr()),this.header={id:le(32)}}get name(){return this.header.name}get time(){return parseInt(this.header.time)}get autosave(){var e,t;return"true"===(null===(t=null===(e=this.header.autosave)||void 0===e?void 0:e.toLowerCase())||void 0===t?void 0:t.trim())}get id(){return this.header.id}localeTimeString(){return new Date(this.header.time||Date.now()).toLocaleString()}writeFile(e,t,n){let r=`${i=n,(0,oe.MD5)(i).toString(oe.enc.Hex)}.${e}`;var i;return t&&t.length&&(r+="."+t),this.zip.file(r,n),r}readHeader(){return zr(this,void 0,void 0,(function*(){const e=this.zip.file(Lr);if(null===e)return void console.warn("unable to locate header file");const t=yield e.async("string");Object.assign(this.header,Mr.cast(JSON.parse(t)))}))}writeHeader(){this.zip.file(Lr,JSON.stringify(this.header))}writeLevelData(e){this.writeFile("level","json",e.game.state.saveSubset((t=>!!t&&e.game.dynamic.some((e=>!e.test(t))))))}writeStateData(e){this.writeFile("state","json",e.game.state.saveSubset((t=>!!t&&e.game.dynamic.some((e=>e.test(t))))))}select(e){return this.zip.filter(((t,n)=>t.endsWith(e)))}load(e){return zr(this,void 0,void 0,(function*(){for(const t of this.select(".level.json"))e.game.state.load(yield t.async("string"));for(const t of this.select(".state.json"))e.game.state.load(yield t.async("string"));for(const t of this.select(".server")){const n=yield t.async("string");P.string.is(n)&&(e.id=n)}}))}writeMetadata(e,t,n=!1){this.header.name=e,this.header.time=String(t||Date.now()),this.header.autosave=n?"true":"false",this.writeHeader()}writeLevel(e){this.writeLevelData(e)}writeSave(e){this.writeLevelData(e),this.writeStateData(e),this.writeFile("server","",e.id)}fromBase64String(e){return zr(this,void 0,void 0,(function*(){yield this.zip.loadAsync(e,{base64:!0}),yield this.readHeader()}))}fromBlob(e){return zr(this,void 0,void 0,(function*(){yield this.zip.loadAsync(e),yield this.readHeader()}))}loadURL(e){return zr(this,void 0,void 0,(function*(){try{const t=yield this.ajax(e);yield this.zip.loadAsync(t),yield this.readHeader()}catch(e){console.error(e)}}))}download(e){this.zip.generateAsync({type:"blob"}).then((t=>{Br()(t,(e||this.header.name||"save")+".minimud")}))}toBase64String(){return this.zip.generateAsync({type:"base64"})}ajax(e){return new Promise(((t,n)=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(e){var n=new Blob([r.response]);t(n)},r.send()}))}static fromBase64(e){return zr(this,void 0,void 0,(function*(){const t=new Fr;return yield t.fromBase64String(e),t}))}static fromBlob(e){return zr(this,void 0,void 0,(function*(){const t=new Fr;return yield t.fromBlob(e),t}))}static loadURL(e){return zr(this,void 0,void 0,(function*(){const t=new Fr;return yield t.loadURL(e),t}))}static level(e){const t=new Fr;return t.writeLevel(e),t.writeMetadata("level",Date.now()),t}static save(e,t){const n=new Fr;return n.writeSave(e),n.writeMetadata(t,Date.now()),n}}var Nr=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const Ur=P.array(P.string);class Wr{constructor(){this.change=new K((()=>{})),this.files=new Map,this.store=window.sessionStorage,this.localsaves=[],this.quicksaves=[],this.autosaves=[]}saves(){return[...this.localsaves,...this.quicksaves,...this.autosaves]}storedSaves(){return[...this.indicies("localsaves"),...this.indicies("quicksaves"),...this.indicies("autosaves")]}delete(e){"string"!=typeof e&&(e=e.id),this.files.delete(e),Hr(this.localsaves,e),Hr(this.quicksaves,e),Hr(this.autosaves,e),this.store.removeItem(Wr.entry(e)),this.writeIndicies(),this.change.emit()}read(){return Nr(this,void 0,void 0,(function*(){"1"!==this.store.getItem("store_version")&&(this.store.clear(),this.store.setItem("store_version","1")),this.localsaves=this.indicies("localsaves"),this.quicksaves=this.indicies("quicksaves"),this.autosaves=this.indicies("autosaves");for(const e of this.saves()){const t=this.store.getItem(Wr.entry(e)),n=yield Fr.fromBase64(t);this.files.set(e,n)}this.write(),this.change.emit()}))}quicksave(e,t){return Nr(this,void 0,void 0,(function*(){const n=new Fr;n.writeSave(e),n.writeMetadata(t||"untitled",Date.now(),!1),yield this.writeFile("quicksaves",n)}))}autosave(e){return Nr(this,void 0,void 0,(function*(){const t=new Fr;t.writeSave(e),t.writeMetadata("autosave",Date.now(),!0),yield this.writeFile("autosaves",t)}))}load(e){return Nr(this,void 0,void 0,(function*(){this.writeFile("localsaves",yield Fr.fromBlob(e))}))}writeFile(e,t){return Nr(this,void 0,void 0,(function*(){const n=t.id;this[e].push(n),this.files.set(n,t),this.indicies(e,this[e]),this.store.setItem(Wr.entry(n),yield t.toBase64String()),this.change.emit()}))}write(){return Nr(this,void 0,void 0,(function*(){const e=this.saves(),t=this.storedSaves(),n=this.saves().filter((e=>!t.includes(e))),r=this.storedSaves().filter((t=>!e.includes(t)));for(const e of n)this.store.setItem(Wr.entry(e),yield this.files.get(e).toBase64String());for(const e of r)this.store.deleteItem(Wr.entry(e));this.writeIndicies()}))}[Symbol.iterator](){return this.files.values()}writeIndicies(){return Nr(this,void 0,void 0,(function*(){this.indicies("localsaves",this.localsaves),this.indicies("quicksaves",this.quicksaves),this.indicies("autosaves",this.autosaves)}))}indicies(e,t){if(t)return this.store.setItem(e,JSON.stringify(t)),t;const n=this.store.getItem(e);return h(n)?[]:Ur.cast(JSON.parse(n))}static entry(e){return`${e}.minimud`}}function Hr(e,t){for(let n=0;n<1e3;n++){const n=e.indexOf(t);if(n<0)break;e.splice(n,1)}return e}class $r{constructor(e,t,n){this.children=new Map,this.depth=0,this.truncated=!1,this.select=new K((e=>{})),this.game=e,this.entity=t,this.parent=n,this.parent&&(this.depth=this.parent.depth+1),this.root=this._root(),this.truncated=this.depth>$r.MAX_DEPTH;const r=m("div",{classList:["indent"]});this.list=m("div",{}),this.name=m("span",{classList:["treenode-name"]}),this.type=m("span",{classList:["treenode-type"]}),this.handle=m("span",{classList:["treenode-handle"],children:[this.name]}),this.container=m("div",{classList:["treenode"],children:[this.handle,this.type,m("div",{children:[r,this.list]})]});const i=this.game.getArchetype(t);i&&(this.container.setAttribute("archetype",i.name),this.type.replaceChildren(document.createTextNode(i.name))),this.update()}getChildren(){return h(this.entity)?this.game.roots():this.game.childrenOf(this.entity)}update(){const e=this.getChildren();let t;if(h(this.entity)||(t=this.game.about(this.entity)||"unknown"),this.game.door.is(this.entity)&&(t=`${this.game.direction.get(this.entity)}: ${this.game.about(this.game.reference.get(this.entity))}`),this.name?this.name.replaceChildren(document.createTextNode(t)):this.name.replaceChildren(),this.truncated)return void this.list.replaceChildren(m("li",{text:"..."}));const n=new Map,r=[];for(const t of e){const e=this.children.has(t)?this.children.get(t).lazyUpdate():new $r(this.game,t,this);n.set(t,e),r.push(e.container)}return this.children=n,this.list.replaceChildren(...r),this.handle.setAttribute("draggable",this.draggable?"true":"false"),this.draggable?(this.handle.classList.add("grabbable"),this.handle.ondragstart=e=>{this.root.list.classList.add("drag-active"),e.dataTransfer.setData("text",this.entity),this.root.select.emit(this.entity)},this.handle.ondragend=e=>{this.root.list.classList.remove("drag-active")}):this.handle.classList.remove("grabbable"),this.droppable?(this.container.classList.add("tree-dropzone"),this.container.classList.remove("tree-nodrop"),this.handle.ondragover=e=>{const t=e.dataTransfer.getData("text");t&&this.game.player.is(t)&&!this.game.room.is(this.entity)||e.target instanceof HTMLElement&&e.preventDefault()},this.handle.ondrop=e=>{if(e.target instanceof HTMLElement){e.preventDefault();const t=e.dataTransfer.getData("text");this.game.move(t,this.entity)}}):(this.container.classList.remove("tree-dropzone"),this.container.classList.add("tree-nodrop")),this.handle.onclick=e=>{e.preventDefault(),this.root.select.emit(this.entity)},this}lazyUpdate(){return setTimeout((()=>this.update())),this}get draggable(){return this.game.parent.has(this.entity)&&this.game.name.has(this.entity)}get droppable(){return this.game.children.has(this.entity)&&this.game.name.has(this.entity)}_root(){return this.parent?this.parent._root():this}}$r.MAX_DEPTH=16;class Gr{constructor(e){this.options=Gr.defaultOptions(),this.hasLoaded=!1,this.events=new J,this.api=new Er,this.id=ce(),this.store=new Wr,this.error=this.events.error,this.warn=this.events.warn,this.info=this.events.info,this.log=this.events.log,this.debug=this.events.debug,this.divider=()=>this.log(F("%==",[])),this.loaded=this.events.channel("loaded",(()=>{})),this.ready=this.events.channel("ready",(()=>{})),this.playerJoin=this.events.channel("player-join",(e=>{})).on((()=>this.playerListChange())),this.playerLeave=this.events.channel("player-leave",(e=>{})).on((()=>this.playerListChange())),this.playerDeleted=this.events.channel("player-deleted",(e=>{})).on((()=>this.playerListChange())),this.playerListChange=this.events.channel("player-list-change",(()=>{})),e&&(this.options=s(this.options,e)),this.setupConsole(),this.module(this.api),this.module(new Tr),this.loaded.once((()=>{this.hasLoaded=!0})),this.api.connections.ready.on((()=>{this.hasLoaded?this.ready():this.loaded.once((()=>this.ready()))})),this.api.start(),this.store.read(),this.attach((e=>{e.sessionStart.on((t=>this.playerJoin(e.player.cast(t)))),e.sessionEnd.on((t=>this.playerLeave(e.player.cast(t))))})),setInterval((()=>this.autosave()),1e3*this.options.autosave_interval_seconds),this.load(this.options.load)}setupConsole(){this.options.consoleElement&&(this.console=new q(this.options.consoleElement),this.error.on(((...e)=>this.console.error(...e))),this.warn.on(((...e)=>this.console.warn(...e))),this.info.on(((...e)=>this.console.info(...e))),this.log.on(((...e)=>this.console.log(...e))),this.debug.on(((...e)=>this.console.debug(...e))),this.module(new De)),this.options.logErrorsToBuiltinConsole&&this.events.logErrorsToBuiltinConsole(),this.options.logToBuiltinConsole&&this.events.logToBuiltinConsole()}url(){return this.api.connections.url("client","server_id")}reset(){this.resetGamestate(),this.game.command(this.game.theVoid),this.loaded()}load(e){return t=this,n=void 0,i=function*(){if(this.resetGamestate(),e)try{"string"==typeof e?(this.info(`loading: ${e}`),e=yield Fr.loadURL(e)):this.info(`loading: ${e.name}`),yield e.load(this)}catch(t){const n="string"==typeof e?e:e.name;this.error(t),this.warn(`Failed to load ${n}`)}this.scriptingContext=new Or(this),this.game.command(this.game.theVoid),this.game.scrub(),this.loaded()},new((r=void 0)||(r=Promise))((function(e,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}c((i=i.apply(t,n||[])).next())}));var t,n,r,i}module(e){e.load(this)}attach(e){this.hasLoaded&&e(this.game,this),this.loaded.on((()=>{e(this.game,this)}))}script(e){this.loaded.on((()=>{try{e(this.scriptingContext)}catch(e){if(!(e instanceof Rr))throw e;this.error(e)}}))}players(){return this.game.filter(this.game.player).map((e=>this.game.player.cast(e))).filter((e=>!!e))}kickPlayer(e){this.game.assert("player",e,[this.game.player]),this.api.endSession(this.game.token.get(e))}deletePlayer(e){this.game.assert("player",e,[this.game.player]);const t=this.game.get(e);this.kickPlayer(e),this.game.destroyEntity(e),this.playerDeleted(t)}resetPassword(e){this.game.assert("player",e,[this.game.player]),this.game.token.set(e,void 0)}quicksave(e){this.store.quicksave(this,e)}autosave(){this.store.autosave(this)}downloadSave(e){Fr.save(this,e).download(e)}downloadLevel(e){this.game.scrub(),Fr.level(this).download(e)}resetGamestate(){this.divider(),this.game=new Ce(this.options),this.game.error.on(((...e)=>this.error(...e))),this.game.warn.on(((...e)=>this.warn(...e))),this.game.info.on(((...e)=>this.info(...e))),this.game.log.on(((...e)=>this.log(...e))),this.game.debug.on(((...e)=>this.debug(...e)))}startDebug(){this.api.startLogging()}tree(){return new $r(this.game)}}Gr.defaultOptions=()=>Object.assign(Ce.defaultOptions(),{logErrorsToBuiltinConsole:!0,logToBuiltinConsole:!1,consoleElement:void 0,motd:"Welcome!",logConnections:!1,id:void 0,keep_autosaves:10,autosave_interval_seconds:300});const qr=Gr,Zr=n(3536).Z;const Vr=new URLSearchParams(window.location.search),Kr=new qr({consoleElement:document.getElementById("console"),load:Zr,motd:"Welcome!",id:Vr.get("id"),logErrorsToBuiltinConsole:!0,logToBuiltinConsole:!0});Kr.script((e=>{const t=e.room("interstate"),n=e.room("containment"),r=e.room("lab"),i=e.room("control_room"),o=e.npc("scientist");e.on.player.enter(t,(t=>{e.util.sequence(t,[[.1,()=>e.tell(t,"You are blinded by a bright light")],[1,()=>e.forEachPlayer((t=>{e.chapter(t,"Chapter 1","You wake up in a dark containment cell"),e.move(t,n)}))]])})),e.on.player.enter(r,(t=>{e.util.sequence(t,[[.25,()=>o.say("AAAAAAAAAAAAAAAAAAAAAAAAAAAHHHHH!!!!!!!")],[1,()=>e.move(o,i)]])}))}));const Jr=e=>m("li",{text:e.name,classList:["list-group-item","d-flex","flex-row","justify-content-between","fw-bold"],children:[m("div",{classList:["btn-toolbar"],children:[m("div",{classList:["btn-group","btn-group-sm","me-2"],children:[m("button",{text:"Reset Password",classList:["btn","btn-warning"],onclick(){Kr.kickPlayer(e._id),Kr.resetPassword(e._id)}})]}),m("div",{classList:["btn-group","btn-group-sm","me-2"],children:[m("button",{text:"Kick",classList:["btn","btn-danger"],disabled:!Kr.api.isConnected(e.token),onclick(){Kr.kickPlayer(e._id)}}),m("button",{text:"Delete",classList:["btn","btn-danger"],onclick(){Kr.deletePlayer(e._id)}})]})]})]}),Yr=()=>{const e=document.getElementById("playerlist"),t=Kr.players().sort(((e,t)=>+Kr.api.isConnected(t.token)-+Kr.api.isConnected(e.token)));t.length?e.replaceChildren(m("div",{children:[m("h6",{text:"Online"}),m("ul",{classList:["list-group","mb-2"],children:t.filter((e=>Kr.api.isConnected(e.token))).map(Jr)}),m("h6",{text:"Offline"}),m("ul",{classList:["list-group","mb-2"],children:t.filter((e=>!Kr.api.isConnected(e.token))).map(Jr)})]})):e.replaceChildren(m("span",{text:"Waiting for players to join...",classList:["fst-italic","text-subtle","ms-2"]}))};Kr.playerListChange.on(Yr);const Xr=e=>m("div",{classList:["list-group-item","d-flex","flex-row","justify-content-between"],children:[m("div",{children:[m("h6",{classList:[],text:e.name}),m("div",{classList:["fst-italic","text-subtle"],text:new Date(e.time).toLocaleString()})]}),m("div",{classList:["btn-group","btn-group-sm"],children:[m("button",{text:"Load",classList:["btn","btn-primary"],onclick(){Kr.load(e)}}),m("button",{text:"Download",classList:["btn","btn-secondary"],onclick(){e.download()}}),m("button",{text:"Delete",classList:["btn","btn-danger"],onclick(){Kr.store.delete(e)}})]})]}),Qr=()=>{const e=document.getElementById("savelist"),t=Array.from(Kr.store);t.sort(((e,t)=>e.time-t.time)),e.replaceChildren(m("div",{classList:["list-group"],children:t.map(Xr)}))};Kr.store.change.on(Qr),Kr.loaded.once((()=>{Yr(),Qr()}));const ei=document.getElementById("dropzone");function ti(e,t){const n=m("input",{attributes:{type:"text"},classList:["component-text"]});n.value=t.get(e)||"",n.oninput=()=>{try{t.setSafe(e,n.value),Kr.game.touch(50)}catch(e){Kr.error(e)}};const r=m("div",{text:t.name});return m("div",{children:[r,n]})}function ni(e,t){const n=[];return t(n),m("div",{children:[m("h2",{text:e}),m("div",{classList:["d-flex","flex-column","ps-2"],children:n.map((e=>m("div",{classList:["mb-2"],children:[e]})))})]})}function ri(e,t){const n=e.map((e=>m("button",{text:e,attributes:{type:"button"},classList:["btn","btn-outline-primary"]})));return t.push(m("div",{classList:["btn-group"],children:n})),n}["dragenter","dragover","dragleave","drop"].forEach((e=>ei.addEventListener(e,(e=>{e.preventDefault(),e.stopPropagation()})))),ei.addEventListener("drop",(e=>{console.log("File(s) dropped"),e.dataTransfer.items?[...e.dataTransfer.items].forEach(((e,t)=>{return n=void 0,r=void 0,o=function*(){if("file"===e.kind){const t=e.getAsFile();Kr.store.load(t)}},new((i=void 0)||(i=Promise))((function(e,t){function s(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(s,a)}c((o=o.apply(n,r||[])).next())}));var n,r,i,o})):[...e.dataTransfer.files].forEach(((e,t)=>{console.log(` file[${t}].name = ${e.name}`)}))}));const ii=e=>{const t=document.getElementById("edit");if(h(e))return void(()=>{const e=document.getElementById("edit"),t=[];t.push(ni("Level",(e=>{const[t,n]=ri(["New Level","Export Level"],e);t.onclick=()=>Kr.reset(),n.onclick=()=>Kr.downloadLevel("level")}))),t.push(ni("Create",(e=>{const[t]=ri(["Room"],e);t.onclick=()=>{const e=Kr.game.createRoom("new room");Kr.game.touch(),ii(e)};const[n,r,i,o]=ri(["Prop","Item","Chest","Backpack"],e);n.onclick=()=>{const e=Kr.game.createProp("new prop");Kr.game.touch(),ii(e)},r.onclick=()=>{const e=Kr.game.createItem("new item");Kr.game.touch(),ii(e)},i.onclick=()=>{const e=Kr.game.createChest("new chest");Kr.game.touch(),ii(e)},o.onclick=()=>{const e=Kr.game.createBackpack("new backpack");Kr.game.touch(),ii(e)}}))),e.replaceChildren(...t)})();const n=[],r=Kr.game.getArchetype(e),i=Kr.game.about(e);n.push(m("h2",{text:i})),r&&n.push(m("span",{text:r.name,classList:["lead"]}));for(const t of[Kr.game.name,Kr.game.description])t.has(e)&&n.push(ti(e,t));t.replaceChildren(...n)};window.addEventListener("keydown",(e=>{"Escape"===e.key&&ii(null)})),Kr.ready.on((()=>{let e;document.getElementById("copy-link").textContent=Kr.url(),Kr.attach((t=>{e=Kr.tree();const n=document.getElementById("tree");let r;n.replaceChildren(e.list),t.change.on((()=>e.lazyUpdate())),e.select.on((e=>{r=e})),n.onclick=()=>{setTimeout((()=>{ii(r),r=null}))},ii(null)})),setInterval((()=>e.lazyUpdate()),5e3),document.getElementById("copy-link-btn").onclick=()=>{navigator.clipboard.writeText(Kr.url())}})),Object.assign(window,{server:Kr})})()})();